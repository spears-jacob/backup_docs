USE ${env:TMP_db};

CREATE TABLE IF NOT EXISTS ${env:ReprocessDateTable_daily} (run_date string);
CREATE TABLE IF NOT EXISTS ${env:ReprocessDateTable_fiscal_monthly} (run_date string);
CREATE TABLE IF NOT EXISTS ${env:ReprocessDateTable_monthly} (run_date string);
CREATE TABLE IF NOT EXISTS ${env:ReprocessDateTable_weekly} (run_date string);
INSERT OVERWRITE TABLE ${env:ReprocessDateTable_daily} VALUES('${env:RUN_DATE}');
INSERT OVERWRITE TABLE ${env:ReprocessDateTable_fiscal_monthly} VALUES('${env:RUN_DATE}');
INSERT OVERWRITE TABLE ${env:ReprocessDateTable_monthly} VALUES('${env:RUN_DATE}');
INSERT OVERWRITE TABLE ${env:ReprocessDateTable_weekly} VALUES('${env:RUN_DATE}');


USE ${env:ENVIRONMENT};

CREATE TABLE IF NOT EXISTS venona_set_agg_portals
(
  mso STRING,
  application_type STRING,
  device_type STRING,
  connection_type STRING,
  network_status STRING,
  playback_type STRING,
  cust_type STRING,
  application_group_type STRING,
  app_version STRING,
  grouping_id INT,
  metric_name STRING,
  metric_value DOUBLE,
  logged_in_status STRING,
  application_name STRING,
  os_name STRING,
  os_version STRING,
  browser_name STRING,
  browser_version STRING,
  form_factor STRING,
  process_date_time_denver STRING,
  process_identity STRING,
  unit_type STRING)
PARTITIONED BY (label_date_denver STRING, grain STRING)
TBLPROPERTIES ('retention_policy'='Aggregate - Without PII (3 Years)')
;


--------------------------------------------------------------------------------
-- asp_quantum_set_agg_v VIEW Creation
--------------------------------------------------------------------------------
DROP VIEW IF EXISTS asp_quantum_set_agg_v;

CREATE VIEW asp_quantum_set_agg_v AS
select *
from prod.venona_set_agg_portals;

--------------------------------------------------------------------------------
--- View that feeds SS Tableau Dashboard ---
--------------------------------------------------------------------------------
DROP VIEW IF EXISTS portals_quantum_tableau_daily_agg_v;

CREATE VIEW IF NOT EXISTS portals_quantum_tableau_daily_agg_v AS SELECT

   case when grain = 'daily' then 'Daily'
        when grain = 'weekly' then 'Weekly'
        when grain = 'fiscal_monthly' then 'Fiscal Monthly'
        when grain = 'monthly' then 'Monthly'
        else grain end AS `Type`,
   metric_name AS `Metric Name`,


   CASE WHEN mso IN ('"TWC"','L-TWC') THEN 'TWC'
        WHEN mso IN ('"BHN"','L-BHN') THEN 'BHN'
        when mso IN ('"CHTR"','L-CHTR') THEN 'CHTR'
        When mso IN ('unknown','MSO-MISSING') THEN 'Unknown'
        ELSE mso END AS `Company`,

    application_name as `Application Type`,
    os_version       as `OS Version`,
    browser_name     as `Browser Name`,
    network_status   as `Network Status`,
    browser_version  as `Browser Version`,

    app_version              AS `App Version`,
    grouping_id              AS `Grouping ID`,
    metric_value             AS `Metric Value`,
   CASE WHEN  grain = 'weekly' then label_date_denver
        else  'All Weeks' END             AS `Week End Date`,
   label_date_denver        AS `Month Start`,
   CASE WHEN  grain in('fiscal_monthly','monthly') then 'All Days'
        else  label_date_denver end AS `Denver Date`,
   CASE
--alerts
        WHEN metric_name = 'portals_one_time_alert_clicked' THEN 'Customers with Alert Interaction'
        WHEN metric_name = 'portals_one_time_page_alert_displayed' THEN 'Customers Who Saw an Alert'
--billing
        WHEN metric_name = 'portals_account_billing_support_views' THEN 'Account & Billing Support Section Views'
        WHEN metric_name = 'portals_autopay_enroll_radio_toggle' THEN 'Auto-Pay Enroll Radio Toggle'
        WHEN metric_name = 'portals_one_time_payment_select_amount' THEN 'One Time Payment Flow: Select Amount'
        WHEN metric_name = 'portals_one_time_payment_select_date' THEN 'One Time Payment Flow: Select Date'
        WHEN metric_name = 'portals_one_time_payment_select_payment_method' THEN 'One Time Payment Flow: Select Payment Method'
        WHEN metric_name = 'portals_one_time_payment_submits_with_ap' THEN 'One Time Payment Flow: Submits with Auto-Pay Enrollment'
        WHEN metric_name = 'portals_one_time_payment_submits_without_ap' THEN 'One Time Payment Flow: Submits without Auto-Pay Enrollment'
        WHEN metric_name = 'portals_one_time_payment_submits' THEN 'One Time Payment Flow: Submits'
--         WHEN metric_name = 'portals_bill_pay_clicks_from_bill_pay_card_on_hp' THEN 'Bill Pay Clicks From Bill Pay Card On Hp' --(REMOVING FROM SS ONLY)
--         WHEN metric_name = 'portals_bill_pay_clicks_from_local_nav' THEN 'Bill Pay Clicks From Local Nav' --(REMOVING FROM SS ONLY)
        WHEN metric_name = 'portals_one_time_payment_failures' THEN 'One Time Payment Flow: Failures'
        WHEN metric_name = 'portals_one_time_payment_starts' THEN 'One Time Payment Flow: Starts'
        WHEN metric_name = 'portals_one_time_payment_successes_with_ap_enroll' THEN 'One Time Payment Flow: Successes With Auto-Pay Enrollment'
        WHEN metric_name = 'portals_one_time_payment_successes_without_ap_enroll' THEN 'One Time Payment Flow: Successes Without Auto-Pay Enrollment'
        WHEN metric_name = 'portals_one_time_payment_successes' THEN 'One Time Payment Flow: Successes All'
        WHEN metric_name = 'portals_one_time_payment_amount' THEN 'Pay Bill One Time Payment Amount'
        WHEN metric_name = 'portals_one_time_payment_checking_account' THEN 'Customers with Final Payment Method = Checking'
        WHEN metric_name = 'portals_one_time_payment_credit_debit_card' THEN 'Customers with Final Payment Method = Card'
        WHEN metric_name = 'portals_one_time_payment_date_other' THEN 'Customers Who Select Any Other Date from Payment Date Step of Flow'
        WHEN metric_name = 'portals_one_time_payment_date_past_due' THEN 'One Time Payment Date Past Due'
        WHEN metric_name = 'portals_one_time_payment_date_today' THEN 'Customers Who Select Today from Payment Date Step of Flow'
        WHEN metric_name = 'portals_one_time_payment_date' THEN 'Pay Bill One Time Payment Date'
        WHEN metric_name = 'portals_one_time_payment_equals_amount_due' THEN 'Customers with Payment Amount = Amount Due'
        WHEN metric_name = 'portals_one_time_payment_equals_current_balance' THEN 'Customers with Payment Amount = Current Balance'
        WHEN metric_name = 'portals_one_time_payment_equals_past_due_amount' THEN 'Customers with Payment Amount = Past Due Balance'
        WHEN metric_name = 'portals_one_time_payment_less_than_amount_due' THEN 'Customers with Payment Amount < Amount Due'
        WHEN metric_name = 'portals_one_time_payment_less_than_current_balance' THEN 'Customers with Payment Amount < Current Balance'
        WHEN metric_name = 'portals_one_time_payment_less_than_past_due_amount' THEN 'Customers with Payment Amount < Past Due Balance'
        WHEN metric_name = 'portals_one_time_payment_more_than_amount_due' THEN 'Customers with Payment Amount > Amount Due'
        WHEN metric_name = 'portals_one_time_payment_more_than_current_balance' THEN 'Customers with Payment Amount > Current Balance'
        WHEN metric_name = 'portals_one_time_payment_more_than_past_due_amount' THEN 'Customers with Payment Amount > Past Due Balance'
        WHEN metric_name = 'portals_one_time_payment_savings_account' THEN 'Customers with Final Payment Method = Savings'
        WHEN metric_name = 'portals_set_up_auto_payment_failures' THEN 'Auto-Pay Flow: Enrollment Failures'
        WHEN metric_name = 'portals_set_up_auto_payment_starts' THEN 'Auto-Pay Flow: Enrollment Starts'
        WHEN metric_name = 'portals_set_up_auto_payment_successes_with_payment' THEN 'Auto-Pay Flow: Enrollment Successes With Payment'
        WHEN metric_name = 'portals_set_up_auto_payment_successes_without_payment' THEN 'Auto-Pay Flow: Enrollment Successes Without Payment'
        WHEN metric_name = 'portals_set_up_auto_payment_successes' THEN 'Auto-Pay Flow: Enrollment Successes All'
        WHEN metric_name = 'portals_view_online_statments' THEN 'View Online Statement'
        WHEN metric_name = 'portals_billing_feature_interaction' THEN 'Billing Feature Interaction'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_enroll_from_homepage' THEN 'Billing Delivery Preference: Paperless Enroll from Homepage'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_billinghome' THEN 'Billing Delivery Preference: Paperless Submit from Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_homepage' THEN 'Billing Delivery Preference: Paperless Submit from Homepage'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_paperless' THEN 'Billing Delivery Preference: Paperless Un-Enroll from Paperless'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit' THEN 'Billing Delivery Preference: Paperless Submit'
        WHEN metric_name = 'portals_bill_delivery_pref_paper_success' THEN 'Billing Delivery Preference: Paper Success'
        WHEN metric_name = 'portals_bill_delivery_pref_paper_failure' THEN 'Billing Delivery Preference: Paper Failure'
        WHEN metric_name = 'portals_bill_delivery_pref_paper' THEN 'Billing Delivery Preference: Keep Paper'
        WHEN metric_name = 'portals_bill_delivery_pref_keep_paperless' THEN 'Billing Delivery Preference: Keep Paperless'
        WHEN metric_name = 'portals_bill_delivery_pref_exit' THEN 'Billing Delivery Preference: Exit'
        WHEN metric_name = 'portals_bill_delivery_pref_manage_paperless' THEN 'Billing Delivery Preference: Manage Paperless'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_success' THEN 'Billing Delivery Preference: Paperless Success'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_failure' THEN 'Billing Delivery Preference: Paperless Failure'
        WHEN metric_name = 'portals_set_up_auto_payment_submits_plus_otp' THEN 'Auto-Pay Flow: Enrollment Submits with One Time Payment'
        WHEN metric_name = 'portals_set_up_auto_payment_submits' THEN 'Auto-Pay Flow: Enrollment Submits'
        WHEN metric_name = 'portals_one_time_payment_submission_previously_stored_payment_method' THEN 'One Time Payment Submission: Previously Stored Payment Method'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method_stored' THEN 'One Time Payment Submission: New Method (Stored)'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method_not_stored' THEN 'One Time Payment Submission: New Payment Method (Not Stored)'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method' THEN 'One Time Payment Submission: New Payment Method'
        WHEN metric_name = 'portals_one_time_payment_before_posted_due_date' THEN 'Count of customers who complete payment flow before their posted due date'
        WHEN metric_name = 'portals_one_time_payment_on_posted_due_date' THEN 'Count of customers who complete payment flow on their posted due date'
        WHEN metric_name = 'portals_one_time_payment_after_posted_due_date' THEN 'Count of customers who complete payment flow after their posted due date'

         --ID/Auth
        WHEN metric_name = 'portals_create_username_flow_failure' THEN 'Create Username Flow Failures'
        WHEN metric_name = 'portals_create_username_flow_start' THEN 'Create Username Flow Starts'
        WHEN metric_name = 'portals_create_username_flow_success' THEN 'Create Username Flow Successes'
        WHEN metric_name = 'portals_forgot_password_flow_failure' THEN 'Forgot Password Flow Failures'
        WHEN metric_name = 'portals_forgot_password_flow_start' THEN 'Forgot Password Flow Starts'
        WHEN metric_name = 'portals_forgot_password_success' THEN 'Forgot Password Flow Successes'
        WHEN metric_name = 'portals_forgot_username_flow_failure' THEN 'Forgot Username Flow Failures'
        WHEN metric_name = 'portals_forgot_username_flow_start' THEN 'Forgot Username Flow Starts'
        WHEN metric_name = 'portals_forgot_username_success' THEN 'Forgot Username Flow Successes'
        WHEN metric_name = 'portals_new_acct_created_all' THEN 'New Accounts Created - All'
        WHEN metric_name = 'portals_new_admin_accounts_attempts' THEN 'New Admin Accounts Creation Attempts'
        WHEN metric_name = 'portals_sub_user_creation_attempts' THEN 'New Sub Accounts Creation Attempts'
        WHEN metric_name = 'portals_new_admin_accounts_created' THEN 'New Admin Accounts Created'
        WHEN metric_name = 'portals_new_ids_created_attempts' THEN 'New Ids Created Attempts'
        WHEN metric_name = 'portals_new_ids_created_successes' THEN 'New Ids Created Successes'
        WHEN metric_name = 'portals_reset_password_attempts' THEN 'Reset Password Attempts'
        WHEN metric_name = 'portals_sub_acct_created' THEN 'New Sub Account Created'
        WHEN metric_name = 'portals_cpni_verify_account_modal' THEN 'CPNI: Verify Account Modal'
        WHEN metric_name = 'portals_cpni_verify_account_page' THEN 'CPNI: Verify Account Page'
        WHEN metric_name = 'portals_cpni_verify_account_success_modal' THEN 'CPNI: Verify Account Success Modal'
        WHEN metric_name = 'portals_cpni_verify_account_success_page' THEN 'CPNI: Verify Account Success Page'
        WHEN metric_name = 'portals_cpni_complete_and_fail_modal' THEN 'CPNI: Complete and Fail Modal'
        WHEN metric_name = 'portals_cpni_complete_and_fail_page' THEN 'CPNI: Complete and Fail Page'
        WHEN metric_name = 'portals_cpni_complete_and_submit_modal' THEN 'CPNI: Complete and Submit Modal'
        WHEN metric_name = 'portals_cpni_complete_and_submit_page' THEN 'CPNI: Complete and Submit Page'
        WHEN metric_name = 'portals_cpni_abandon_roadblock_modal' THEN 'CPNI: Abandon Roadblock Modal'
        WHEN metric_name = 'portals_cpni_abandon_roadblock_page' THEN 'CPNI: Abandon Roadblock Page'
        WHEN metric_name = 'portals_biometrics_login_attempts' THEN 'Biometrics: Login Attempt'
        WHEN metric_name = 'portals_biometrics_login_successes' THEN 'Biometrics: Login Success'
        WHEN metric_name = 'portals_biometrics_login_failures' THEN 'Biometrics: Login Failure'
        WHEN metric_name = 'portals_biometrics_fingerprint_toggle_on' THEN 'Biometrics: Fingerprint Toggle ON'
        WHEN metric_name = 'portals_biometrics_fingerprint_toggle_off' THEN 'Biometrics: Fingerprint Toggle OFF'
        WHEN metric_name = 'portals_biometrics_fingerprint_enroll' THEN 'Biometrics: Fingerprint Enroll'
        WHEN metric_name = 'portals_login_attempts' THEN 'Login Attempts'
        WHEN metric_name = 'portals_login_failures' THEN 'Login Failures'
        WHEN metric_name = 'portals_logout' THEN 'Logout'

         --Support
        WHEN metric_name = 'portals_call_support' THEN 'Call Support'
        WHEN metric_name = 'portals_contact_our_moving_specialist' THEN 'Contact Our Moving Specialist'
        WHEN metric_name = 'portals_contact_us_page_views' THEN 'Contact Us Page Views'
        WHEN metric_name = 'portals_get_moving_info' THEN 'Get Moving Info'
        WHEN metric_name = 'portals_quick_tutorial' THEN 'Quick Tutorial'
        WHEN metric_name = 'portals_support_page_views' THEN 'Support Section Page Views'
        WHEN metric_name = 'portals_request_callback' THEN 'Request Callback'
        WHEN metric_name = 'portals_support_article_select' THEN 'Support Article Select'

          --Equipment
        WHEN metric_name = 'portals_all_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Reset Flow Failures All Deprecated CL68'
        WHEN metric_name = 'portals_all_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Reset Flow Starts All Deprecated CL68'
        WHEN metric_name = 'portals_all_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Reset Flow Successes All Deprecated CL68'
        WHEN metric_name = 'portals_download_wifi_profile_button_click_android' THEN 'Download WiFi Profile Button Click - Android'
        WHEN metric_name = 'portals_download_wifi_profile_button_click_ios' THEN 'Download WiFi Profile Button Click - IOS'
        WHEN metric_name = 'portals_download_wifi_profile_button_click' THEN 'Download WiFi Profile Button Click'
        WHEN metric_name = 'portals_download_wifi_profile_success_android' THEN 'Download WiFi Profile Successes - Android'
        WHEN metric_name = 'portals_download_wifi_profile_success_ios' THEN 'Download WiFi Profile Successes - IOS'
        WHEN metric_name = 'portals_download_wifi_profile_success' THEN 'Download WiFi Profile Successes'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Reset Flow Internet Cancel Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow Internet Failure Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Reset Flow Submit Internet Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow Internet Success Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Reset Flow Internet Manual Reset Success Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Reset Flow TV Cancel Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow TV Failure Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Reset Flow Submit TV Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow TV Success Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Reset Flow TV Manual Reset Success Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Reset Flow Voice Cancel Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow Voice Failure Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Reset Flow Submit Voice Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Reset Flow Voice Success Modal Continue Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Reset Flow Voice Manual Reset Success Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_internet_deprecated_cl68' THEN 'Progress Bar Modal Internet Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_tv_deprecated_cl68' THEN 'Progress Bar Modal TV Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_voice_deprecated_cl68' THEN 'Progress Bar Modal Voice Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_internet_modal_view_deprecated_cl68' THEN 'Equipment Reset Flow: Internet Modal Interaction Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_tv_modal_view_deprecated_cl68' THEN 'Equipment Reset Flow: TV Modal Interaction Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_voice_modal_view_deprecated_cl68' THEN 'Equipment Reset Flow: Voice Modal Interaction Deprecated CL68'
        WHEN metric_name = 'portals_equipment_detail_views' THEN 'Equipment Details Views'
        WHEN metric_name = 'portals_equipment_list_view' THEN 'Equipment List Views'
        WHEN metric_name = 'portals_equipment_page_views_deprecated_cl68' THEN 'Equipment Flow Page Views Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_all_deprecated_cl68' THEN 'Equipment Resets Too Many Resets Modal Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_internet_deprecated_cl68' THEN 'Equipment Resets Too Many Resets Modal Internet Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_tv_deprecated_cl68' THEN 'Equipment Resets Too Many Resets Modal TV Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_voice_deprecated_cl68' THEN 'Equipment Resets Too Many Resets Modal Voice Deprecated CL68'
        WHEN metric_name = 'portals_install_wifi_profile_start' THEN 'Install Wifi Profile Starts'
        WHEN metric_name = 'portals_install_wifi_profile_success' THEN 'Install Wifi Profile Successes'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Reset Flow Failures Internet Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Reset Flow Starts Internet Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Reset Flow Successes Internet Deprecated CL68'
        WHEN metric_name = 'portals_internet_modem_reset_failures' THEN 'Modem Reset Failures Internet'
        WHEN metric_name = 'portals_internet_modem_reset_successes' THEN 'Modem Reset Successes Internet'
        WHEN metric_name = 'portals_internet_modem_router_reset_starts' THEN 'Modem Router Reset Starts Internet'
        WHEN metric_name = 'portals_internet_router_reset_failures' THEN 'Router Reset Failures Internet'
        WHEN metric_name = 'portals_internet_router_reset_successes' THEN 'Router Reset Successes Internet'
        WHEN metric_name = 'portals_internet_services_connection_issue_troubleshoot' THEN 'Internet Services Connected Experiencing Issues'
        WHEN metric_name = 'portals_manual_reset_failures_deprecated_cl68' THEN 'Manual Reset Failures Deprecated CL68'
        WHEN metric_name = 'portals_manual_reset_starts_deprecated_cl68' THEN 'Manual Reset Starts Deprecated CL68'
        WHEN metric_name = 'portals_manual_reset_success_deprecated_cl68' THEN 'Manual Reset Successes Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Reset Flow Failures TV Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Reset Flow Starts TV Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Reset Flow Successes TV Deprecated CL68'
        WHEN metric_name = 'portals_tv_modem_reset_failures' THEN 'Modem Reset Failures TV'
        WHEN metric_name = 'portals_tv_router_reset_failures' THEN 'Router Reset Failures TV'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Reset Flow Failures Voice Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Reset Flow Starts Voice Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Reset Flow Successes Voice Deprecated CL68'
        WHEN metric_name = 'portals_voice_modem_reset_failures' THEN 'Modem Reset Failures Voice'
        WHEN metric_name = 'portals_voice_modem_reset_successes' THEN 'Modem Reset Successes Voice'
        WHEN metric_name = 'portals_voice_router_reset_failures' THEN 'Router Reset Failures Voice'
        WHEN metric_name = 'portals_wifi_password_views' THEN 'Wifi Password Views'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts Internet'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes Internet'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures Internet'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_modal_wait' THEN 'Equipment Reset Flow Modal Wait Internet'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts TV'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes TV'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures TV'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_modal_wait' THEN 'Equipment Reset Flow Modal Wait TV'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts Voice'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes Voice'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures Voice'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_modal_wait' THEN 'Equipment Reset Flow Modal Wait Voice'
        WHEN metric_name = 'portals_equipment_page_views' THEN 'Equipment Flow Page Views'
        WHEN metric_name = 'portals_manual_reset_failures' THEN 'Manual Reset Failures'
        WHEN metric_name = 'portals_manual_reset_starts' THEN 'Manual Reset Starts'
        WHEN metric_name = 'portals_manual_reset_success' THEN 'Manual Reset Successes'
        WHEN metric_name = 'portals_all_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures All'
        WHEN metric_name = 'portals_all_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts All'
        WHEN metric_name = 'portals_all_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes All'
        WHEN metric_name = 'portals_equipment_feature_interaction' THEN 'Equipment Feature Interaction'
        WHEN metric_name = 'portals_equipment_edit_ssid_select_action' THEN 'Edit SSID Click'
        WHEN metric_name = 'portals_equipment_confirm_edit_ssid_select_action' THEN 'Edit SSID Confirm Changes'
        WHEN metric_name = 'portals_equipment_cancel_edit_ssid_select_action' THEN 'Edit SSID Cancel Changes'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_submit' THEN 'Equipment Reset Flow Submit Internet'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_submit' THEN 'Equipment Reset Flow Submit TV'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_submit' THEN 'Equipment Reset Flow Submit Voice'
        WHEN metric_name = 'portals_equipment_reset_flow_submit_all'  THEN 'Equipment Reset Flow Submit All'
        WHEN metric_name = 'portals_router_advanced_settings_click_port_forward' THEN 'Router Advanced Features: Click Port Forwarding/IP Reservations'
        WHEN metric_name = 'portals_router_advanced_settings_click_about_port_forward' THEN 'Router Advanced Features: Click About Port Forwarding/IP Reservations'
        WHEN metric_name = 'portals_router_advanced_settings_click_manage_ip_reservations' THEN 'Router Advanced Features: Click Manage IP Reservations'
        WHEN metric_name = 'portals_router_advanced_settings_click_create_ip_reservation' THEN 'Router Advanced Features: Click Create IP Reservation'
        WHEN metric_name = 'portals_router_advanced_settings_reserve_ip_toggle_on' THEN 'Router Advanced Features: Reserve IP Toggle ON'
        WHEN metric_name = 'portals_router_advanced_settings_reserve_ip_toggle_off' THEN 'Router Advanced Features: Reserve IP Toggle OFF'
        WHEN metric_name = 'portals_router_advanced_settings_click_add_port_assignment' THEN 'Router Advanced Features: Click Add Port Assignment'
        WHEN metric_name = 'portals_router_advanced_settings_click_cancel_port_assignment' THEN 'Router Advanced Features: Click Cancel Add Port Assignment'
        WHEN metric_name = 'portals_router_advanced_settings_port_unavailable_modal' THEN 'Router Advanced Features: Port Unavailable Modal'
        WHEN metric_name = 'portals_router_advanced_settings_click_use_existing_port' THEN 'Router Advanced Features: Click Use Existing Port'
        WHEN metric_name = 'portals_router_advanced_settings_click_delete_port' THEN 'Router Advanced Features: Click Delete Port Assignment'
        WHEN metric_name = 'portals_router_advanced_settings_click_delete_or_cancel_delete_port' THEN 'Router Advanced Features: Click Delete/Cancel Delete Port Assignment'
        WHEN metric_name = 'portals_router_advanced_settings_delete_port_assignment_via_swipe' THEN 'Router Advanced Features: Delete Port Assignment by Swipe'
        WHEN metric_name = 'portals_router_advanced_settings_click_upnp' THEN 'Router Advanced Features: Click Universal Plug and Play'
        WHEN metric_name = 'portals_router_advanced_settings_upnp_toggle_on' THEN 'Router Advanced Features: Universal Plug and Play Toggle ON'
        WHEN metric_name = 'portals_router_advanced_settings_upnp_toggle_off' THEN 'Router Advanced Features: Universal Plug and Play Toggle OFF'
        WHEN metric_name = 'portals_router_advanced_settings_click_dns' THEN 'Router Advanced Features: Click DNS Server'
        WHEN metric_name = 'portals_router_advanced_settings_click_manage_dns' THEN 'Router Advanced Features: Click Manage DNS'
        WHEN metric_name = 'portals_router_advanced_settings_click_save_confirm_dns' THEN 'Router Advanced Features: Click Save DNS Server Change'
        WHEN metric_name = 'portals_router_advanced_settings_click_cancel_dns_change' THEN 'Router Advanced Features: Click Cancel DNS Server Change'
        WHEN metric_name = 'portals_router_advanced_settings_click_reset_dns_default' THEN 'Router Advanced Features: Click Reset to DNS Default'
        WHEN metric_name = 'portals_router_advanced_settings_click_spectrum_dns_default' THEN 'Router Advanced Features: Click Use Spectrum DNS'
        WHEN metric_name = 'portals_edit_ssid_home_screen_prompt' THEN 'Edit SSID: Home Screen Prompt'
        WHEN metric_name = 'portals_edit_ssid_click_manage_wifi_network_tile' THEN 'Edit SSID: Click Manage WiFi Network Tile'
        WHEN metric_name = 'portals_wifi_pw_changes' THEN 'WiFi Password Change'

          --Homepage/Nav
        WHEN metric_name = 'portals_auth_homepage_page_views' THEN 'Authenticated Homepage Page Views'
        WHEN metric_name = 'portals_cancelled_service_appointments' THEN 'Cancelled Service Appointments'
--        WHEN metric_name = 'portals_dashboard_view' THEN 'Dashboard Views' --(REMOVING FROM SS ONLY)
        WHEN metric_name = 'portals_ed_my_internet_services' THEN 'My Internet Services'
        WHEN metric_name = 'portals_ed_my_tv_services' THEN 'My TV Services'
        WHEN metric_name = 'portals_ed_my_voice_services' THEN 'My Voice Services'
        WHEN metric_name = 'portals_footer_charter_corporate_about_us' THEN 'Footer - Charter Corporate About Us'
        WHEN metric_name = 'portals_footer_charter_corporate_guarantee' THEN 'Footer - Charter Corporate Guarantee'
        WHEN metric_name = 'portals_footer_contactus_contact_us' THEN 'Footer - Contact Us'
        WHEN metric_name = 'portals_footer_contactus_find_spectrum_store' THEN 'Footer - Find a Spectrum Store'
        WHEN metric_name = 'portals_footer_contactus_weather_outage' THEN 'Footer - Weather Outage'
        WHEN metric_name = 'portals_footer_accessibility' THEN 'Footer - Get Support: Accessibility'
        WHEN metric_name = 'portals_footer_getsupport_acct_support' THEN 'Footer - Get Support: Account Support'
        WHEN metric_name = 'portals_footer_getsupport_internet' THEN 'Footer - Get Support: Internet'
        WHEN metric_name = 'portals_footer_getsupport_support_home' THEN 'Footer - Get Support: Support Home'
        WHEN metric_name = 'portals_footer_getsupport_tv' THEN 'Footer - Get Support: TV'
        WHEN metric_name = 'portals_footer_getsupport_voice' THEN 'Footer - Get Support: Voice'
        WHEN metric_name = 'portals_footer_legal_ca_privacy_rights' THEN 'Footer - Legal: CA Privacy Rights'
        WHEN metric_name = 'portals_footer_legal_go_to_assist' THEN 'Footer - Legal: Go to Assist'
        WHEN metric_name = 'portals_footer_legal_policies' THEN 'Footer - Legal: Policies'
        WHEN metric_name = 'portals_footer_legal_privacy_rights' THEN 'Footer - Legal: Privacy Rights'
        WHEN metric_name = 'portals_footer_manageaccount_billing' THEN 'Footer - Manage Account: Billng'
        WHEN metric_name = 'portals_footer_manageaccount_internet' THEN 'Footer - Manage Account: Internet'
        WHEN metric_name = 'portals_footer_manageaccount_manage_users' THEN 'Footer - Manage Account: Manage Users'
        WHEN metric_name = 'portals_footer_manageaccount_mobile' THEN 'Footer - Manage Account: Mobile'
        WHEN metric_name = 'portals_footer_manageaccount_settings' THEN 'Footer - Manage Account: Settings'
        WHEN metric_name = 'portals_footer_manageaccount_tv' THEN 'Footer - Manage Account: TV'
        WHEN metric_name = 'portals_footer_manageaccount_voice' THEN 'Footer - Manage Account: Voice'
        WHEN metric_name = 'portals_footer_social_facebook' THEN 'Footer - Social: Facebook'
        WHEN metric_name = 'portals_footer_social_instagram' THEN 'Footer - Social: Instagram'
        WHEN metric_name = 'portals_footer_social_linkedin' THEN 'Footer - Social: LinkedIn'
        WHEN metric_name = 'portals_footer_social_twitter' THEN 'Footer - Social: Twitter'
        WHEN metric_name = 'portals_footer_social_youtube' THEN 'Footer - Social: Youtube'
        WHEN metric_name = 'portals_footer_watchtv_dvr' THEN 'Footer - Watch TV: DVR'
        WHEN metric_name = 'portals_footer_watchtv_guide' THEN 'Footer - Watch TV: Guide'
        WHEN metric_name = 'portals_footer_watchtv_live_tv' THEN 'Footer - Watch TV: Live TV'
        WHEN metric_name = 'portals_footer_watchtv_my_library' THEN 'Footer - Watch TV: My Library'
        WHEN metric_name = 'portals_footer_watchtv_on_demand' THEN 'Footer - Watch TV: On Demand'
        WHEN metric_name = 'portals_add_internet_banner_click' THEN 'Banner Add: Internet'
        WHEN metric_name = 'portals_add_tv_banner_click' THEN 'Banner Add: TV'
        WHEN metric_name = 'portals_add_voice_banner_click' THEN 'Banner Add: Voice'
        WHEN metric_name = 'portals_hamburger_closesidenav' THEN 'Hamburger - closeSideNav'
        WHEN metric_name = 'portals_hamburger_create_username' THEN 'Hamburger - Create Username'
        WHEN metric_name = 'portals_hamburger_email' THEN 'Hamburger - Email'
        WHEN metric_name = 'portals_hamburger_get_support' THEN 'Hamburger - Get Support'
        WHEN metric_name = 'portals_hamburger_manage_account' THEN 'Hamburger - Manage Account'
        WHEN metric_name = 'portals_hamburger_signin' THEN 'Hamburger - Sign In'
        WHEN metric_name = 'portals_hamburger_signout' THEN 'Hamburger - Signout'
        WHEN metric_name = 'portals_hamburger_voice' THEN 'Hamburger - Voice'
        WHEN metric_name = 'portals_hamburger_watch_tv' THEN 'Hamburger - Watch TV'
        WHEN metric_name = 'portals_iva_opens' THEN 'IVA Opens'
        WHEN metric_name = 'portals_localnav_internet' THEN 'LocalNav - Internet'
        WHEN metric_name = 'portals_localnav_settings' THEN 'LocalNav - Settings'
        WHEN metric_name = 'portals_localnav_tv' THEN 'LocalNav - TV'
        WHEN metric_name = 'portals_localnav_users' THEN 'LocalNav - Users'
        WHEN metric_name = 'portals_localnav_voice' THEN 'LocalNav - Voice'
        WHEN metric_name = 'portals_page_views' THEN 'Page Views'
        WHEN metric_name = 'portals_rescheduled_service_appointments' THEN 'Rescheduled Service Appointments'
        WHEN metric_name = 'portals_site_unique_auth' THEN 'Site Unique Values Authenticated'
        WHEN metric_name = 'portals_site_unique_mobile' THEN 'Device Count Mobile'
        WHEN metric_name = 'portals_site_unique_pc' THEN 'Device Count PC'
        WHEN metric_name = 'portals_site_unique' THEN 'Site Unique Values'
        WHEN metric_name = 'portals_support_button' THEN 'Support Button'
        WHEN metric_name = 'portals_unauth_homepage_page_views' THEN 'Unauthenticated Homepage Page Views'
        WHEN metric_name = 'portals_upgrade_links_overview' THEN 'Upgrade Links Overview'
        WHEN metric_name = 'portals_upgrade_service_internet' THEN 'Upgrade Service Internet'
        WHEN metric_name = 'portals_upgrade_service_tv' THEN 'Upgrade Service TV'
        WHEN metric_name = 'portals_upgrade_service_voice' THEN 'Upgrade Service Voice'
        WHEN metric_name = 'portals_utilitynav_email' THEN 'Utility Navigation - Email'
        WHEN metric_name = 'portals_utilitynav_support' THEN 'Utility Navigation - Support'
        WHEN metric_name = 'portals_utilitynav_voice' THEN 'Utility Navigation - Voice'
        WHEN metric_name = 'portals_yourservicesequip_internet' THEN 'Your Services Equipment - Internet'
        WHEN metric_name = 'portals_yourservicesequip_mobile' THEN 'Your Services Equipment - Mobile'
        WHEN metric_name = 'portals_yourservicesequip_tv' THEN 'Your Services Equipment - TV'
        WHEN metric_name = 'portals_yourservicesequip_voice' THEN 'Your Services Equipment - Voice'
        WHEN metric_name = 'portals_footer_manageaccount_account_summary' THEN 'Footer - Manage Account: Account Summary'
        WHEN metric_name = 'portals_localnav_acct_summary' THEN 'LocalNav - Account Summary'
        WHEN metric_name = 'portals_localnav_billing' THEN 'LocalNav - Billing'
        WHEN metric_name = 'portals_select_actions' THEN 'Select Actions'
        WHEN metric_name = 'portals_my_services_email' THEN 'My Services: Email'
        WHEN metric_name = 'portals_my_services_desktop_security' THEN 'My Services: Desktop Security'
        WHEN metric_name = 'portals_my_services_web_hosting' THEN 'My Services: Web Hosting'
        WHEN metric_name = 'portals_my_services_cloud_backup' THEN 'My Services: Cloud Backup'
        WHEN metric_name = 'portals_equipmentnav_check_email' THEN 'Equipment Navigation - Email'
        WHEN metric_name = 'portals_support_header_nav_account' THEN 'Support Header Nav: Account'
        WHEN metric_name = 'portals_support_header_nav_home_security' THEN 'Support Header Nav: Home Security'
        WHEN metric_name = 'portals_support_header_nav_internet' THEN 'Support Header Nav: Internet'
        WHEN metric_name = 'portals_support_header_nav_mobile' THEN 'Support Header Nav: Mobile'
        WHEN metric_name = 'portals_support_header_nav_support_home' THEN 'Support Header Nav: Support Home'
        WHEN metric_name = 'portals_support_header_nav_tv' THEN 'Support Header Nav: TV'
        WHEN metric_name = 'portals_support_header_nav_voice' THEN 'Support Header Nav: Voice'
        WHEN metric_name = 'portals_voice_go_to_vom' THEN 'Go to Voice Online Manager'
        WHEN metric_name = 'portals_navigation_go_to_security' THEN 'Go to Security Suite'
        WHEN metric_name = 'portals_footer_globalnav_voice' THEN 'Footer - Global Nav: Voice'

          --Secured Device Connection Metrics
        WHEN metric_name = 'portals_cancel_edit_device_nickname' THEN 'Cancel Edit Device Nickname'
        WHEN metric_name = 'portals_cancel_edit_wifi_network_changes' THEN 'Cancel Edit Wifi Network Changes'
        WHEN metric_name = 'portals_cancel_edit_wifi_network' THEN 'Cancel Edit Wifi Network'
        WHEN metric_name = 'portals_cancel_pause_device' THEN 'Cancel Pause Device'
        WHEN metric_name = 'portals_cancel_remove_device' THEN 'Cancel Remove Device'
        WHEN metric_name = 'portals_cancel_unpause_device' THEN 'Cancel Unpause Device'
        WHEN metric_name = 'portals_close_hostname_tooltip' THEN 'Close Hostname Tooltip'
        WHEN metric_name = 'portals_close_mac_address_tooltip' THEN 'Close Mac Address Tooltip'
        WHEN metric_name = 'portals_close_network_tooltip' THEN 'Close Network Tooltip'
        WHEN metric_name = 'portals_confirm_edit_wifi_network_changes' THEN 'Confirm Edit Wifi Network Changes'
        WHEN metric_name = 'portals_confirm_remove_device' THEN 'Confirm Remove Device'
        WHEN metric_name = 'portals_open_edit_device_nickname' THEN 'Open Edit Device Nickname'
        WHEN metric_name = 'portals_open_edit_wifi_network' THEN 'Open Edit Wifi Network'
        WHEN metric_name = 'portals_open_hostname_tooltip' THEN 'Open Hostname Tooltip'
        WHEN metric_name = 'portals_open_mac_address_tooltip' THEN 'Open Mac Address Tooltip'
        WHEN metric_name = 'portals_open_network_tooltip' THEN 'Open Network Tooltip'
        WHEN metric_name = 'portals_open_pause_device' THEN 'Open Pause Device'
        WHEN metric_name = 'portals_open_remove_device' THEN 'Open Remove Device'
        WHEN metric_name = 'portals_open_unpause_device' THEN 'Open Unpause Device'
        WHEN metric_name = 'portals_save_edit_device_nickname' THEN 'Save Edit Device Nickname'
        WHEN metric_name = 'portals_save_edit_wifi_network' THEN 'Save Edit Wifi Network'
        WHEN metric_name = 'portals_select_individual_connected_device' THEN 'Select Individual Connected Device'
        WHEN metric_name = 'portals_select_individual_not_connected_device' THEN 'Select Individual Not Connected Device'
        WHEN metric_name = 'portals_select_individual_paused_device' THEN 'Select Individual Paused Device'
        WHEN metric_name = 'portals_start_pause_device' THEN 'Start Pause Device'
        WHEN metric_name = 'portals_start_unpause_device' THEN 'Start Unpause Device'
        WHEN metric_name = 'portals_view_connected_devices' THEN 'View Connected Devices'
        WHEN metric_name = 'portals_view_edit_device_nickname' THEN 'View Edit Device Nickname'
        WHEN metric_name = 'portals_view_edit_wifi_network' THEN 'View Edit Wifi Network'
        WHEN metric_name = 'portals_view_hostname_tooltip' THEN 'View Hostname Tooltip'
        WHEN metric_name = 'portals_view_mac_address_tooltip' THEN 'View Mac Address Tooltip'
        WHEN metric_name = 'portals_view_network_tooltip' THEN 'View Network Tooltip'
        WHEN metric_name = 'portals_view_not_connected_devices' THEN 'View Not Connected Devices'
        WHEN metric_name = 'portals_view_pause_device' THEN 'View Pause Device'
        WHEN metric_name = 'portals_view_paused_devices' THEN 'View Paused Devices'
        WHEN metric_name = 'portals_view_remove_device' THEN 'View Remove Device'
        WHEN metric_name = 'portals_view_unpause_device' THEN 'View Unpause Device'

          --Voice Metrics
        WHEN metric_name = 'portals_voice_delete_messages' THEN 'Delete Messages'
        WHEN metric_name = 'portals_voice_pageviews' THEN 'Site Unique Voice Pageviews'
        WHEN metric_name = 'portals_voice_play_messages' THEN 'Play Messages'
        WHEN metric_name = 'portals_voice_update_call_forward_settings' THEN 'Update Call Forward Settings'
        WHEN metric_name = 'portals_voice_view_messages' THEN 'View Messages'
        WHEN metric_name = 'portals_voice_voicemail_pause_select_action' THEN 'Voicemail Pause'
        WHEN metric_name = 'portals_voice_voicemail_view_select_action' THEN 'Voicemail Click'
        WHEN metric_name = 'portals_access_voice_platform_via_tile' THEN 'Access Voice Via Tile'
        WHEN metric_name = 'portals_vas_tile_domain_registration' THEN 'VAS Tile: Domain Registration'
        WHEN metric_name = 'portals_vas_tile_email' THEN 'VAS Tile: Email'
        WHEN metric_name = 'portals_vas_tile_desktop_security' THEN 'VAS Tile: Desktop Security'
        WHEN metric_name = 'portals_vas_tile_web_hosting' THEN 'VAS Tile: Web Hosting'

          --Settings Metrics
        WHEN metric_name = 'portals_settings_moving_select_action' THEN 'Your Info: Click on Moving'
        WHEN metric_name = 'portals_settings_sign_in_security_add_person_cancel_modal' THEN 'People: Add Person Cancel'
        WHEN metric_name = 'portals_settings_sign_in_security_add_person_save_modal' THEN 'People: Add Person Save'
        WHEN metric_name = 'portals_settings_sign_in_security_cancel_select_action' THEN 'Sign-In & Security: Manage Cancel'
        WHEN metric_name = 'portals_settings_sign_in_security_manage_select_action' THEN 'Sign-In & Security: Manage'
        WHEN metric_name = 'portals_settings_sign_in_security_manage_voice_line_select_action' THEN 'People: Click Manage Voice Line'
        WHEN metric_name = 'portals_settings_sign_in_security_people_add_select_action' THEN 'People: Click Add People'
        WHEN metric_name = 'portals_settings_sign_in_security_people_delete_select_action' THEN 'People: People Click Delete'
        WHEN metric_name = 'portals_settings_sign_in_security_save_select_action' THEN 'Sign-In & Security: Manage Save'
        WHEN metric_name = 'portals_settings_sign_in_security_subnav_people_select_action' THEN 'People: Click People Tab'
        WHEN metric_name = 'portals_settings_sign_in_security_voice_access_toggleoff_select_action' THEN 'Sign-In & Security: Voice Access Toggle OFF'
        WHEN metric_name = 'portals_settings_sign_in_security_voice_access_toggleon_select_action' THEN 'Sign-In & Security: Voice Access Toggle ON'
        WHEN metric_name = 'portals_settings_verify_select_action' THEN 'Your Info: Click on Verify phn/email'
        WHEN metric_name = 'portals_settings_your_info_cancel_select_action' THEN 'Your Info: Click Cancel Manage Info'
        WHEN metric_name = 'portals_settings_your_info_change_role_select_action' THEN 'Your Info: Click Change Role'
        WHEN metric_name = 'portals_settings_your_info_manage_select_action' THEN 'Your Info: Click on Manage Contact Info'
        WHEN metric_name = 'portals_settings_your_info_resend_verify_code' THEN 'Your Info: Resend Code and Verify'
        WHEN metric_name = 'portals_settings_your_info_save_select_action' THEN 'Your Info: Click Save Manage Info'
        WHEN metric_name = 'portals_settings_your_info_select_action' THEN 'Your Info: Click on Your Info '
        WHEN metric_name = 'portals_settings_your_info_verify_failure' THEN 'Your Info: Verification Failure'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_phone_modal_view' THEN 'Your Info: Verify ID Modal (Phonel)'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_email_modal_view' THEN 'Your Info: Verify ID Modal (Email)'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_modal_view' THEN 'Your Info: Verify ID Modal'
        WHEN metric_name = 'portals_settings_your_info_verify_success' THEN 'Your Info: Verification Success'
        WHEN metric_name = 'portals_settings_your_info_changes_success' THEN 'Your Info: Manage Info Success'
        WHEN metric_name = 'portals_settings_ad_marketing_card_select_action' THEN 'Settings: Ad & Marketing Clicks'
        WHEN metric_name = 'portals_settings_parental_controls_select_action' THEN 'Settings: Parental Controls Clicks'
        WHEN metric_name = 'portals_settings_navigate_to_vom' THEN 'Settings: Navigate to VOM Card'
        WHEN metric_name = 'portals_settings_navigate_to_mobile' THEN 'Settings: Navigate to Mobile Card'
        WHEN metric_name = 'portals_settings_navigate_to_accessibility' THEN 'Settings: Navigate to Accessibility Card'
        WHEN metric_name = 'portals_account_settings_home_page_views' THEN 'Account Settings: Home Page Views'
        WHEN metric_name = 'portals_account_settings_home_page_api_error' THEN 'Account Settings: API Error'
        WHEN metric_name = 'portals_account_settings_click_install_wifi_profile' THEN 'Account Settings: Click Install WiFi Profile'
        WHEN metric_name = 'portals_account_settings_your_info_tab_views' THEN 'Account Settings: Your Info Views'
        WHEN metric_name = 'portals_account_settings_your_info_change_primary_user_role' THEN 'Account Settings: Click Change Primary User Role'
        WHEN metric_name = 'portals_account_settings_your_info_change_role' THEN 'Account Settings: Your Info Change Role Views'
        WHEN metric_name = 'portals_account_settings_your_info_role_change_save' THEN 'Account Settings: User Details Save Role Change'
        WHEN metric_name = 'portals_account_settings_your_info_role_change_cancel' THEN 'Account Settings: User Details Cancel Role Change'
        WHEN metric_name = 'portals_account_settings_click_manage_contact_info' THEN 'Account Settings: Click Manage Contact Info'
        WHEN metric_name = 'portals_account_settings_manage_contact_info_page_views' THEN 'Account Settings: Manage Contact Info Page Views'
        WHEN metric_name = 'portals_account_settings_click_save_contact_info' THEN 'Account Settings: Click Save Contact Info'
        WHEN metric_name = 'portals_account_settings_cancel_manage_contact_info' THEN 'Account Settings: Click Cancel Manage Contact Info'
        WHEN metric_name = 'portals_account_settings_click_verify_email' THEN 'Account Settings: Click Verify Email'
        WHEN metric_name = 'portals_account_settings_verify_identity_click' THEN 'Account Settings: Click Verify ID'
        WHEN metric_name = 'portals_account_settings_error_expired_code' THEN 'Account Settings: Error - Expired Code'
        WHEN metric_name = 'portals_account_settings_error_incorrect_code' THEN 'Account Settings: Error - Incorrect Code Entered'
        WHEN metric_name = 'portals_account_settings_click_resend_code' THEN 'Account Settings: Click Resend Code'
        WHEN metric_name = 'portals_account_settings_click_verify_phone_number' THEN 'Account Settings: Click Verify Phone Number'
        WHEN metric_name = 'portals_account_settings_click_send_verification_via_text' THEN 'Account Settings: Click Send Verification Text'
        WHEN metric_name = 'portals_account_settings_click_send_verification_phone_call' THEN 'Account Settings: Click Send Verification Phone Call'
        WHEN metric_name = 'portals_account_settings_click_manage_people' THEN 'Account Settings: Click Manage People'
        WHEN metric_name = 'portals_account_settings_manage_people_page_views' THEN 'Account Settings: Manage People Page Views'
        WHEN metric_name = 'portals_account_settings_click_add_person' THEN 'Account Settings: Click Add Person'
        WHEN metric_name = 'portals_account_settings_add_person_page_views' THEN 'Account Settings: Add Person Page Views'
        WHEN metric_name = 'portals_account_settings_click_save_add_person' THEN 'Account Settings: Click Save Add Person'
        WHEN metric_name = 'portals_account_settings_click_cancel_add_person' THEN 'Account Settings: Click Cancel Add Person'
        WHEN metric_name = 'portals_account_settings_click_save_add_admin' THEN 'Account Settings: Click Save Add Admin'
        WHEN metric_name = 'portals_account_settings_click_save_add_standard' THEN 'Account Settings: Click Save Add Standard'
        WHEN metric_name = 'portals_account_settings_click_resend_invite' THEN 'Account Settings: Click Resend Invite'
        WHEN metric_name = 'portals_account_settings_click_change_role_from_manage_people' THEN 'Account Settings: Click Change Role from Manage People'
        WHEN metric_name = 'portals_account_settings_click_change_role' THEN 'Account Settings: Click Change Role'
        WHEN metric_name = 'portals_account_settings_click_change_to_standard_role' THEN 'Account Settings: Click Change to Standard Role'
        WHEN metric_name = 'portals_account_settings_click_cancel_add_or_change_role' THEN 'Account Settings: Click Cancel from Add/Change Role'
        WHEN metric_name = 'portals_account_settings_click_delete_user' THEN 'Account Settings: Click Delete User'

         --Guided Tour/Onboarding
        WHEN metric_name = 'portals_guided_tour_initiated_modal_view' THEN 'Guided Tour Initiated'
        WHEN metric_name = 'portals_guided_tour_zero_of_three' THEN 'Guided Tour Step 0 of 3'
        WHEN metric_name = 'portals_guided_tour_one_of_three' THEN 'Guided Tour Step 1 of 3'
        WHEN metric_name = 'portals_guided_tour_two_of_three' THEN 'Guided Tour Step 2 of 3'
        WHEN metric_name = 'portals_guided_tour_three_of_three' THEN 'Guided Tour Step 3 of 3'
        WHEN metric_name = 'portals_guided_tour_show_me_later' THEN 'Show Me Later'
        WHEN metric_name = 'portals_guided_tour_click_next' THEN 'Click Next'
        WHEN metric_name = 'portals_guided_tour_click_previous' THEN 'Click Previous'
        WHEN metric_name = 'portals_guided_tour_exit' THEN 'Exit'
        WHEN metric_name = 'portals_guided_tour_onboard_welcome' THEN 'Onboard Welcome Page'
        WHEN metric_name = 'portals_guided_tour_onboard_continue' THEN 'Onboard Continue'
        WHEN metric_name = 'portals_tutorial_views' THEN 'Tutorial Views'
        WHEN metric_name = 'portals_tutorial_start_page_one_page_view' THEN 'Onboarding Tutorial - Page One View'
        WHEN metric_name = 'portals_tutorial_otp_page_two_page_view' THEN 'Onboarding Tutorial - Page Two View'
        WHEN metric_name = 'portals_tutorial_equip_page_three_page_view' THEN 'Onboarding Tutorial - Page Three View'
        WHEN metric_name = 'portals_tutorial_account_page_four_page_view' THEN 'Onboarding Tutorial - Page Four View'
        WHEN metric_name = 'portals_tutorial_account_page_five_page_view' THEN 'Onboarding Tutorial - Page Five View'
        WHEN metric_name = 'portals_cancel_tutorial_start_page_one' THEN 'Onboarding Tutorial - Cancel Page One Cancel'
        WHEN metric_name = 'portals_cancel_tutorial_otp_page_two' THEN 'Onboarding Tutorial - Cancel Page Two Cancel'
        WHEN metric_name = 'portals_cancel_tutorial_equip_page_three' THEN 'Onboarding Tutorial - Cancel Page Three Cancel'
        WHEN metric_name = 'portals_cancel_tutorial_account_page_four' THEN 'Onboarding Tutorial - Cancel Page Four Cancel'

         --Tech Tracker
        WHEN metric_name = 'portals_tech_tracker_auth_views' THEN 'Tech Tracker: Authenticated Views'
        WHEN metric_name = 'portals_tech_tracker_unauth_views' THEN 'Tech Tracker: Un-Authenticated Views'
        WHEN metric_name = 'portals_tech_tracker_reschedule_starts_auth' THEN 'Tech Tracker: Reschedule Starts (Auth)'
        WHEN metric_name = 'portals_tech_tracker_cancel_attempt_auth' THEN 'Tech Tracker: Cancel Attempt (Auth)'
        WHEN metric_name = 'portals_tech_tracker_reschedule_starts_unauth'  THEN 'Tech Tracker: Reschedule Starts (UnAuth)'
        WHEN metric_name = 'portals_tech_tracker_cancel_attempt_unauth'  THEN 'Tech Tracker: Cancel Attempt (UnAuth)'

         --Account Status Dashboard
        WHEN metric_name = 'portals_security_qa_campaign_interaction' THEN 'Security QA: Campaign Interaction'
        WHEN metric_name = 'portals_security_qa_update_security_page_view' THEN 'Security QA: Update Security'
        WHEN metric_name = 'portals_security_qa_icon_select_action' THEN 'Security QA: Icon Click'
        WHEN metric_name = 'portals_security_qa_skip_this' THEN 'Security QA: Skip This'
        WHEN metric_name = 'portals_security_qa_cancel_close' THEN 'Security QA: Cancel / Close Window'
        WHEN metric_name = 'portals_update_missing_contact_save_all' THEN 'Update Missing Contact: Save All'
        WHEN metric_name = 'portals_update_missing_contact_save_and_continue' THEN 'Update Missing Contact: Save & Continue'
        WHEN metric_name = 'portals_update_missing_contact_save' THEN 'Update Missing Contact: Save'
        WHEN metric_name = 'portals_update_missing_contact_update_all' THEN 'Update Missing Contact: Update ALL'
        WHEN metric_name = 'portals_update_missing_contact_icon_click' THEN 'Update Missing Contact: Icon Click'
        WHEN metric_name = 'portals_update_missing_contact_skip_this' THEN 'Update Missing Contact: Skip This'
        WHEN metric_name = 'portals_update_missing_contact_cancel_close_window' THEN 'Update Missing Contact: Cancel / Close Window'
        WHEN metric_name = 'portals_update_missing_contact_campaign_interaction' THEN 'Update Missing Contact: Campaign Interaction'

         --SECURED CONNECTION PLATFORM
        WHEN metric_name = 'portals_scp_ddp_edit_device_nickname_cancel' THEN 'Device Details Page: Click Cancel Edit Nickname'
        WHEN metric_name = 'portals_scp_remove_device_cancel' THEN 'Click Cancel Remove Device'
        WHEN metric_name = 'portals_scp_remove_device_confirm' THEN 'Click Confirm Remove Device'
        WHEN metric_name = 'portals_scp_view_device_details' THEN 'View Device Details'
        WHEN metric_name = 'portals_scp_ddp_edit_device_nickname' THEN 'Device Details Page: Click Edit Nickname'
        WHEN metric_name = 'portals_scp_click_pause_device' THEN 'Click Pause Device'
        WHEN metric_name = 'portals_scp_click_pause_unpause_device_icon' THEN 'Click Pause/UnPause Device Icon'
        WHEN metric_name = 'portals_scp_click_pause_unpause_device_paused_tab' THEN 'Click Pause/UnPause Device From Paused Tab'
        WHEN metric_name = 'portals_scp_ddp_click_pause_unpause_device' THEN 'Device Details Page: Click Pause/UnPause Device'
        WHEN metric_name = 'portals_scp_ddp_click_confirm_pause_unpause_device' THEN 'Device Details Page: Click Confirm Pause/UnPause Device'
        WHEN metric_name = 'portals_scp_ddp_click_cancel_pause_unpause_device' THEN 'Device Details Page: Click Cancel Pause/UnPause Device'
        WHEN metric_name = 'portals_scp_click_cancel_pause_device' THEN 'Click Cancel Pause Device'
        WHEN metric_name = 'portals_scp_click_confirm_pause_device' THEN 'Click Confirm Pause Device'
        WHEN metric_name = 'portals_scp_ddp_click_remove_device' THEN 'Device Details Page: Click Remove Device'
        WHEN metric_name = 'portals_scp_ddp_save_device_nickname' THEN 'Device Details Page: Click Save Device Nickname'
        WHEN metric_name = 'portals_scp_click_unpause_device' THEN 'Click UnPause Device'
        WHEN metric_name = 'portals_scp_click_confirm_unpause_device' THEN 'Click Confirm UnPause Device'
        WHEN metric_name = 'portals_scp_click_cancel_unpause_device' THEN 'Click Cancel UnPause Device'
        WHEN metric_name = 'portals_scp_ddp_click_hostname_tooltip' THEN 'Device Details Page: Click Hostname Tooltip'
        WHEN metric_name = 'portals_scp_click_connected_devices_tab' THEN 'Click Connected Tab'
        WHEN metric_name = 'portals_scp_click_manage_device_tab' THEN 'Click Manage Devices Tab'
        WHEN metric_name = 'portals_scp_ddp_click_network_tooltip' THEN 'Device Details Page: Click Network Tooltip'
        WHEN metric_name = 'portals_scp_click_not_connected_devices_tab' THEN 'Click Not Connected Tab'
        WHEN metric_name = 'portals_scp_click_paused_tab' THEN 'Click Paused Tab'
        WHEN metric_name = 'portals_scp_ddp_click_mac_address_tooltip' THEN 'Device Details Page: Click MAC Address Tooltip'
        WHEN metric_name = 'portals_scp_flagged_customers' THEN 'SCP Customer Flag'
        WHEN metric_name = 'portals_scp_device_type_select' THEN 'Device Type Icon Click'
        WHEN metric_name = 'portals_scp_select_action_refresh' THEN 'MSA SCP Refresh'

         -- MSA FEEDBACK
        WHEN metric_name = 'portals_msa_experience_feedback_click_submit_feedback' THEN 'Experience Feedback: Submit Feedback'
        WHEN metric_name = 'portals_msa_experience_feedback_goal_accomplished' THEN 'Experience Feedback: Goal Accomplished'
        WHEN metric_name = 'portals_msa_experience_feedback_goal_not_accomplished' THEN 'Experience Feedback: Goal NOT Accomplished'
        WHEN metric_name = 'portals_csat_campaign_interaction' THEN 'Customer SAT: Campaign Interaction'
        WHEN metric_name = 'portals_csat_campaign_dismiss' THEN 'Customer SAT: Dismiss Campaign'
        WHEN metric_name = 'portals_csat_submit_rating_all' THEN 'Customer SAT: Submit Rating'
        WHEN metric_name = 'portals_csat_submit_rating_1_very_dissatisfied' THEN 'Customer SAT: Submit Rating 1 (Very Dissatisfied)'
        WHEN metric_name = 'portals_csat_submit_rating_2_dissatisfied' THEN 'Customer SAT: Submit Rating 2 (Dissatisfied)'
        WHEN metric_name = 'portals_csat_submit_rating_3_neutral' THEN 'Customer SAT: Submit Rating 3 (Neutral)'
        WHEN metric_name = 'portals_csat_submit_rating_4_satisfied' THEN 'Customer SAT: Submit Rating 4 (Satisfied)'
        WHEN metric_name = 'portals_csat_submit_rating_5_very_satisfied' THEN 'Customer SAT: Submit Rating 5 (Very Satisfied)'
        WHEN metric_name = 'portals_csat_submit_written_feedback' THEN 'Customer SAT: Submit Written Feedback'
        WHEN metric_name = 'portals_csat_submit_feedback_cancel_written_feedback' THEN 'Customer SAT: Submit Feedback (Cancel Written Feedback)'


  ELSE metric_name
  END AS `Metric Re-Name`,

   CASE
--alerts
        WHEN metric_name = 'portals_one_time_alert_clicked' THEN 'Alerts'
        WHEN metric_name = 'portals_one_time_page_alert_displayed' THEN 'Alerts'
--billing
        WHEN metric_name = 'portals_account_billing_support_views' THEN 'Billing'
        WHEN metric_name = 'portals_autopay_enroll_radio_toggle' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_select_amount' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_select_date' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_select_payment_method' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submits_with_ap' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submits_without_ap' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submits' THEN 'Billing'
--         WHEN metric_name = 'portals_bill_pay_clicks_from_bill_pay_card_on_hp' THEN 'Billing'
--         WHEN metric_name = 'portals_bill_pay_clicks_from_local_nav' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_failures' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_starts' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_successes_with_ap_enroll' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_successes_without_ap_enroll' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_successes' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_amount' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_checking_account' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_credit_debit_card' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_date_other' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_date_past_due' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_date_today' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_date' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_equals_amount_due' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_equals_current_balance' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_equals_past_due_amount' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_less_than_amount_due' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_less_than_current_balance' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_less_than_past_due_amount' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_more_than_amount_due' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_more_than_current_balance' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_more_than_past_due_amount' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_savings_account' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_failures' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_starts' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_successes_with_payment' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_successes_without_payment' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_successes' THEN 'Billing'
        WHEN metric_name = 'portals_view_online_statments' THEN 'Billing'
        WHEN metric_name = 'portals_billing_feature_interaction' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_enroll_from_homepage' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_billinghome' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_homepage' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit_from_paperless' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_submit' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paper_success' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paper_failure' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paper' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_keep_paperless' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_exit' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_manage_paperless' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_success' THEN 'Billing'
        WHEN metric_name = 'portals_bill_delivery_pref_paperless_failure' THEN 'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_submits' THEN  'Billing'
        WHEN metric_name = 'portals_set_up_auto_payment_submits_plus_otp' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submission_previously_stored_payment_method' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method_stored' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method_not_stored' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_submission_new_payment_method' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_before_posted_due_date' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_on_posted_due_date' THEN 'Billing'
        WHEN metric_name = 'portals_one_time_payment_after_posted_due_date' THEN 'Billing'

         --ID/Auth
        WHEN metric_name = 'portals_create_username_flow_failure' THEN 'ID/Auth'
        WHEN metric_name = 'portals_create_username_flow_start' THEN 'ID/Auth'
        WHEN metric_name = 'portals_create_username_flow_success' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_password_flow_failure' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_password_flow_start' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_password_success' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_username_flow_failure' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_username_flow_start' THEN 'ID/Auth'
        WHEN metric_name = 'portals_forgot_username_success' THEN 'ID/Auth'
        WHEN metric_name = 'portals_new_acct_created_all' THEN 'ID/Auth'
        WHEN metric_name = 'portals_new_admin_accounts_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_sub_user_creation_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_new_admin_accounts_created' THEN 'ID/Auth'
        WHEN metric_name = 'portals_new_ids_created_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_new_ids_created_successes' THEN 'ID/Auth'
        WHEN metric_name = 'portals_reset_password_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_sub_acct_created' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_verify_account_modal' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_verify_account_page' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_verify_account_success_modal' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_verify_account_success_page' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_complete_and_fail_modal' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_complete_and_fail_page' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_complete_and_submit_modal' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_complete_and_submit_page' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_abandon_roadblock_modal' THEN 'ID/Auth'
        WHEN metric_name = 'portals_cpni_abandon_roadblock_page' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_login_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_login_successes' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_login_failures' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_fingerprint_toggle_on' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_fingerprint_toggle_off' THEN 'ID/Auth'
        WHEN metric_name = 'portals_biometrics_fingerprint_enroll' THEN 'ID/Auth'
        WHEN metric_name = 'portals_login_attempts' THEN 'ID/Auth'
        WHEN metric_name = 'portals_login_failures' THEN 'ID/Auth'
        WHEN metric_name = 'portals_logout' THEN 'ID/Auth'

         --Support
        WHEN metric_name = 'portals_call_support' THEN 'Support'
        WHEN metric_name = 'portals_contact_our_moving_specialist' THEN 'Support'
        WHEN metric_name = 'portals_contact_us_page_views' THEN 'Support'
        WHEN metric_name = 'portals_get_moving_info' THEN 'Support'
        WHEN metric_name = 'portals_quick_tutorial' THEN 'Support'
        WHEN metric_name = 'portals_support_page_views' THEN 'Support'
        WHEN metric_name = 'portals_request_callback' THEN 'Support'
        WHEN metric_name = 'portals_support_article_select' THEN 'Support'

          --Equipment
        WHEN metric_name = 'portals_all_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_all_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_all_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_download_wifi_profile_button_click_android' THEN 'Equipment'
        WHEN metric_name = 'portals_download_wifi_profile_button_click_ios' THEN 'Equipment'
        WHEN metric_name = 'portals_download_wifi_profile_button_click' THEN 'Equipment'
        WHEN metric_name = 'portals_download_wifi_profile_success_android' THEN 'Equipment'
        WHEN metric_name = 'portals_download_wifi_profile_success_ios' THEN 'Equipment'
        WHEN metric_name = 'portals_download_wifi_profile_success' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_cancel_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failure_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_submit_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_success_modal_continue_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_manual_success_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_internet_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_tv_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_ed_progress_bar_modal_voice_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_internet_modal_view_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_tv_modal_view_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_reset_voice_modal_view_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_detail_views' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_list_view' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_page_views_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_all_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_internet_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_tv_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_equipment_resets_too_many_resets_modal_voice_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_install_wifi_profile_start' THEN 'Equipment'
        WHEN metric_name = 'portals_install_wifi_profile_success' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_internet_modem_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_modem_reset_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_modem_router_reset_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_router_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_router_reset_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_services_connection_issue_troubleshoot' THEN 'Equipment'
        WHEN metric_name = 'portals_manual_reset_failures_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_manual_reset_starts_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_manual_reset_success_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_refresh_digital_receiver_requests' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_tv_modem_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_router_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failures_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_starts_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_successes_deprecated_cl68' THEN 'Equipment Deprecated CL68'
        WHEN metric_name = 'portals_voice_modem_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_modem_reset_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_router_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_wifi_password_views' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_modal_wait' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_modal_wait' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_modal_wait' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_page_views' THEN 'Equipment'
        WHEN metric_name = 'portals_manual_reset_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_manual_reset_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_manual_reset_success' THEN 'Equipment'
        WHEN metric_name = 'portals_all_equipment_reset_flow_failures' THEN 'Equipment'
        WHEN metric_name = 'portals_all_equipment_reset_flow_starts' THEN 'Equipment'
        WHEN metric_name = 'portals_all_equipment_reset_flow_successes' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_feature_interaction' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_edit_ssid_select_action' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_confirm_edit_ssid_select_action' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_cancel_edit_ssid_select_action' THEN 'Equipment'
        WHEN metric_name = 'portals_internet_equipment_reset_flow_submit' THEN 'Equipment'
        WHEN metric_name = 'portals_tv_equipment_reset_flow_submit' THEN 'Equipment'
        WHEN metric_name = 'portals_voice_equipment_reset_flow_submit' THEN 'Equipment'
        WHEN metric_name = 'portals_equipment_reset_flow_submit_all'  THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_port_forward' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_about_port_forward' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_manage_ip_reservations' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_create_ip_reservation' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_reserve_ip_toggle_on' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_reserve_ip_toggle_off' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_add_port_assignment' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_cancel_port_assignment' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_port_unavailable_modal' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_use_existing_port' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_delete_port' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_delete_or_cancel_delete_port' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_delete_port_assignment_via_swipe' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_upnp' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_upnp_toggle_on' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_upnp_toggle_off' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_dns' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_manage_dns' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_save_confirm_dns' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_cancel_dns_change' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_reset_dns_default' THEN 'Equipment'
        WHEN metric_name = 'portals_router_advanced_settings_click_spectrum_dns_default' THEN 'Equipment'
        WHEN metric_name = 'portals_edit_ssid_home_screen_prompt' THEN 'Equipment'
        WHEN metric_name = 'portals_edit_ssid_click_manage_wifi_network_tile' THEN 'Equipment'
        WHEN metric_name = 'portals_wifi_pw_changes' THEN 'Equipment'


         --Homepage/Nav
        WHEN metric_name = 'portals_auth_homepage_page_views' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_cancelled_service_appointments' THEN 'Homepage/Nav'
--        WHEN metric_name = 'portals_dashboard_view' THEN 'Homepage/Nav' --(REMOVING FROM SS ONLY)
        WHEN metric_name = 'portals_ed_my_internet_services' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_ed_my_tv_services' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_ed_my_voice_services' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_charter_corporate_about_us' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_charter_corporate_guarantee' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_contactus_contact_us' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_contactus_find_spectrum_store' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_contactus_weather_outage' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_accessibility' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_getsupport_acct_support' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_getsupport_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_getsupport_support_home' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_getsupport_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_getsupport_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_legal_ca_privacy_rights' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_legal_go_to_assist' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_legal_policies' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_legal_privacy_rights' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_billing' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_manage_users' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_mobile' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_settings' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_social_facebook' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_social_instagram' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_social_linkedin' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_social_twitter' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_social_youtube' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_watchtv_dvr' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_watchtv_guide' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_watchtv_live_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_watchtv_my_library' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_watchtv_on_demand' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_add_internet_banner_click' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_add_tv_banner_click' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_add_voice_banner_click' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_closesidenav' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_create_username' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_email' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_get_support' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_manage_account' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_signin' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_signout' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_hamburger_watch_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_iva_opens' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_settings' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_users' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_page_views' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_rescheduled_service_appointments' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_site_unique_auth' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_site_unique_mobile' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_site_unique_pc' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_site_unique' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_button' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_unauth_homepage_page_views' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_upgrade_links_overview' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_upgrade_service_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_upgrade_service_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_upgrade_service_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_utilitynav_email' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_utilitynav_support' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_utilitynav_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_yourservicesequip_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_yourservicesequip_mobile' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_yourservicesequip_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_yourservicesequip_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_manageaccount_account_summary' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_acct_summary' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_localnav_billing' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_select_actions' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_my_services_email' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_my_services_desktop_security' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_my_services_web_hosting' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_my_services_cloud_backup' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_equipmentnav_check_email' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_account' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_home_security' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_internet' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_mobile' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_support_home' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_tv' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_support_header_nav_voice' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_voice_go_to_vom' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_navigation_go_to_security' THEN 'Homepage/Nav'
        WHEN metric_name = 'portals_footer_globalnav_voice' THEN 'Homepage/Nav'

       --Secured Device Connection Metrics
        WHEN metric_name = 'portals_cancel_edit_device_nickname' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_cancel_edit_wifi_network_changes' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_cancel_edit_wifi_network' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_cancel_pause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_cancel_remove_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_cancel_unpause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_close_hostname_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_close_mac_address_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_close_network_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_confirm_edit_wifi_network_changes' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_confirm_remove_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_edit_device_nickname' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_edit_wifi_network' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_hostname_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_mac_address_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_network_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_pause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_remove_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_open_unpause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_save_edit_device_nickname' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_save_edit_wifi_network' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_select_individual_connected_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_select_individual_not_connected_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_select_individual_paused_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_start_pause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_start_unpause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_connected_devices' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_edit_device_nickname' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_edit_wifi_network' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_hostname_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_mac_address_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_network_tooltip' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_not_connected_devices' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_pause_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_paused_devices' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_remove_device' THEN 'Secured Device Connection'
        WHEN metric_name = 'portals_view_unpause_device' THEN 'Secured Device Connection'

       --Voice Metrics
        WHEN metric_name = 'portals_voice_delete_messages' THEN 'Voice'
        WHEN metric_name = 'portals_voice_pageviews' THEN 'Voice'
        WHEN metric_name = 'portals_voice_play_messages' THEN 'Voice'
        WHEN metric_name = 'portals_voice_update_call_forward_settings' THEN 'Voice'
        WHEN metric_name = 'portals_voice_view_messages' THEN 'Voice'
        WHEN metric_name = 'portals_voice_voicemail_pause_select_action' THEN 'Voice'
        WHEN metric_name = 'portals_voice_voicemail_view_select_action' THEN 'Voice'
        WHEN metric_name = 'portals_access_voice_platform_via_tile' THEN 'Voice'
        WHEN metric_name = 'portals_vas_tile_domain_registration' THEN 'Voice'
        WHEN metric_name = 'portals_vas_tile_email' THEN 'Voice'
        WHEN metric_name = 'portals_vas_tile_desktop_security' THEN 'Voice'
        WHEN metric_name = 'portals_vas_tile_web_hosting' THEN 'Voice'

        --Settings Metrics
        WHEN metric_name = 'portals_settings_moving_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_add_person_cancel_modal' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_add_person_save_modal' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_cancel_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_manage_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_manage_voice_line_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_people_add_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_people_delete_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_save_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_subnav_people_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_voice_access_toggleoff_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_sign_in_security_voice_access_toggleon_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_verify_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_cancel_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_change_role_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_manage_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_resend_verify_code' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_save_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_verify_failure' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_phone_modal_view' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_email_modal_view' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_verify_identity_modal_view' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_verify_success' THEN 'Settings'
        WHEN metric_name = 'portals_settings_your_info_changes_success' THEN 'Settings'
        WHEN metric_name = 'portals_settings_ad_marketing_card_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_parental_controls_select_action' THEN 'Settings'
        WHEN metric_name = 'portals_settings_navigate_to_vom' THEN 'Settings'
        WHEN metric_name = 'portals_settings_navigate_to_mobile' THEN 'Settings'
        WHEN metric_name = 'portals_settings_navigate_to_accessibility' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_home_page_views' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_home_page_api_error' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_install_wifi_profile' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_your_info_tab_views' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_your_info_change_primary_user_role' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_your_info_change_role' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_your_info_role_change_save' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_your_info_role_change_cancel' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_manage_contact_info' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_manage_contact_info_page_views' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_save_contact_info' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_cancel_manage_contact_info' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_verify_email' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_verify_identity_click' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_error_expired_code' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_error_incorrect_code' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_resend_code' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_verify_phone_number' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_send_verification_via_text' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_send_verification_phone_call' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_manage_people' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_manage_people_page_views' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_add_person' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_add_person_page_views' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_save_add_person' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_cancel_add_person' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_save_add_admin' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_save_add_standard' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_resend_invite' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_change_role_from_manage_people' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_change_role' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_change_to_standard_role' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_cancel_add_or_change_role' THEN 'Settings'
        WHEN metric_name = 'portals_account_settings_click_delete_user' THEN 'Settings'

        --Guided Tour/Onboarding
        WHEN metric_name = 'portals_guided_tour_initiated_modal_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_zero_of_three' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_one_of_three' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_two_of_three' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_three_of_three' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_show_me_later' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_click_next' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_click_previous' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_exit' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_onboard_welcome' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_guided_tour_onboard_continue' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_views' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_start_page_one_page_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_otp_page_two_page_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_equip_page_three_page_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_account_page_four_page_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_tutorial_account_page_five_page_view' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_cancel_tutorial_start_page_one' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_cancel_tutorial_otp_page_two' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_cancel_tutorial_equip_page_three' THEN 'Guided Tour/Onboarding'
        WHEN metric_name = 'portals_cancel_tutorial_account_page_four' THEN 'Guided Tour/Onboarding'

        --Tech Tracker
        WHEN metric_name = 'portals_tech_tracker_auth_views' THEN 'Tech Tracker'
        WHEN metric_name = 'portals_tech_tracker_unauth_views' THEN 'Tech Tracker'
        WHEN metric_name = 'portals_tech_tracker_reschedule_starts_auth' THEN 'Tech Tracker'
        WHEN metric_name = 'portals_tech_tracker_cancel_attempt_auth' THEN 'Tech Tracker'
        WHEN metric_name = 'portals_tech_tracker_reschedule_starts_unauth'  THEN 'Tech Tracker'
        WHEN metric_name = 'portals_tech_tracker_cancel_attempt_unauth'  THEN 'Tech Tracker'

       --Account Status Dashboard
        WHEN metric_name = 'portals_security_qa_campaign_interaction' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_security_qa_update_security_page_view' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_security_qa_icon_select_action' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_security_qa_skip_this' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_security_qa_cancel_close' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_save_all' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_save_and_continue' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_save' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_update_all' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_icon_click' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_skip_this' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_cancel_close_window' THEN 'Account Status Dashboard'
        WHEN metric_name = 'portals_update_missing_contact_campaign_interaction' THEN 'Account Status Dashboard'

        --SECURED CONNECTION PLATFORM
        WHEN metric_name = 'portals_scp_ddp_edit_device_nickname_cancel' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_remove_device_cancel' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_remove_device_confirm' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_view_device_details' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_edit_device_nickname' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_pause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_pause_unpause_device_icon' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_pause_unpause_device_paused_tab' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_pause_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_confirm_pause_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_cancel_pause_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_cancel_pause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_confirm_pause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_remove_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_save_device_nickname' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_confirm_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_cancel_unpause_device' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_hostname_tooltip' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_connected_devices_tab' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_manage_device_tab' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_network_tooltip' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_not_connected_devices_tab' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_click_paused_tab' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_ddp_click_mac_address_tooltip' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_flagged_customers' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_device_type_select' THEN 'Secured Connection Platform'
        WHEN metric_name = 'portals_scp_select_action_refresh' THEN 'Secured Connection Platform'

        -- MSA EXPERIENCE RATING
        WHEN metric_name = 'portals_msa_experience_feedback_click_submit_feedback' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_msa_experience_feedback_goal_accomplished' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_msa_experience_feedback_goal_not_accomplished' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_campaign_interaction' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_campaign_dismiss' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_all' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_1_very_dissatisfied' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_2_dissatisfied' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_3_neutral' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_4_satisfied' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_rating_5_very_satisfied' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_written_feedback' THEN 'MSA Experience Rating'
        WHEN metric_name = 'portals_csat_submit_feedback_cancel_written_feedback' THEN 'MSA Experience Rating'

  ELSE 'Undefined'
  END AS `Metric Feature`,

unit_type AS Aggregation

FROM venona_set_agg_portals
where application_name IN ('myspectrum', 'specnet', 'smb')
  and grouping_id IN ('2049','2051','2081','2083','2561','2563','2593','2595')
  and label_date_denver >= '2018-08-22'
--AND metric_name in ('portals_view_online_statments_devices','portals_view_online_statments_instances','portals_view_online_statments_visits')
AND (
     (grain IN ('fiscal_monthly','monthly'))
     OR
     (grain = 'weekly' AND date_format(label_date_denver ,'u') = 4)
     OR
     (grain = 'daily' AND label_date_denver >= (DATE_SUB(CURRENT_DATE, 92)) )
    )


UNION ALL
-- Prod Monthly Metrics
SELECT
   case when grain = 'daily' then 'Daily'
        when grain = 'weekly' then 'Weekly'
        when grain = 'fiscal_monthly' then 'Fiscal Monthly'
        when grain = 'monthly' then 'Monthly'
        else grain end AS `Type`,
   metric_name     AS `Metric Name`,

   CASE WHEN mso IN ('"TWC"','L-TWC') THEN 'TWC'
        WHEN mso IN ('"BHN"','L-BHN') THEN 'BHN'
        when mso IN ('"CHTR"','L-CHTR') THEN 'CHTR'
        When mso IN ('unknown','MSO-MISSING') THEN 'Unknown'
        ELSE mso END AS `Company`,

  --mso AS `Company`,
   application_name as `Application Type`,
   os_version       as `OS Version`,
   browser_name     as `Browser Name`,
   network_status   as `Network Status`,
   browser_version  as `Browser Version`,
 --`cust_type` AS `Customer Type`,
 --  'All Stream Subtypes'     AS `Stream Subtype`,
 -- `application_group_type`   AS `Application Group Type`,
   app_version              AS `App Version`,
   grouping_id              AS `Grouping ID`,
   metric_value             AS `Metric Value`,
   CASE WHEN  grain = 'weekly' then label_date_denver
        else  'All Weeks' END                          AS `Week End Date`,
   label_date_denver        AS `Month Start`,
   CASE WHEN  grain in('fiscal_monthly','monthly') then 'All Days'
        else  label_date_denver end AS `Denver Date`,
   CASE
         WHEN metric_name = 'portals_call_support' THEN 'Call Support or Request Callback'
         WHEN metric_name = 'portals_cancelled_service_appointments' THEN 'Cancelled Appointments'
         WHEN metric_name = 'portals_forgot_password_success' THEN 'Forgot Password Success'
         WHEN metric_name = 'portals_forgot_username_flow_start' THEN 'Attempts to Recover ID'
         WHEN metric_name = 'portals_forgot_username_success' THEN 'Forgot Username Success'
         WHEN metric_name = 'portals_internet_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts Internet'
         WHEN metric_name = 'portals_one_time_payment_successes'  THEN 'One Time Payment'
         WHEN metric_name = 'portals_rescheduled_service_appointments' THEN 'Rescheduled Appointments'
         WHEN metric_name = 'portals_set_up_auto_payment_successes' THEN 'Set-up Autopay'
         WHEN metric_name = 'portals_support_page_views' THEN 'Support Section'
         WHEN metric_name = 'portals_tv_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts TV'
         WHEN metric_name = 'portals_view_online_statments' THEN 'View Online Statements'

   ELSE metric_name
   END AS `Metric Re-Name`,

   'Prod Monthly'     AS `Metric Feature`,     --inclusion controlled by WHERE clause, so all are Prod Monthly

unit_type AS Aggregation


FROM venona_set_agg_portals
where application_name IN ('myspectrum', 'specnet', 'smb')
and grouping_id IN ('2049','2051','2081','2083','2561','2563','2593','2595')
and label_date_denver >= '2018-08-22'
AND (
       metric_name = 'portals_call_support'
    OR metric_name = 'portals_cancelled_service_appointments'
    OR metric_name = 'portals_forgot_password_success'
    OR metric_name = 'portals_forgot_username_flow_start'
    OR metric_name = 'portals_forgot_username_success'
    OR metric_name = 'portals_internet_equipment_reset_flow_starts'
    OR metric_name = 'portals_one_time_payment_successes'
    OR metric_name = 'portals_rescheduled_service_appointments'
    OR metric_name = 'portals_set_up_auto_payment_successes'
    OR metric_name = 'portals_support_page_views'
    OR metric_name = 'portals_tv_equipment_reset_flow_starts'
    OR metric_name = 'portals_view_online_statments'
    )

AND (
      grain IN ('fiscal_monthly','monthly')
      OR (grain = 'weekly' AND date_format(label_date_denver ,'u') = 4)
      OR (grain = 'daily' AND label_date_denver >= (DATE_SUB(CURRENT_DATE, 92)) )
    )

UNION ALL
-- CX Monthly Metrics

SELECT
   case when grain = 'daily' then 'Daily'
        when grain = 'weekly' then 'Weekly'
        when grain = 'fiscal_monthly' then 'Fiscal Monthly'
        when grain = 'monthly' then 'Monthly'
        else grain end AS `Type`,
   metric_name         AS `Metric Name`,


   CASE WHEN mso IN ('"TWC"','L-TWC') THEN 'TWC'
        WHEN mso IN ('"BHN"','L-BHN') THEN 'BHN'
        when mso IN ('"CHTR"','L-CHTR') THEN 'CHTR'
        When mso IN ('unknown','MSO-MISSING') THEN 'Unknown'
        ELSE mso END   AS `Company`,


   application_name as `Application Type`,
   os_version       as `OS Version`,
   browser_name     as `Browser Name`,
   network_status   as `Network Status`,
   browser_version  as `Browser Version`,
 --`cust_type` AS `Customer Type`,
 --  'All Stream Subtypes'     AS `Stream Subtype`,
 -- `application_group_type`   AS `Application Group Type`,
   app_version              AS `App Version`,
   grouping_id              AS `Grouping ID`,
   metric_value             AS `Metric Value`,
   CASE WHEN  grain = 'weekly' then label_date_denver
        else  'All Weeks' END              AS `Week End Date`,
   label_date_denver        AS `Month Start`,
   CASE WHEN  grain in('fiscal_monthly','monthly') then 'All Days'
        else  label_date_denver end AS `Denver Date`,
   CASE
--CX Monthly Metrics
         WHEN metric_name = 'portals_account_billing_support_views' THEN 'Account & Billing Support Section Views'
         WHEN metric_name = 'portals_all_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures All'
         WHEN metric_name = 'portals_all_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts All'
         WHEN metric_name = 'portals_all_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes All'
         WHEN metric_name = 'portals_cancelled_service_appointments' THEN 'Appointment Management - Cancels'
         WHEN metric_name = 'portals_footer_getsupport_acct_support' THEN 'Acct Support Page Views'
         WHEN metric_name = 'portals_footer_getsupport_support_home' THEN 'Support Home Page Views'
         WHEN metric_name = 'portals_forgot_username_flow_start' THEN 'UN/PW Recovery Attempts'
         WHEN metric_name = 'portals_forgot_password_flow_start' THEN 'UN/PW Recovery Attempts'
         WHEN metric_name = 'portals_forgot_username_success' THEN 'UN/PW Recovery Completions'
         WHEN metric_name = 'portals_forgot_password_success' THEN 'UN/PW Recovery Completions'
         WHEN metric_name = 'portals_internet_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures Internet'
         WHEN metric_name = 'portals_internet_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts Internet'
         WHEN metric_name = 'portals_internet_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes Internet'
         WHEN metric_name = 'portals_internet_support_views' THEN 'Internet Support Section Views'
         WHEN metric_name = 'portals_one_time_payment_checking_account' THEN 'Customers with Final Payment Method = Checking'
         WHEN metric_name = 'portals_one_time_payment_checking' THEN 'One Time Payment Method Continue - Checking'
         WHEN metric_name = 'portals_one_time_payment_credit_debit_card' THEN 'Customers with Final Payment Method = Card'
         WHEN metric_name = 'portals_one_time_payment_credit' THEN 'One Time Payment Method Continue - Credit'
         WHEN metric_name = 'portals_one_time_payment_failures' THEN 'One Time Payment Flow: Failures'
         WHEN metric_name = 'portals_one_time_payment_savings_account' THEN 'Customers with Final Payment Method = Savings'
         WHEN metric_name = 'portals_one_time_payment_savings' THEN 'One Time Payment Method Continue - Savings'
         WHEN metric_name = 'portals_one_time_payment_submits' THEN 'One Time Payment Flow: Submits'
         WHEN metric_name = 'portals_one_time_payment_successes'  THEN 'One Time Payment Flow: Successes All'
         WHEN metric_name = 'portals_rescheduled_service_appointments' THEN 'Appointment Management - Reschedules'
         WHEN metric_name = 'portals_set_up_auto_payment_successes' THEN 'Auto-Pay Flow: Enrollment Successes All'
         WHEN metric_name = 'portals_site_unique_auth' THEN 'Unique Logged in Users'
         WHEN metric_name = 'portals_site_unique' THEN 'Unique Users'
         WHEN metric_name = 'portals_support_page_views' THEN 'Support Page Views'
         WHEN metric_name = 'portals_tv_equipment_reset_flow_failures' THEN 'Equipment Reset Flow Failures TV'
         WHEN metric_name = 'portals_tv_equipment_reset_flow_starts' THEN 'Equipment Reset Flow Starts TV'
         WHEN metric_name = 'portals_tv_equipment_reset_flow_successes' THEN 'Equipment Reset Flow Successes TV'
         WHEN metric_name = 'portals_video_support_views' THEN 'Video Support Section Views'
         WHEN metric_name = 'portals_voice_support_views' THEN 'Voice Support Section Views'

  ELSE metric_name
  END AS `Metric Re-Name`,

   'CX Monthly Metrics'   AS `Metric Feature`,   --inclusion controlled by WHERE clause, so all are CX

unit_type AS Aggregation


FROM venona_set_agg_portals
where `venona_set_agg_portals`.`application_name` IN ('myspectrum', 'specnet', 'smb')
and grouping_id IN ('2049','2051','2081','2083','2561','2563','2593','2595')
and `venona_set_agg_portals`.`label_date_denver` >= '2018-08-22'
AND
    (
       metric_name = 'portals_account_billing_support_views'
    OR metric_name = 'portals_all_equipment_reset_flow_failures'
    OR metric_name = 'portals_all_equipment_reset_flow_starts'
    OR metric_name = 'portals_all_equipment_reset_flow_successes'
    OR metric_name = 'portals_cancelled_service_appointments'
    OR metric_name = 'portals_footer_getsupport_acct_support'
    OR metric_name = 'portals_footer_getsupport_support_home'
    OR metric_name = 'portals_forgot_password_flow_start'
    OR metric_name = 'portals_forgot_password_success'
    OR metric_name = 'portals_forgot_username_flow_start'
    OR metric_name = 'portals_forgot_username_success'
    OR metric_name = 'portals_internet_equipment_reset_flow_failures'
    OR metric_name = 'portals_internet_equipment_reset_flow_starts'
    OR metric_name = 'portals_internet_equipment_reset_flow_successes'
    OR metric_name = 'portals_internet_support_views'
    OR metric_name = 'portals_one_time_payment_checking'
    OR metric_name = 'portals_one_time_payment_checking_account'
    OR metric_name = 'portals_one_time_payment_credit'
    OR metric_name = 'portals_one_time_payment_credit_debit_card'
    OR metric_name = 'portals_one_time_payment_failures'
    OR metric_name = 'portals_one_time_payment_savings'
    OR metric_name = 'portals_one_time_payment_savings_account'
    OR metric_name = 'portals_one_time_payment_submits'
    OR metric_name = 'portals_one_time_payment_successes'
    OR metric_name = 'portals_rescheduled_service_appointments'
    OR metric_name = 'portals_set_up_auto_payment_successes'
    OR metric_name = 'portals_site_unique_auth'
    OR metric_name = 'portals_site_unique'
    OR metric_name = 'portals_support_page_views'
    OR metric_name = 'portals_tv_equipment_reset_flow_failures'
    OR metric_name = 'portals_tv_equipment_reset_flow_starts'
    OR metric_name = 'portals_tv_equipment_reset_flow_successes'
    OR metric_name = 'portals_video_support_views'
    OR metric_name = 'portals_voice_support_views'

    )

AND
    (
      (grain IN ('fiscal_monthly','monthly'))
      OR (grain = 'weekly' AND date_format(label_date_denver ,'u') = 4)
      OR (grain = 'daily' AND label_date_denver >= (DATE_SUB(CURRENT_DATE, 92)) )
    )
    ;


DROP VIEW IF EXISTS portals_quantum_tableau_ss_summary;
CREATE VIEW IF NOT EXISTS portals_quantum_tableau_ss_summary AS
SELECT
  `Application Type`,
  `Metric Name`,
  `Metric Re-Name`,
  `Metric Feature`,
  SUM(`Metric Value`) AS metric_value

FROM portals_quantum_tableau_daily_agg_v
WHERE
  Type = 'Monthly'
    AND `Denver Date` >= (DATE_SUB(CURRENT_DATE, 32))
    AND `Grouping ID` = '2049'
GROUP BY
  `Application Type`,
  `Metric Name`,
  `Metric Re-Name`,
  `Metric Feature`
;
