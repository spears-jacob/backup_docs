USE ${env:ENVIRONMENT};

set mapreduce.input.fileinputformat.split.maxsize=5368709120;
set mapreduce.input.fileinputformat.split.minsize=5368709120;
set hive.optimize.sort.dynamic.partition=false;
set hive.exec.dynamic.partition.mode=nonstrict;
set orc.force.positional.evolution=true;

ADD JAR ${env:ARTIFACTS_PATH}/jars/epoch-1.0-SNAPSHOT.jar;
CREATE TEMPORARY FUNCTION epoch_converter AS 'Epoch_To_Denver';

INSERT OVERWRITE TABLE ${env:ENVIRONMENT}.quantum_metric_agg_portals PARTITION (denver_date)
SELECT
  CASE
  WHEN  visit__account__details__mso IN ('CHARTER','CHTR','"CHTR"')       THEN 'L-CHTR'
  WHEN  visit__account__details__mso IN ('TWC','"TWC"', 'NONECAPTURED')   THEN 'L-TWC'
  WHEN  visit__account__details__mso IN ('BH','BHN','"BHN"')              THEN 'L-BHN'
  WHEN (visit__account__details__mso IN ('','unknown','"NONE"', 'NONE')
        OR visit__account__details__mso IS NULL )                         THEN 'MSO-MISSING'
  ELSE visit__account__details__mso
  END AS mso,
  visit__application_details__application_type AS application_type,
  LOWER(visit__device__device_type) AS device_type,
  visit__connection__connection_type AS connection_type,
  visit__connection__network_status AS network_status,
  state__content__stream__playback_type AS playback_type,
  "cust_type" as cust_type,
  "stream_subtype" AS stream_subtype,
  IF(visit__application_details__application_type = 'Android', IF(visit__device__operating_system RLIKE '^(Android 4.0)' OR visit__device__operating_system RLIKE '^(Android 4.1)' OR visit__device__operating_system RLIKE '^(Android 4.2)' OR visit__device__operating_system RLIKE '^(Android 4.3)', 'Android 4.1 - 4.3', 'Android 4.4+'), NULL) AS android_type,
  CASE
    WHEN visit__application_details__application_type IN('iOS','Android') THEN 'Mobile'
    WHEN visit__application_details__application_type IN('Xbox','SamsungTV') THEN 'Connected Devices'
    ELSE visit__application_details__application_type
  END AS application_group_type,
  state__content__stream__playback_id AS stream_id,
  visit__visit_id AS visit_id,
  visit__device__enc_uuid AS device_id,
  visit__account__enc_account_number AS acct_id,
  NULL AS unique_stream_id,
  NULL AS unique_visit_id,
  NULL AS unique_device_id,
  NULL AS unique_account_number,
  visit__variant_uuids AS variant_uuids,
  state__content__details__episode_number AS episode_number,
  state__content__details__season_number AS season_number,
  state__content__details__genres AS genres,
  state__content__programmer__linear__channel_name AS linear_channel_name,
  visit__device__browser__name AS browser_name,
  visit__device__browser__user_agent AS browser_user_agent,
  visit__device__browser__version AS browser_version,
  state__content__identifiers__tms_program_id AS tms_program_id,

  MIN(received__timestamp) AS min_received_timestamp,
  MAX(received__timestamp) AS max_received_timestamp,

  SUM(IF(message__name = 'loginStop' AND operation__operation_type = 'manualAuth' AND operation__success = TRUE
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS manual_login_success,
  SUM(IF(message__name = 'loginStart' AND operation__operation_type = 'manualAuth'
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS manual_login_attempt,
  SUM(IF(message__name = 'loginStop' AND operation__operation_type = 'resumeAuth' AND operation__success = TRUE
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS resume_login_success,
  SUM(IF(message__name = 'loginStart' AND operation__operation_type = 'resumeAuth'
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS resume_login_attempt,
  SUM(IF(message__name = 'loginStop' AND operation__operation_type = 'verifierAuth' AND operation__success = TRUE
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS verifier_login_success,
  SUM(IF(message__name = 'loginStart' AND operation__operation_type = 'verifierAuth'
    AND (visit__application_details__application_type != 'OVP' OR (visit__application_details__application_type = 'OVP' AND visit__application_details__app_version >= '6.1')), 1, 0)) AS verifier_login_attempt,

  COLLECT_LIST(IF(message__name = 'loginStop' AND operation__operation_type = 'manualAuth'
    AND operation__success = TRUE, IF(visit__login__login_duration_ms > 15000, 15000, if(visit__login__login_duration_ms > 0,visit__login__login_duration_ms,0)), NULL)) AS manual_duration_ms_list,
  COLLECT_LIST(IF(message__name = 'loginStop' AND operation__operation_type = 'verifierAuth'
    AND operation__success = TRUE, IF(visit__login__login_duration_ms > 15000, 15000, if(visit__login__login_duration_ms > 0,visit__login__login_duration_ms,0)), NULL)) AS verifier_duration_ms_list,
  NULL AS token_exchange_attempts,
  NULL AS stream_init_failures,
  NULL AS tune_time_ms_sum,
  NULL AS tune_time_count,
  COLLECT_SET(0) AS tune_time_ms_list,
  NULL AS watch_time_ms,
  NULL AS buffering_time_ms,
  NULL AS bitrate_downshifts,
  NULL AS stream_init_starts,
  NULL AS stream_noninit_failures,
  NULL AS bandwidth_consumed_mb,
  NULL AS bitrate_content_elapsed_ms,
  NULL AS api_search_error_count,
  NULL AS keyword_search,
  NULL AS predictive_search,
  NULL AS search_closed,
  NULL AS search_entered,
  NULL AS search_entered_space,
  NULL AS search_entered_total,
  COLLECT_SET(0) AS search_response_time_ms_list,
  NULL AS search_result_selected,
  COLLECT_SET('') AS search_result_type_list,
  NULL AS search_started,
  NULL AS search_text_length,
  NULL AS zero_results,
  NULL AS zero_results_space,
  visit__account__enc_account_billing_division AS billing_division,
  visit__account__enc_account_billing_id AS billing_id,
  visit__location__enc_city AS location_city,
  visit__location__state AS location_state,
  visit__location__enc_zip_code AS location_zipcode,
  visit__application_details__app_version AS app_version,
  COLLECT_SET(0) AS complete_buffering_time_ms_list,
  COLLECT_SET(0) AS complete_manual_duration_ms_list,
  COLLECT_SET(0) AS complete_tune_time_ms_list,
  COLLECT_SET(0) AS complete_verifier_duration_ms_list,
  COLLECT_SET(0) AS complete_watch_time_ms,
  NULL AS nonactive_account_number,
  NULL AS nonactive_device_id,
  NULL AS nonactive_stream_id,
  NULL AS nonactive_visit_id,
  visit__device__model as device_model,
  NULL AS critical_api_attempts,
  NULL AS critical_api_fails,
  NULL AS application_errors,
  NULL AS critical_api_success,
  NULL AS other_api_response_count,
  'stream_choice' AS stream_choice,
  state__content__content_class AS content_class,
  visit__account__enc_account_billing_division_id AS billing_division_id,
  CONCAT(
  visit__account__enc_account_billing_division_id ,
  visit__account__enc_account_billing_division ,
  visit__account__enc_account_billing_id
  ) AS billing_combo_key,
  IF(LOWER(visit__application_details__application_name) IN('oneapp','specu','bulkmdu'), 'IPTV', LOWER(visit__application_details__application_name)) AS app_vertical,
  LOWER(visit__application_details__application_name) AS application_name,
  visit__login__logged_in AS logged_in,
  visit__device__operating_system AS operating_system,
  visit__device__device_form_factor AS form_factor,
  visit__account__details__billing_status  AS billing_status,
  visit__account__details__auto_pay_status AS autopay_status,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'agreeAndContinue'  AND state__view__current_page__page_name = 'ccpaChoiceForm' , 1, 0)) AS ccpa_agree_and_continue_clicks,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'ccpaChoiceForm' , 1, 0)) AS ccpa_choice_form_direct_pageviews,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'ccpaSuccess' , 1, 0)) AS ccpa_flow_complete_successes_pageviews,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPIT-1002' , 1, 0)) AS ccpa_it_request_ticket_submission_server_4xx_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPIT-1001' , 1, 0)) AS ccpa_it_request_ticket_submission_server_5xx_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPIT-1000' , 1, 0)) AS ccpa_it_request_ticket_submission_user_failed_verification_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'ccpaKbaVerificationQuestion' , 1, 0)) AS ccpa_kba_identity_question_pageviews,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'continue'  AND message__event_case_id = 'privacyMicrosite_selectAction_kbaIntro_continue' , 1, 0)) AS ccpa_kba_speedbump_warning_continue_clicks,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'ccpaKbaIntro' , 1, 0)) AS ccpa_kba_speedbump_warning_pageviews,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND ((message__name = 'pageView' AND state__view__current_page__page_name = 'ccpaSuccess') OR (message__name = 'error' AND application__error__error_type = 'ccpaVerification' AND application__error__error_code = 'CPIT-1000')) , 1, 0)) AS ccpa_kba_successfully_authenticated_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPKB-1002' , 1, 0)) AS ccpa_kba_user_failed_verification_24hrcooldown_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPKB-1000' , 1, 0)) AS ccpa_kba_user_failed_verification_generic_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPKB-1001' , 1, 0)) AS ccpa_kba_user_failed_verification_timeout_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPLN-1003' , 1, 0)) AS ccpa_lexisnexis_server_error_4xx_after_kba_verification_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPLN-1001' , 1, 0)) AS ccpa_lexisnexis_server_error_5xx_after_kba_verification_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPLN-1004' , 1, 0)) AS ccpa_lexisnexis_user_not_found_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'error'  AND application__error__error_type = 'ccpaVerification'  AND application__error__error_code = 'CPGE-1000' , 1, 0)) AS ccpa_privacy_api_generic_api_failure_error_counts,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'continue'  AND state__view__current_page__page_name = 'ccpaResIdForm' , 1, 0)) AS ccpa_resident_id_continue_clicks,
        SUM(IF(visit__application_details__application_name ='PrivacyMicrosite' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'ccpaResIdForm' , 1, 0)) AS ccpa_resident_id_form_pageviews,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Voice' , 1, 0)) AS portals_access_voice_platform_via_tile,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section = 'support'  AND (state__view__current_page__page_url RLIKE '/support/manage-account*' OR state__view__current_page__page_url RLIKE '/support/my-account*') , 1, 0)) AS portals_account_billing_support_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'addPerson' , 1, 0)) AS portals_account_settings_add_person_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelContactInfo' , 1, 0)) AS portals_account_settings_cancel_manage_contact_info,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPerson' , 1, 0)) AS portals_account_settings_click_add_person,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('cancelRoleChange', 'addPersonCancel') , 1, 0)) AS portals_account_settings_click_cancel_add_or_change_role,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPersonCancel' , 1, 0)) AS portals_account_settings_click_cancel_add_person,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'userDetailsChangeRole' , 1, 0)) AS portals_account_settings_click_change_role,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'yourInfoChangeRole'  AND state__view__previous_page__page_name = 'managePeople' , 1, 0)) AS portals_account_settings_click_change_role_from_manage_people,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'userDetailsRoleChangeSave'  AND state__view__current_page__elements__element_string_value = 'Standard' , 1, 0)) AS portals_account_settings_click_change_to_standard_role,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deleteUser' , 1, 0)) AS portals_account_settings_click_delete_user,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'wiFiProfile' , 1, 0)) AS portals_account_settings_click_install_wifi_profile,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'manageContactInfo' , 1, 0)) AS portals_account_settings_click_manage_contact_info,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'managePeople' , 1, 0)) AS portals_account_settings_click_manage_people,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'verifyIdentityResendCode' , 1, 0)) AS portals_account_settings_click_resend_code,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'userDetailsResendInvite' , 1, 0)) AS portals_account_settings_click_resend_invite,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPersonSave'  AND state__view__current_page__elements__element_string_value = 'Admin' , 1, 0)) AS portals_account_settings_click_save_add_admin,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPersonSave' , 1, 0)) AS portals_account_settings_click_save_add_person,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPersonSave'  AND state__view__current_page__elements__element_string_value = 'Standard' , 1, 0)) AS portals_account_settings_click_save_add_standard,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'saveContactInfo' , 1, 0)) AS portals_account_settings_click_save_contact_info,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'sendVerificationCode'  AND state__view__current_page__elements__element_string_value = 'Phone Call' , 1, 0)) AS portals_account_settings_click_send_verification_phone_call,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'sendVerificationCode'  AND state__view__current_page__elements__element_string_value = 'Text Message' , 1, 0)) AS portals_account_settings_click_send_verification_via_text,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'verifyYourInfo'  AND state__view__current_page__elements__element_string_value = 'Primary Email Address' , 1, 0)) AS portals_account_settings_click_verify_email,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'verifyYourInfo'  AND state__view__current_page__elements__element_string_value = 'Primary Phone Number' , 1, 0)) AS portals_account_settings_click_verify_phone_number,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'error'  AND application__error__error_type = 'accountInfoVerification'  AND application__error__error_message = 'This verification code has expired. Please request a new one' , 1, 0)) AS portals_account_settings_error_expired_code,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'error'  AND application__error__error_type = 'accountInfoVerification'  AND application__error__error_message = 'Please enter a valid verification code' , 1, 0)) AS portals_account_settings_error_incorrect_code,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND application__api__api_name = 'accountV1Accounts'  AND application__api__service_result = 'failure' , 1, 0)) AS portals_account_settings_home_page_api_error,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__app_section = 'account'  AND state__view__current_page__page_name = 'accountHome' , 1, 0)) AS portals_account_settings_home_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'manageContactInfo' , 1, 0)) AS portals_account_settings_manage_contact_info_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'managePeople' , 1, 0)) AS portals_account_settings_manage_people_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'verifyIdentity' , 1, 0)) AS portals_account_settings_verify_identity_click,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'newPrimaryRole' , 1, 0)) AS portals_account_settings_your_info_change_primary_user_role,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'yourInfoChangeRole' , 1, 0)) AS portals_account_settings_your_info_change_role,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelRoleChange' , 1, 0)) AS portals_account_settings_your_info_role_change_cancel,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'userDetailsRoleChangeSave' , 1, 0)) AS portals_account_settings_your_info_role_change_save,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'yourInfo' , 1, 0)) AS portals_account_settings_your_info_tab_views,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetAddService' , 1, 0)) AS portals_add_internet_banner_click,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'tvAddService' , 1, 0)) AS portals_add_tv_banner_click,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'voiceAddService' , 1, 0)) AS portals_add_voice_banner_click,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name IN ('resetrouterfail-modal', 'resetmodemfail-modal')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure'), 1, 0)) AS portals_all_equipment_reset_flow_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) IN ('reset-equipment-tv-failure', 'reset-equipment-voice-failure', 'reset-equipment-internet-failure') , 1, 0)) AS portals_all_equipment_reset_flow_failures_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'troubleshoot') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'openEquipmentReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'openEquipmentReset'), 1, 0)) AS portals_all_equipment_reset_flow_starts,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('equipment.internet.troubleshoot', 'equipment.tv.troubleshoot', 'equipment.voice.troubleshoot') , 1, 0)) AS portals_all_equipment_reset_flow_starts_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name = 'resetsuccess-modal') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name IN( 'internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot') AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success'), 1, 0)) AS portals_all_equipment_reset_flow_successes,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) IN ('reset-equipment-tv-success', 'reset-equipment-voice-success', 'reset-equipment-internet-success') , 1, 0)) AS portals_all_equipment_reset_flow_successes_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name = 'userHome') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name = 'home-authenticated') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'pageView' AND state__view__current_page__page_name = 'homeAuth'), 1, 0)) AS portals_auth_homepage_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND (state__view__current_page__elements__standardized_name IN ('autoPayToggleEnable', 'autoPayEnroll') OR (state__view__current_page__elements__standardized_name IN ('otpAutoPayEnroll') AND state__view__current_page__page_name = 'reviewCompletePayment')) , 1, 0)) AS portals_autopay_enroll_radio_toggle,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'closingX' AND state__view__modal__name = 'paperlessBillingOffConfirmation') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'closingX' AND state__view__modal__name = 'paperlessBillingOffConfirmation'), 1, 0)) AS portals_bill_delivery_pref_exit,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'keepPaperlessBilling') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'keepPaperlessBilling'), 1, 0)) AS portals_bill_delivery_pref_keep_paperless,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'paperlessManage' , 1, 0)) AS portals_bill_delivery_pref_manage_paperless,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'getApaperBill') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'getApaperBill'), 1, 0)) AS portals_bill_delivery_pref_paper,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'pageView'  AND state__view__current_page__page_name IN('paperlessTurnOffFailure','paperlessBillingOffFailure') , 1, 0)) AS portals_bill_delivery_pref_paper_failure,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'pageView'  AND state__view__current_page__page_name IN('paperlessTurnOffSuccess', 'paperlessBillingOffSuccess') , 1, 0)) AS portals_bill_delivery_pref_paper_success,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'paperlessEnroll'  AND state__view__current_page__page_name = 'userHome' , 1, 0)) AS portals_bill_delivery_pref_paperless_enroll_from_homepage,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'pageView'  AND state__view__current_page__page_name IN('paperlessTurnOnFailure', 'paperlessBillingOnFailure') , 1, 0)) AS portals_bill_delivery_pref_paperless_failure,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paperlessEnroll' AND state__view__current_page__page_name = 'paperlessBilling') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'billDeliveryToggle' AND operation__toggle_state = TRUE) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'billDeliveryToggle' AND operation__toggle_state = TRUE), 1, 0)) AS portals_bill_delivery_pref_paperless_submit,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'paperlessEnroll'  AND state__view__current_page__page_name = 'paperlessBilling'  AND state__view__previous_page__page_name = 'billingHome' , 1, 0)) AS portals_bill_delivery_pref_paperless_submit_from_billinghome,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'paperlessEnroll'  AND state__view__current_page__page_name = 'paperlessBilling'  AND state__view__previous_page__page_name = 'userHome' , 1, 0)) AS portals_bill_delivery_pref_paperless_submit_from_homepage,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'paperlessUnenroll'  AND state__view__current_page__page_name = 'paperlessBilling' , 1, 0)) AS portals_bill_delivery_pref_paperless_submit_from_paperless,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'pageView'  AND state__view__current_page__page_name IN('paperlessTurnOnSuccess', 'paperlessBillingOnSuccess') , 1, 0)) AS portals_bill_delivery_pref_paperless_success,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'home-authenticated'  AND state__view__current_page__elements__standardized_name = 'localNav-billing' , 1, 0)) AS portals_bill_pay_clicks_from_local_nav,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing') OR (visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing'), 1, 0)) AS portals_billing_feature_interaction,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'modalView'  AND state__view__modal__name = 'newFingerprintLoginModal' , 1, 0)) AS portals_biometrics_fingerprint_enroll,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'fingerprintLoginToggle'  AND operation__toggle_state = FALSE , 1, 0)) AS portals_biometrics_fingerprint_toggle_off,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'fingerprintLoginToggle'  AND operation__toggle_state = TRUE , 1, 0)) AS portals_biometrics_fingerprint_toggle_on,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'loginStart'  AND operation__operation_type = 'biometricAuth' , 1, 0)) AS portals_biometrics_login_attempts,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'loginStop'  AND operation__operation_type = 'biometricAuth'  AND operation__success = FALSE , 1, 0)) AS portals_biometrics_login_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum'  AND message__name = 'loginStop'  AND operation__operation_type = 'biometricAuth'  AND operation__success = TRUE , 1, 0)) AS portals_biometrics_login_successes,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('callUsButton', 'contactUs') , 1, 0)) AS portals_call_support,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelDeviceNickname' , 1, 0)) AS portals_cancel_edit_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelEditWifi' , 1, 0)) AS portals_cancel_edit_wifi_network,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelWifiChange' , 1, 0)) AS portals_cancel_edit_wifi_network_changes,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDeviceCancel' , 1, 0)) AS portals_cancel_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelRemoveDevice' , 1, 0)) AS portals_cancel_remove_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'onboardingCancel'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 3' , 1, 0)) AS portals_cancel_tutorial_account_page_four,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'onboardingCancel'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 2' , 1, 0)) AS portals_cancel_tutorial_equip_page_three,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'onboardingCancel'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 1' , 1, 0)) AS portals_cancel_tutorial_otp_page_two,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'onboardingCancel'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 0' , 1, 0)) AS portals_cancel_tutorial_start_page_one,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDeviceCancel' , 1, 0)) AS portals_cancel_unpause_device,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name = 'cancelappointment-modal') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'apiCall' AND application__api__api_name = 'serviceapptedgeV1AppointmentsCancel') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'pageView' AND state__view__current_page__page_name = 'appointmentCancellationSuccess'), 1, 0)) AS portals_cancelled_service_appointments,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hostnameTooltipClose' , 1, 0)) AS portals_close_hostname_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'macAddressTooltipClose' , 1, 0)) AS portals_close_mac_address_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetNetworkTooltipClose' , 1, 0)) AS portals_close_network_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'confirmWifiChange' , 1, 0)) AS portals_confirm_edit_wifi_network_changes,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'confirmRemoveDevice' , 1, 0)) AS portals_confirm_remove_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'contactSpecialist' , 1, 0)) AS portals_contact_our_moving_specialist,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name = 'contactUs') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'Contact Us - SMB'), 1, 0)) AS portals_contact_us_page_views,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCancel' AND state__view__modal__name = 'verifyAccountModal') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCancel' AND state__view__modal__name = 'verifyAccountModal'), 1, 0)) AS portals_cpni_abandon_roadblock_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCancel' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCancel' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')), 1, 0)) AS portals_cpni_abandon_roadblock_page,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountFailureBanner' AND state__view__modal__name = 'verifyAccountModal') OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountFailureBanner' AND state__view__modal__name = 'verifyAccountModal'), 1, 0)) AS portals_cpni_complete_and_fail_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountFailureBanner' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountFailureBanner' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')), 1, 0)) AS portals_cpni_complete_and_fail_page,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCont' AND state__view__modal__name = 'verifyAccountModal') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCont' AND state__view__modal__name = 'verifyAccountModal'), 1, 0)) AS portals_cpni_complete_and_submit_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCont' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verifyAccountCont' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')), 1, 0)) AS portals_cpni_complete_and_submit_page,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND state__view__modal__name = 'verifyAccountModal') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND state__view__modal__name = 'verifyAccountModal'), 1, 0)) AS portals_cpni_verify_account_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')), 1, 0)) AS portals_cpni_verify_account_page,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountSuccessBanner' AND state__view__modal__name = 'verifyAccountModal') OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountSuccessBanner' AND state__view__modal__name = 'verifyAccountModal'), 1, 0)) AS portals_cpni_verify_account_success_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountSuccessBanner' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'verifyAccountSuccessBanner' AND state__view__current_page__page_name IN( 'verifyAccountPage', 'verifyYourAccount')), 1, 0)) AS portals_cpni_verify_account_success_page,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND application__api__path = '/care/api/v1/user/register'  AND application__api__response_code RLIKE '2.*'  AND application__api__response_text <> 'S000' , 1, 0)) AS portals_create_username_flow_failure,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'login'  AND state__view__current_page__elements__standardized_name = 'createUsername' , 1, 0)) AS portals_create_username_flow_start,
        SUM(IF((visit__application_details__application_name = 'IDManagement' AND message__name = 'selectAction' AND state__view__current_page__page_name = 'username' AND state__view__current_page__app_section = 'recover' AND state__view__current_page__elements__standardized_name = 'userNameSignIn') OR (visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall' AND application__api__path = '/care/api/v1/user/register' AND application__api__response_code RLIKE '2.*' AND application__api__response_text = 'S000'), 1, 0)) AS portals_create_username_flow_success,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCancel' , 1, 0)) AS portals_csat_campaign_dismiss,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'experienceRating' , 1, 0)) AS portals_csat_campaign_interaction,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'feedbackFormCancel'  AND state__view__previous_page__page_name = 'experienceRating' , 1, 0)) AS portals_csat_submit_feedback_cancel_written_feedback,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value = 1 , 1, 0)) AS portals_csat_submit_rating_1_very_dissatisfied,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value = 2 , 1, 0)) AS portals_csat_submit_rating_2_dissatisfied,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value = 3 , 1, 0)) AS portals_csat_submit_rating_3_neutral,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value = 4 , 1, 0)) AS portals_csat_submit_rating_4_satisfied,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value = 5 , 1, 0)) AS portals_csat_submit_rating_5_very_satisfied,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'experienceRatingCont'  AND state__view__current_page__elements__element_int_value IN('1', '2', '3', '4', '5') , 1, 0)) AS portals_csat_submit_rating_all,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'userFeedback'  AND state__view__previous_page__page_name = 'experienceRating'  AND operation__user_entry__enc_feedback IS NOT NULL , 1, 0)) AS portals_csat_submit_written_feedback,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'installWiFiProfile' , 1, 0)) AS portals_download_wifi_profile_button_click,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'installWiFiProfile'  AND visit__application_details__application_type = 'Android' , 1, 0)) AS portals_download_wifi_profile_button_click_android,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'installWiFiProfile'  AND visit__application_details__application_type = 'iOS' , 1, 0)) AS portals_download_wifi_profile_button_click_ios,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_Name = 'spectrumWiFiProfileResponse' , 1, 0)) AS portals_download_wifi_profile_success,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_Name = 'spectrumWiFiProfileResponse'  AND visit__application_details__application_type = 'Android' , 1, 0)) AS portals_download_wifi_profile_success_android,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_Name = 'spectrumWiFiProfileResponse'  AND visit__application_details__application_type = 'iOS' , 1, 0)) AS portals_download_wifi_profile_success_ios,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section IN ('tv','voice','internet')  AND state__view__current_page__page_name = 'my-internet-services' , 1, 0)) AS portals_ed_my_internet_services,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section IN ('tv','voice','internet')  AND state__view__current_page__page_name IN ('my-tv-services') , 1, 0)) AS portals_ed_my_tv_services,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section IN ('tv','voice','internet')  AND state__view__current_page__page_name IN ('my-internet-services.contact-us','my-voice-services') , 1, 0)) AS portals_ed_my_voice_services,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Progress-Bar-Modal-Internet' , 1, 0)) AS portals_ed_progress_bar_modal_internet_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Progress-Bar-Modal-TV' , 1, 0)) AS portals_ed_progress_bar_modal_tv_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Progress-Bar-Modal-Voice' , 1, 0)) AS portals_ed_progress_bar_modal_voice_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'ssidManageWifiNetworkTile' , 1, 0)) AS portals_edit_ssid_click_manage_wifi_network_tile,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'applicationActivity'  AND operation__operation_type = 'ssidManageWifiNetworkTile' , 1, 0)) AS portals_edit_ssid_home_screen_prompt,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelEditWifi') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageNetworkCancel') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageNetworkCancel'), 1, 0)) AS portals_equipment_cancel_edit_ssid_select_action,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'confirmWifiChange') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageNetworkSave') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageNetworkSave'), 1, 0)) AS portals_equipment_confirm_edit_ssid_select_action,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'equipDetails' , 1, 0)) AS portals_equipment_detail_views,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('editWifiNetwork', 'ssidManageWifiNetworkTile', 'ssidEditWifiNetworkModal')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND message__event_case_id = 'SPECTRUM_selectAction_equipment_manageNetwork') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND message__event_case_id = 'SPECTRUM_selectAction_equipment_manageNetwork'), 1, 0)) AS portals_equipment_edit_ssid_select_action,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__app_section IN('equipment', 'internet', 'tv','voice')) OR (visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction' AND state__view__current_page__app_section IN('equipment', 'internet', 'tv','voice')) OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__app_section IN('equipment', 'internet', 'tv','voice')), 1, 0)) AS portals_equipment_feature_interaction,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name IN ('internetTab','voiceTab','tvTab') , 1, 0)) AS portals_equipment_list_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'internetTab'  AND state__view__previous_page__app_section = 'equipment' , 1, 0)) AS portals_equipment_page_views,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resetEquip' AND state__view__current_page__page_name IN('internetTab', 'tvTab', 'voiceTab')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name IN('internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name IN('internetTroubleshoot', 'tvTroubleshoot', 'voiceTroubleshoot')), 1, 0)) AS portals_equipment_reset_flow_submit_all,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Reset-Equipment-Internet' , 1, 0)) AS portals_equipment_reset_internet_modal_view_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Reset-Equipment-TV' , 1, 0)) AS portals_equipment_reset_tv_modal_view_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Reset-Equipment-Voice' , 1, 0)) AS portals_equipment_reset_voice_modal_view_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name IN ('Wait-15-Error-Modal-Internet', 'Wait-15-Error-Modal-TV', 'Wait-15-Error-Modal-Voice') , 1, 0)) AS portals_equipment_resets_too_many_resets_modal_all_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Wait-15-Error-Modal-Internet' , 1, 0)) AS portals_equipment_resets_too_many_resets_modal_internet_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Wait-15-Error-Modal-TV' , 1, 0)) AS portals_equipment_resets_too_many_resets_modal_tv_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'Wait-15-Error-Modal-Voice' , 1, 0)) AS portals_equipment_resets_too_many_resets_modal_voice_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.internet.check-email' , 1, 0)) AS portals_equipmentnav_check_email,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('footer-disabilityAssistance', 'footer-getSupport-accessibility') , 1, 0)) AS portals_footer_accessibility,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'footer'  AND state__view__current_page__elements__ui_name = 'About Us' , 1, 0)) AS portals_footer_charter_corporate_about_us,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'footer'  AND state__view__current_page__elements__ui_name = 'Guarantee' , 1, 0)) AS portals_footer_charter_corporate_guarantee,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-contact-contactUs') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Contact Us'), 1, 0)) AS portals_footer_contactus_contact_us,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-contact-findStore') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Store Locations'), 1, 0)) AS portals_footer_contactus_find_spectrum_store,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-contact-weatherOutage') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Weather Outage'), 1, 0)) AS portals_footer_contactus_weather_outage,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-getSupport-accountSupport' , 1, 0)) AS portals_footer_getsupport_acct_support,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-getSupport-internet' , 1, 0)) AS portals_footer_getsupport_internet,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-getSupport-supportHome' , 1, 0)) AS portals_footer_getsupport_support_home,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-getSupport-tv' , 1, 0)) AS portals_footer_getsupport_tv,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-getSupport-voice' , 1, 0)) AS portals_footer_getsupport_voice,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'global footer' AND state__view__current_page__elements__ui_name = 'Voice') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Voice'), 1, 0)) AS portals_footer_globalnav_voice,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-legal-californiaPrivacyRights') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'California Privacy Policy'), 1, 0)) AS portals_footer_legal_ca_privacy_rights,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND (state__view__current_page__elements__standardized_name = 'footer-legal-goToAssist' or state__view__current_page__elements__ui_name = 'Go To Assist') , 1, 0)) AS portals_footer_legal_go_to_assist,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-legal-policies') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Policies'), 1, 0)) AS portals_footer_legal_policies,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-legal-privacyRights') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Your Privacy Rights'), 1, 0)) AS portals_footer_legal_privacy_rights,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-accountSummary') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Account Summary'), 1, 0)) AS portals_footer_manageaccount_account_summary,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-billing') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Billing'), 1, 0)) AS portals_footer_manageaccount_billing,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-internet' , 1, 0)) AS portals_footer_manageaccount_internet,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'footer'  AND state__view__current_page__elements__ui_name = 'Manage Users' , 1, 0)) AS portals_footer_manageaccount_manage_users,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-mobile' , 1, 0)) AS portals_footer_manageaccount_mobile,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-settings') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Profile & Settings'), 1, 0)) AS portals_footer_manageaccount_settings,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-tv' , 1, 0)) AS portals_footer_manageaccount_tv,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-manageAccount-voice') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Voice'), 1, 0)) AS portals_footer_manageaccount_voice,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-social-facebook') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Facebook'), 1, 0)) AS portals_footer_social_facebook,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-social-instagram' , 1, 0)) AS portals_footer_social_instagram,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'footer'  AND state__view__current_page__elements__ui_name = 'LinkedIn' , 1, 0)) AS portals_footer_social_linkedin,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-social-twitter') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'Twitter'), 1, 0)) AS portals_footer_social_twitter,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'footer-social-youtube') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'footer' AND state__view__current_page__elements__ui_name = 'YouTube'), 1, 0)) AS portals_footer_social_youtube,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-watchTV-dvr' , 1, 0)) AS portals_footer_watchtv_dvr,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-watchTV-guide' , 1, 0)) AS portals_footer_watchtv_guide,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-watchTV-liveTV' , 1, 0)) AS portals_footer_watchtv_live_tv,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-watchTV-myLibrary' , 1, 0)) AS portals_footer_watchtv_my_library,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'footer-watchTV-onDemand' , 1, 0)) AS portals_footer_watchtv_on_demand,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND application__api__path = '/care/api/v1/forgotpwd3'  AND application__api__response_code RLIKE '2.*'  AND application__api__response_text <> 'S000' , 1, 0)) AS portals_forgot_password_flow_failure,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'login'  AND state__view__current_page__elements__standardized_name = 'forgotPassword' , 1, 0)) AS portals_forgot_password_flow_start,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name = 'newpasswordresponse-modal' AND state__view__current_page__page_name = 'newPasswordEntry') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'passwordRecoveryComplete'), 1, 0)) AS portals_forgot_password_success,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND application__api__path = '/care/api/v1/forgotusername'  AND application__api__response_code RLIKE '2.*'  AND application__api__response_text <> 'S000' , 1, 0)) AS portals_forgot_username_flow_failure,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__page_name = 'login' AND state__view__current_page__elements__standardized_name = 'forgotUsername') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__page_name = 'recoveryEmailSent'), 1, 0)) AS portals_forgot_username_flow_start,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'loginRecoverySendEmail') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__page_name = 'recoveryEmailSent'), 1, 0)) AS portals_forgot_username_success,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'getMoveInfo' , 1, 0)) AS portals_get_moving_info,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'tourPointNext'  AND message__context = 'onboardingTour' , 1, 0)) AS portals_guided_tour_click_next,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'tourPointPrevious'  AND message__context = 'onboardingTour' , 1, 0)) AS portals_guided_tour_click_previous,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('tourPointClose', 'tourPointDismiss')  AND message__context = 'onboardingTour' , 1, 0)) AS portals_guided_tour_exit,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'tourPointModal' , 1, 0)) AS portals_guided_tour_initiated_modal_view,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'autoOptInContinue' , 1, 0)) AS portals_guided_tour_onboard_continue,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'autoOptIn' , 1, 0)) AS portals_guided_tour_onboard_welcome,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'tourPointModal'  AND message__feature__feature_step_name = '1 of 3' , 1, 0)) AS portals_guided_tour_one_of_three,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'showMeLater'  AND message__context = 'onboardingTour' , 1, 0)) AS portals_guided_tour_show_me_later,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'tourPointModal'  AND message__feature__feature_step_name = '3 of 3' , 1, 0)) AS portals_guided_tour_three_of_three,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'tourPointModal'  AND message__feature__feature_step_name = '2 of 3' , 1, 0)) AS portals_guided_tour_two_of_three,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND state__view__modal__name = 'tourPointModal'  AND message__feature__feature_step_name = '0 of 3' , 1, 0)) AS portals_guided_tour_zero_of_three,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-closeSideNav' , 1, 0)) AS portals_hamburger_closesidenav,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-createUsername' , 1, 0)) AS portals_hamburger_create_username,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-email' , 1, 0)) AS portals_hamburger_email,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-getSupport' , 1, 0)) AS portals_hamburger_get_support,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-manageAccount' , 1, 0)) AS portals_hamburger_manage_account,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-signin' , 1, 0)) AS portals_hamburger_signin,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-signout' , 1, 0)) AS portals_hamburger_signout,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-voice' , 1, 0)) AS portals_hamburger_voice,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hamburger-watchTV' , 1, 0)) AS portals_hamburger_watch_tv,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND state__view__current_page__page_name = 'accountHome'  AND state__view__current_page__elements__standardized_name = 'wiFiProfile' , 1, 0)) AS portals_install_wifi_profile_start,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND state__view__current_page__page_name = 'spectrumWiFiProfileResponse' , 1, 0)) AS portals_install_wifi_profile_success,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.internet.troubleshoot.reset-equip.cancel' , 1, 0)) AS portals_internet_equipment_reset_flow_cancel_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.internet.troubleshoot.reset-equip.reset-failure-modal-continue' , 1, 0)) AS portals_internet_equipment_reset_flow_failure_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name IN ('resetrouterfail-modal', 'resetmodemfail-modal') AND state__view__previous_page__page_name IN ('internetTab', 'equipmentHome') AND state__view__current_page__page_name <> 'voiceTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure'), 1, 0)) AS portals_internet_equipment_reset_flow_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) = 'reset-equipment-internet-failure' , 1, 0)) AS portals_internet_equipment_reset_flow_failures_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'support-category.internet.reset-modem.issue-resolved' , 1, 0)) AS portals_internet_equipment_reset_flow_manual_success_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset'), 1, 0)) AS portals_internet_equipment_reset_flow_modal_wait,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__page_name = 'internetTab' AND state__view__current_page__elements__standardized_name = 'troubleshoot') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset'), 1, 0)) AS portals_internet_equipment_reset_flow_starts,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.internet.troubleshoot' , 1, 0)) AS portals_internet_equipment_reset_flow_starts_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resetEquip' AND state__view__current_page__page_name = 'internetTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'internetTroubleshoot') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'internetTroubleshoot'), 1, 0)) AS portals_internet_equipment_reset_flow_submit,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.internet.troubleshoot.reset-equip.start' , 1, 0)) AS portals_internet_equipment_reset_flow_submit_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.internet.troubleshoot.reset-equip.success-modal-continue' , 1, 0)) AS portals_internet_equipment_reset_flow_success_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name IN ('internetresetsuccess-modal', 'resetsuccess-modal' ) AND state__view__previous_page__page_name IN ('internetTab', 'equipmentHome') AND state__view__current_page__page_name <> 'voiceTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'internetTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success'), 1, 0)) AS portals_internet_equipment_reset_flow_successes,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) = 'reset-equipment-internet-success' , 1, 0)) AS portals_internet_equipment_reset_flow_successes_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__current_page__page_name = 'internetTab'  AND state__view__modal__name = 'resetmodemfail-modal' , 1, 0)) AS portals_internet_modem_reset_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND state__view__current_page__page_name = 'resettingEquip'  AND application__api__api_name = 'equipmentv1modemreset'  AND state__view__previous_page__page_name IN ('equipmentHome','internetTab') , 1, 0)) AS portals_internet_modem_reset_successes,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'internetTab'  AND state__view__current_page__elements__standardized_name = 'troubleshoot' , 1, 0)) AS portals_internet_modem_router_reset_starts,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'resetrouterfail-modal'  AND state__view__previous_page__page_name IN ('internetTab','equipmentHome')  AND state__view__current_page__page_name <> 'voiceTab' , 1, 0)) AS portals_internet_router_reset_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND state__view__current_page__page_name = 'resettingEquip'  AND application__api__api_name = 'equipmentv1routerreset'  AND state__view__previous_page__page_name IN ('equipmentHome','internetTab')  AND ( application__api__response_code RLIKE '2.*' OR application__api__response_code = 429) , 1, 0)) AS portals_internet_router_reset_successes,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'troubleshoot'  AND state__view__current_page__page_name = 'internetTab' , 1, 0)) AS portals_internet_services_connection_issue_troubleshoot,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section = 'support'  AND state__view__current_page__page_url RLIKE '/support/internet*' , 1, 0)) AS portals_internet_support_views,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('ask-spectrum','askSpectrumNextIT','askSpectrumASAPP', 'launchChat') , 1, 0)) AS portals_iva_opens,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'localNav-accountSummary') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'navTabSelect' AND state__view__current_page__elements__ui_name = 'Account Summary'), 1, 0)) AS portals_localnav_acct_summary,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'localNav-billing') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'navTabSelect' AND state__view__current_page__elements__ui_name = 'Billing'), 1, 0)) AS portals_localnav_billing,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'localNav-internet' , 1, 0)) AS portals_localnav_internet,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'localNav-settings') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'navTabSelect' AND state__view__current_page__elements__ui_name IN ('Profile and Settings','Profile & Settings')), 1, 0)) AS portals_localnav_settings,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'localNav-tv' , 1, 0)) AS portals_localnav_tv,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'navTabSelect'  AND state__view__current_page__elements__ui_name = 'Users' , 1, 0)) AS portals_localnav_users,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'localNav-voice' AND state__view__current_page__elements__ui_name = 'Voice') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('Voice', 'Voice & Services') AND state__view__current_page__elements__ui_name = 'Voice'), 1, 0)) AS portals_localnav_voice,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'loginStart') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'loginStart') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'loginStart'), 1, 0)) AS portals_login_attempts,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'loginStop' AND operation__success = FALSE) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'loginStop' AND operation__success = FALSE) OR (visit__application_details__application_name = 'SMB' AND message__name = 'loginStop' AND operation__success = FALSE), 1, 0)) AS portals_login_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'logout'  AND operation__operation_type = 'logout' , 1, 0)) AS portals_logout,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'manualReset'  AND state__view__current_page__elements__standardized_name = 'manualResetContinue' , 1, 0)) AS portals_manual_reset_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('support-category.voice.reset-equip.contact-us', 'support-category.internet.reset-equip.contact-us', 'support-category.tv.reset-equip.contact-us') , 1, 0)) AS portals_manual_reset_failures_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'manualReset' , 1, 0)) AS portals_manual_reset_starts,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__page_name IN ('my-voice-services.manually-reset-equipment', 'my-tv-services.manually-reset-equipment', 'my-internet-services.manually-reset-equipment') , 1, 0)) AS portals_manual_reset_starts_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'manualResetResolved' , 1, 0)) AS portals_manual_reset_success,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('support-category.tv.reset-equip.issue-resolved', 'support-category.voice.reset-equip.issue-resolved', 'support-category.internet.reset-modem.issue-resolved') , 1, 0)) AS portals_manual_reset_success_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'feedbackFormSend' , 1, 0)) AS portals_msa_experience_feedback_click_submit_feedback,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'userFeedback'  AND ((operation__user_entry__entry_type = 'feedbackForm') OR (operation__user_entry__entry_type = 'supportFeedbackForm' AND operation__user_entry__str_value = 'Yes')) , 1, 0)) AS portals_msa_experience_feedback_goal_accomplished,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'userFeedback'  AND ((operation__user_entry__entry_type = 'feedbackForm') OR (operation__user_entry__entry_type = 'supportFeedbackForm' AND operation__user_entry__str_value = 'No')) , 1, 0)) AS portals_msa_experience_feedback_goal_not_accomplished,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Cloud Backup' , 1, 0)) AS portals_my_services_cloud_backup,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Desktop Security' , 1, 0)) AS portals_my_services_desktop_security,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Email' , 1, 0)) AS portals_my_services_email,
        SUM(IF(visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Web Hosting' , 1, 0)) AS portals_my_services_web_hosting,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('equipment.internet.go-to-security-suite', 'goToSecuritySuite') , 1, 0)) AS portals_navigation_go_to_security,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'apiCall'  AND application__api__api_name = 'sbNetMemberEdgeV2MembersCreate'  AND application__api__response_code RLIKE '2.*' , 1, 0)) AS portals_new_acct_created_all,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addNewUserConfirm'  AND (state__view__current_page__elements__element_string_value = 'Administrator' OR message__context = 'Administrator') , 1, 0)) AS portals_new_admin_accounts_attempts,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity'  AND operation__operation_type = 'userAddSuccessBanner'  AND message__context = 'Administrator' , 1, 0)) AS portals_new_admin_accounts_created,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'createUsername' , 1, 0)) AS portals_new_ids_created_attempts,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'accountSummary' , 1, 0)) AS portals_new_ids_created_successes,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'outageReportedBanner') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'page-level-alert-link-click' AND operation__operation_type = 'alertClick' AND message__event_case_id = 'SPECNET_selectAction_pageAlert'), 1, 0)) AS portals_one_time_alert_clicked,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'applicationActivity' AND operation__operation_type = 'serviceOutage') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'alertView' AND message__event_case_id = 'SPECNET_pageAlertView'), 1, 0)) AS portals_one_time_page_alert_displayed,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date > operation__billing__payment_due_date) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date > operation__billing__payment_due_date), 1, 0)) AS portals_one_time_payment_after_posted_due_date,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentAmount' AND state__view__current_page__page_section__name = 'paymentAmount' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentAmount') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentAmount' AND state__view__current_page__page_section__name = 'paymentAmount' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentAmount'), 1, 0)) AS portals_one_time_payment_amount,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date < operation__billing__payment_due_date) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date < operation__billing__payment_due_date), 1, 0)) AS portals_one_time_payment_before_posted_due_date,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name = 'paymentMethodContinue'  AND operation__billing__payment_method = 'checkingAccount') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue'  AND operation__billing__payment_method = 'checkingAccount') OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.checking'))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name = 'paymentMethodContinue'  AND operation__billing__payment_method = 'checkingAccount') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue'  AND operation__billing__payment_method = 'checkingAccount') OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.checking'))), 1, 0)) AS portals_one_time_payment_checking,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'checkingAccount') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'checkingAccount'), 1, 0)) AS portals_one_time_payment_checking_account,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND (state__view__current_page__elements__standardized_name = 'paymentMethodContinue' AND operation__billing__payment_method = 'creditDebitCard') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue'  AND operation__billing__payment_method = 'creditDebitCard')  OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.credit')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND (state__view__current_page__elements__standardized_name = 'paymentMethodContinue'  AND operation__billing__payment_method = 'creditDebitCard') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue'  AND operation__billing__payment_method = 'creditDebitCard')  OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.credit')), 1, 0)) AS portals_one_time_payment_credit,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'creditDebitCard') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'creditDebitCard'), 1, 0)) AS portals_one_time_payment_credit_debit_card,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentDate' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentDate') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentDate' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentDate'), 1, 0)) AS portals_one_time_payment_date,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'otherDateContinue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_otp_paymentDateOther_continue') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'otherDateContinue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_otp_paymentDateOther_continue'), 1, 0)) AS portals_one_time_payment_date_other,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentDatePastDue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentDatePastDue') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentDatePastDue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_payBillOnetimePaymentDatePastDue'), 1, 0)) AS portals_one_time_payment_date_past_due,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'todayContinue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_otp_paymentDateToday_continue') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'todayContinue' AND state__view__current_page__page_section__name = 'paymentDate' AND message__event_case_id = 'SPECNET_selectAction_billing_otp_paymentDateToday_continue'), 1, 0)) AS portals_one_time_payment_date_today,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__total_amount_due) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__total_amount_due), 1, 0)) AS portals_one_time_payment_equals_amount_due,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__current_balance_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__current_balance_amount), 1, 0)) AS portals_one_time_payment_equals_current_balance,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__past_due_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd = state__view__current_page__past_due_amount), 1, 0)) AS portals_one_time_payment_equals_past_due_amount,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name IN ('paymentFailure', 'paymentWithAutoPayFailure', 'payUnsuccess', 'payUnsuccessAutoPay')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__feature__feature_step_changed = TRUE AND operation__success = FALSE AND ((message__feature__feature_name = 'oneTimePayment' AND message__feature__feature_step_name = 'paymentFailure')) OR (message__feature__feature_name = 'oneTimeBillPayFlow' AND message__feature__feature_step_name = 'oneTimePaymentError')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND message__feature__feature_step_changed = TRUE AND operation__success = FALSE AND ((message__feature__feature_name = 'oneTimePayment' AND message__feature__feature_step_name = 'paymentFailure')) OR (message__feature__feature_name = 'oneTimeBillPayFlow' AND message__feature__feature_step_name = 'oneTimePaymentError')), 1, 0)) AS portals_one_time_payment_failures,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__total_amount_due) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__total_amount_due), 1, 0)) AS portals_one_time_payment_less_than_amount_due,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__current_balance_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__current_balance_amount), 1, 0)) AS portals_one_time_payment_less_than_current_balance,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__past_due_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd < state__view__current_page__past_due_amount), 1, 0)) AS portals_one_time_payment_less_than_past_due_amount,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__total_amount_due) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__total_amount_due), 1, 0)) AS portals_one_time_payment_more_than_amount_due,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__current_balance_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__current_balance_amount), 1, 0)) AS portals_one_time_payment_more_than_current_balance,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__past_due_amount) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_amount_usd > state__view__current_page__past_due_amount), 1, 0)) AS portals_one_time_payment_more_than_past_due_amount,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date = operation__billing__payment_due_date) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_date = operation__billing__payment_due_date), 1, 0)) AS portals_one_time_payment_on_posted_due_date,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name = 'paymentMethodContinue' AND operation__billing__payment_method = 'savingsAccount')) OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.savings') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue' AND operation__billing__payment_method = 'savingsAccount')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND ((state__view__current_page__elements__standardized_name = 'paymentMethodContinue' AND operation__billing__payment_method = 'savingsAccount')) OR (state__view__current_page__elements__standardized_name = 'pay-bill.onetime.payment-method.savings') OR (state__view__current_page__elements__standardized_name = 'payMethodContinue' AND operation__billing__payment_method = 'savingsAccount')), 1, 0)) AS portals_one_time_payment_savings,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'savingsAccount') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview')) AND operation__billing__payment_method = 'savingsAccount'), 1, 0)) AS portals_one_time_payment_savings_account,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('payAmountSelect', 'payAmountCurrent', 'payAmountDue', 'payAmountOther') AND state__view__current_page__page_name IN ('makePayment', 'paymentAmount')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-amount.statement.total', 'pay-bill.onetime.payment-amount.other', 'pay-bill.onetime.payment-amount.total', 'otherAmountContinue', 'statementTotalContinue', 'balanceTotalContinue')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-amount.statement.total', 'pay-bill.onetime.payment-amount.other', 'pay-bill.onetime.payment-amount.total', 'otherAmountContinue', 'statementTotalContinue', 'balanceTotalContinue')), 1, 0)) AS portals_one_time_payment_select_amount,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'paymentDateSelect' AND state__view__current_page__page_name = 'makePayment') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-date.past-due', 'pay-bill.onetime.payment-date.continue.other.date', 'pay-bill.onetime.payment-date.continue.today', 'todayContinue', 'otherDateContinue', 'pastDueDateContinue')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-date.past-due', 'pay-bill.onetime.payment-date.continue.other.date', 'pay-bill.onetime.payment-date.continue.today', 'todayContinue', 'otherDateContinue', 'pastDueDateContinue')), 1, 0)) AS portals_one_time_payment_select_date,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('paymentMethod', 'preselectedPayMethod', 'selectStoredPayMethod', 'newPayMethod') AND state__view__current_page__page_name IN('makePayment', 'paymentMethod')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-method.credit', 'pay-bill.onetime.payment-method.checking', 'pay-bill.onetime.payment-method.savings', 'paymentMethodContinue', 'payMethodContinue')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-method.credit', 'pay-bill.onetime.payment-method.checking', 'pay-bill.onetime.payment-method.savings', 'paymentMethodContinue', 'payMethodContinue')), 1, 0)) AS portals_one_time_payment_select_payment_method,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'makePaymentButton') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__event_case_id = 'SPECNET_selectAction_billPay_otp_billPayStart') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__event_case_id = 'SPECNET_selectAction_billPay_otp_billPayStart'), 1, 0)) AS portals_one_time_payment_starts,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND (array_contains(state__view__current_page__elements__selected_options, 'New Pay Method') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false,pmt:NewPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false,pmt:NewStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true,pmt:NewStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true,pmt:NewPayment'))) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment')))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment')))), 1, 0)) AS portals_one_time_payment_submission_new_payment_method,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment')))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment')))), 1, 0)) AS portals_one_time_payment_submission_new_payment_method_not_stored,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment')))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment')))), 1, 0)) AS portals_one_time_payment_submission_new_payment_method_stored,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND (array_contains(state__view__current_page__elements__selected_options, 'Stored Pay Method') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false,pmt:ExistingStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true,pmt:ExistingStoredPayment'))) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:savedPaymentMethod')))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('reviewCompleteMakePayment', 'makePaymentConfirm') AND ((array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')) OR (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:savedPaymentMethod')))), 1, 0)) AS portals_one_time_payment_submission_previously_stored_payment_method,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND message__event_case_id = 'mySpectrum_selectAction_makePaymentConfirm') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND message__event_case_id IN('SPECTRUM_selectAction_billing_reviewAndComplete_makePayment', 'SPECNET_selectAction_billing_otp_paymentReview_continue')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND message__event_case_id IN('SPECTRUM_selectAction_billing_reviewAndComplete_makePayment', 'SMB_selectAction_billing_otp_paymentReview_continue')), 1, 0)) AS portals_one_time_payment_submits,
        SUM(IF((((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')))) OR (((visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')))), 1, 0)) AS portals_one_time_payment_submits_with_ap,
        SUM(IF((((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:savedPaymentMethod')))) OR (((visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:false, pmt:savedPaymentMethod')))), 1, 0)) AS portals_one_time_payment_submits_without_ap,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name IN ('paymentSuccess', 'paymentWithAutoPaySuccess', 'paySuccess', 'paySuccessAutoPay') AND state__view__previous_page__page_name IN ('makePayment', 'reviewCompletePayment')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__event_case_id IN ('SPECNET_selectAction_billPayStop_otp_triggeredByApplicationSuccess', 'SPECNET_selectAction_billPayStop_otpAp_triggeredByApplicationSuccess')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND message__event_case_id IN('SMB_featureStop_billPayStop_otpSuccess_autoPay', 'SMB_featureStop_billPayStop_otpSuccess', 'SPECNET_selectAction_billPayStop_otpAp_triggeredByApplicationSuccess', 'SPECNET_selectAction_billPayStop_otp_triggeredByApplicationSuccess')), 1, 0)) AS portals_one_time_payment_successes,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND ((state__view__current_page__page_name IN ('paymentWithAutoPaySuccess', 'paySuccessAutoPay') AND  state__view__previous_page__page_name ='makePayment') OR (state__view__current_page__page_name IN ('paymentSuccess', 'paymentWithAutoPaySuccess', 'paySuccessAutoPay') AND  state__view__previous_page__page_name IN ('makePayment', 'reviewCompletePayment') AND  state__view__current_page__page_title ='Auto Pay Enrollment'))) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__event_case_id IN ('SPECNET_selectAction_billPayStop_otpAp_triggeredByApplicationSuccess')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND message__event_case_id IN('SMB_featureStop_billPayStop_otpSuccess_autoPay', 'SPECNET_selectAction_billPayStop_otpAp_triggeredByApplicationSuccess')), 1, 0)) AS portals_one_time_payment_successes_with_ap_enroll,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND ((state__view__current_page__page_name IN ('paymentSuccess', 'paySuccess') AND state__view__previous_page__page_name ='makePayment') OR (state__view__current_page__page_name IN ('paymentSuccess', 'paySuccess') AND  state__view__previous_page__page_name IN ('makePayment', 'reviewCompletePayment') AND  state__view__current_page__page_title IN('Payment Success', 'Future Dated Payment', 'Payment Success & Auto Pay Failure')))) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__event_case_id IN ('SPECNET_selectAction_billPayStop_otp_triggeredByApplicationSuccess')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND message__event_case_id IN('SMB_featureStop_billPayStop_otpSuccess', 'SPECNET_selectAction_billPayStop_otp_triggeredByApplicationSuccess')), 1, 0)) AS portals_one_time_payment_successes_without_ap_enroll,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'editDeviceNickname' , 1, 0)) AS portals_open_edit_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'editWifiNetwork' , 1, 0)) AS portals_open_edit_wifi_network,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hostnameTooltip' , 1, 0)) AS portals_open_hostname_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'macAddressTooltip' , 1, 0)) AS portals_open_mac_address_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetNetworkTooltip' , 1, 0)) AS portals_open_network_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDevice' , 1, 0)) AS portals_open_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'removeDevice' , 1, 0)) AS portals_open_remove_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDevice' , 1, 0)) AS portals_open_unpause_device,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'pageView'), 1, 0)) AS portals_page_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'appTutorialButton' , 1, 0)) AS portals_quick_tutorial,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'contactUs' , 1, 0)) AS portals_request_callback,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'reschedApptConfirm') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'appointmentRescheduleConfirm') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'pageView' AND state__view__current_page__page_name = 'appointmentRescheduleSuccess'), 1, 0)) AS portals_rescheduled_service_appointments,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'resetAccountPassword' , 1, 0)) AS portals_reset_password_attempts,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'portForwardAndIpResInfo' , 1, 0)) AS portals_router_advanced_settings_click_about_port_forward,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addPortAssignment' , 1, 0)) AS portals_router_advanced_settings_click_add_port_assignment,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelDnsChanges' , 1, 0)) AS portals_router_advanced_settings_click_cancel_dns_change,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelPortAssignmentDetailsEntry' , 1, 0)) AS portals_router_advanced_settings_click_cancel_port_assignment,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'createIPReservationDevice' , 1, 0)) AS portals_router_advanced_settings_click_create_ip_reservation,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('confirmDeletePortAssignment', 'cancelDeletePortAssignment') , 1, 0)) AS portals_router_advanced_settings_click_delete_or_cancel_delete_port,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deletePortAssignment' , 1, 0)) AS portals_router_advanced_settings_click_delete_port,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'dnsServer' , 1, 0)) AS portals_router_advanced_settings_click_dns,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'manageDns' , 1, 0)) AS portals_router_advanced_settings_click_manage_dns,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'existingIPReservationsDevice' , 1, 0)) AS portals_router_advanced_settings_click_manage_ip_reservations,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'portForwardAndIpRes' , 1, 0)) AS portals_router_advanced_settings_click_port_forward,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'resetToDefault' , 1, 0)) AS portals_router_advanced_settings_click_reset_dns_default,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'confirmDnsChanges' , 1, 0)) AS portals_router_advanced_settings_click_save_confirm_dns,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'confirmResetDnsDefault' , 1, 0)) AS portals_router_advanced_settings_click_spectrum_dns_default,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'universalPlugAndPlay' , 1, 0)) AS portals_router_advanced_settings_click_upnp,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'selectExistingPortAssignment' , 1, 0)) AS portals_router_advanced_settings_click_use_existing_port,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deletePortAssignment'  AND operation__operation_type = 'swipe' , 1, 0)) AS portals_router_advanced_settings_delete_port_assignment_via_swipe,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'okPortUnavailable' , 1, 0)) AS portals_router_advanced_settings_port_unavailable_modal,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'reserveIPToggle'  AND operation__toggle_state = FALSE , 1, 0)) AS portals_router_advanced_settings_reserve_ip_toggle_off,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'reserveIPToggle'  AND operation__toggle_state = TRUE , 1, 0)) AS portals_router_advanced_settings_reserve_ip_toggle_on,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'UPnPToggle'  AND operation__toggle_state = FALSE , 1, 0)) AS portals_router_advanced_settings_upnp_toggle_off,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'UPnPToggle'  AND operation__toggle_state = TRUE , 1, 0)) AS portals_router_advanced_settings_upnp_toggle_on,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'saveDeviceNickname' , 1, 0)) AS portals_save_edit_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'saveEditWifi' , 1, 0)) AS portals_save_edit_wifi_network,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDeviceCancel'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_cancel_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDeviceCancel'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_cancel_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDeviceConfirm'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_confirm_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDeviceConfirm'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_confirm_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetConnectedDevices'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_connected_devices_tab,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetManageDevices'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_manage_device_tab,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetNotConnectedDevices'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_not_connected_devices_tab,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDevice'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('pauseDevice', 'unpauseDevice') , 1, 0)) AS portals_scp_click_pause_unpause_device_icon,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('pauseDevice', 'unpauseDevice')  AND state__view__current_page__page_name = 'pausedTab' , 1, 0)) AS portals_scp_click_pause_unpause_device_paused_tab,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetPausedDevices'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_paused_tab,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDevice'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_click_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('pauseDeviceCancel', 'unpauseDeviceCancel')  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_cancel_pause_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('pauseDeviceConfirm', 'unpauseDeviceConfirm')  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_confirm_pause_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'hostnameTooltip'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_hostname_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'macAddressTooltip'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_mac_address_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetNetworkTooltip'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_network_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN('pauseDevice', 'unpauseDevice')  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_pause_unpause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'removeDevice'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_click_remove_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'editDeviceNickname'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_edit_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelDeviceNickname'  AND operation__operation_type = 'buttonClick'  AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname') , 1, 0)) AS portals_scp_ddp_edit_device_nickname_cancel,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'saveDeviceNickname'  AND ((array_contains(state__view__current_page__elements__selected_options,  'requiredForTracker,Venona:false}')) AND operation__operation_type = 'buttonClick' AND state__view__current_page__page_name IN('deviceDetails', 'deviceNickname')) , 1, 0)) AS portals_scp_ddp_save_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deviceTypeSelect' , 1, 0)) AS portals_scp_device_type_select,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'apiCall'  AND application__api__api_name = 'connectedDevicesV1EquipRegisteredDevices' , 1, 0)) AS portals_scp_flagged_customers,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'cancelRemoveDevice'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_remove_device_cancel,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'confirmRemoveDevice'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_remove_device_confirm,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'refresh'  AND operation__operation_type = 'swipe' , 1, 0)) AS portals_scp_select_action_refresh,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deviceSelect'  AND operation__operation_type = 'buttonClick' , 1, 0)) AS portals_scp_view_device_details,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'apiCall' AND ((message__event_case_id IN('SPECTRUM_Campaigns_API_Success', 'SPECTRUM_Campaigns_API_Failure')AND application__api__response_text RLIKE '.*SECURITY_QUESTION_AND_ANSWER.*') OR (message__event_case_id IN('SPECNET_Generic_API_Call_Success', 'SPECNET_Generic_API_Call_Failure') AND application__api__response_text RLIKE '.*SECURITY_QUESTION_AND_ANSWER.*'))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'apiCall' AND ((message__event_case_id IN('SPECTRUM_Campaigns_API_Success', 'SPECTRUM_Campaigns_API_Failure')AND application__api__response_text RLIKE '.*SECURITY_QUESTION_AND_ANSWER.*') OR (message__event_case_id IN('SPECNET_Generic_API_Call_Success', 'SPECNET_Generic_API_Call_Failure') AND application__api__response_text RLIKE '.*SECURITY_QUESTION_AND_ANSWER.*'))), 1, 0)) AS portals_security_qa_campaign_interaction,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelCampaign' AND state__view__current_page__page_name = 'campaignSecurity') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelCampaign' AND state__view__current_page__page_name = 'campaignSecurity'), 1, 0)) AS portals_security_qa_cancel_close,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'iconCampaign' AND state__view__current_page__elements__ui_name = 'Update Security Questions') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'iconCampaign' AND state__view__current_page__elements__ui_name = 'Update Your Contact Info'), 1, 0)) AS portals_security_qa_icon_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'skipThisCampaign' AND state__view__current_page__page_name = 'campaignSecurity') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'skipThisCampaign' AND state__view__current_page__page_name = 'campaignSecurity'), 1, 0)) AS portals_security_qa_skip_this,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name = 'campaignSecurity') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__page_name = 'campaignSecurity'), 1, 0)) AS portals_security_qa_update_security_page_view,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'), 1, 0)) AS portals_select_actions,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deviceSelect'  AND state__view__current_page__page_name = 'connectedTab' , 1, 0)) AS portals_select_individual_connected_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deviceSelect'  AND state__view__current_page__page_name = 'notConnectedTab' , 1, 0)) AS portals_select_individual_not_connected_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'deviceSelect'  AND state__view__current_page__page_name = 'pausedTab' , 1, 0)) AS portals_select_individual_paused_device,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND (state__view__current_page__page_name = 'autoPayFail' OR (state__view__current_page__page_name = 'enrollmentFailure' AND state__view__previous_page__page_name = 'autoPayEnroll'))) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__feature__feature_name IN ('autoPayEnrollment', 'manageAutopay') AND operation__success = FALSE AND message__event_case_id NOT RLIKE '.*Cancelled.*') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND ((message__feature__feature_step_name IN ('apEnrollFailure', 'apEnrollFailureWithPayment') AND message__feature__feature_step_changed = true) OR (message__feature__feature_name IN ('autoPayEnrollment', 'manageAutopay') AND operation__success = FALSE AND message__event_case_id NOT RLIKE '.*Cancelled.*'))), 1, 0)) AS portals_set_up_auto_payment_failures,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'autoPayManage') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__event_case_id = 'SPECNET_billPay_billPayStart_autoPayEnroll') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__event_case_id = 'SPECNET_billPay_billPayStart_autoPayEnroll'), 1, 0)) AS portals_set_up_auto_payment_starts,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND message__event_case_id IN('SPECNET_selectAction_billing_enrollAutopay_alreadyPaidBalanceDue', 'SPECNET_selectAction_billing_enrollAutopay_noBalance', 'SPECNET_selectAction_billing_enrollAutopay_withBalance')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND message__event_case_id IN('SPECNET_selectAction_billing_enrollAutopay_alreadyPaidBalanceDue', 'SPECNET_selectAction_billing_enrollAutopay_noBalance', 'SPECNET_selectAction_billing_enrollAutopay_withBalance')), 1, 0)) AS portals_set_up_auto_payment_submits,
        SUM(IF(((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.enroll-in-autopay-no-balance-checkingAccount', 'pay-bill.enroll-in-autopay-no-balance-savingsAccount', 'pay-bill.enroll-in-autopay-no-balance-creditDebitCard', 'pay-bill.enroll-in-autopay-with-balance-creditDebitCard', 'pay-bill.enroll-in-autopay-with-balance-checkingAccount', 'pay-bill.enroll-in-autopay-with-balance-savingsAccount', 'pay-bill.enroll-in-autopay.already-paid-balance-due', 'balanceDuePaid') AND state__view__current_page__page_section__name = 'enroll-in-autopay') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('enrollNoBalanceChecking', 'enrollNoBalanceSavings', 'enrollNoBalanceCreditDebitCard', 'enrollWithBalanceCreditDebitCard', 'enrollWithBalanceChecking', 'enrollWithBalanceSavings') AND state__view__current_page__page_section__name = 'autoPayEnrollment') OR ((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')))) OR ((visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('pay-bill.enroll-in-autopay-no-balance-checkingAccount', 'pay-bill.enroll-in-autopay-no-balance-savingsAccount', 'pay-bill.enroll-in-autopay-no-balance-creditDebitCard', 'pay-bill.enroll-in-autopay-with-balance-creditDebitCard', 'pay-bill.enroll-in-autopay-with-balance-checkingAccount', 'pay-bill.enroll-in-autopay-with-balance-savingsAccount', 'pay-bill.enroll-in-autopay.already-paid-balance-due', 'balanceDuePaid') AND state__view__current_page__page_section__name = 'enroll-in-autopay') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN ('enrollNoBalanceChecking', 'enrollNoBalanceSavings', 'enrollNoBalanceCreditDebitCard', 'enrollWithBalanceCreditDebitCard', 'enrollWithBalanceChecking', 'enrollWithBalanceSavings') AND state__view__current_page__page_section__name = 'autoPayEnrollment') OR ((visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__app_section = 'billing' AND ((state__view__current_page__elements__standardized_name IN ('pay-bill.onetime.payment-review.make-payment', 'reviewCompleteMakePayment') AND state__view__current_page__page_section__name = 'make-a-payment') OR (state__view__current_page__elements__standardized_name = 'makePaymentConfirm' AND state__view__current_page__page_section__name = 'paymentReview'))) AND (array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:newStoredPayment') OR array_contains(state__view__current_page__elements__selected_options, 'autopay:true, pmt:savedPaymentMethod')))), 1, 0)) AS portals_set_up_auto_payment_submits_plus_otp,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name IN( 'autoPayEnrollmentSuccess', 'paymentWithAutoPaySuccess', 'autoPaySuccess', 'paySuccessAutoPay', 'enrollmentSuccess') AND state__view__previous_page__page_name = 'autoPayEnroll') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStop' AND message__event_case_id IN('SPECNET_billPay_billPayStop_autopayEnrolled_triggeredByApplicationSuccess', 'SPECNET_billPay_billPayStop_autopayEnrollmentWithPayment_triggeredByApplicationSuccess')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStop' AND message__event_case_id IN('SPECNET_billPay_billPayStop_autopayEnrolled_triggeredByApplicationSuccess', 'SPECNET_billPay_billPayStop_autopayEnrollmentWithPayment_triggeredByApplicationSuccess', 'SMB_featureStop_billPayStop_apEnrollSuccess_withPayment', 'SMB_featureStop_billPayStop_apEnrollSuccess')), 1, 0)) AS portals_set_up_auto_payment_successes,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND ((state__view__current_page__page_name IN ('paySuccessAutoPay') AND state__view__previous_page__page_name = 'autoPayEnroll') OR (state__view__current_page__page_name IN ('paymentWithAutoPaySuccess')))) OR (visit__application_details__application_name = 'SpecNet' AND (message__event_case_id IN ('SPECNET_billPay_billPayStop_autopayEnrollmentWithPayment_triggeredByApplicationSuccess'))) OR (visit__application_details__application_name = 'SMB' AND ((message__name = 'featureStop' AND message__feature__feature_step_name IN( 'apEnrollSuccessWithPayment') AND message__feature__feature_step_changed = TRUE) OR ((message__event_case_id IN ('SPECNET_billPay_billPayStop_autopayEnrollmentWithPayment_triggeredByApplicationSuccess'))))), 1, 0)) AS portals_set_up_auto_payment_successes_with_payment,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name IN ('autoPaySuccess', 'enrollmentSuccess') AND state__view__previous_page__page_name = 'autoPayEnroll') OR (visit__application_details__application_name = 'SpecNet' AND (message__event_case_id IN ('SPECNET_billPay_billPayStop_autopayEnrolled_triggeredByApplicationSuccess'))) OR (visit__application_details__application_name = 'SMB' AND ((message__name = 'featureStop' AND message__feature__feature_step_name IN( 'apEnrollSuccess') AND message__feature__feature_step_changed = TRUE) OR ((message__event_case_id IN ('SPECNET_billPay_billPayStop_autopayEnrolled_triggeredByApplicationSuccess'))))), 1, 0)) AS portals_set_up_auto_payment_successes_without_payment,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'marketingAndAdvertisingPreferences') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'marketingAndAdvertisingPreferences'), 1, 0)) AS portals_settings_ad_marketing_card_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'settingsMovingLink') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'settingsMovingLink'), 1, 0)) AS portals_settings_moving_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'accessibility') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'accessibility'), 1, 0)) AS portals_settings_navigate_to_accessibility,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'spectrumMobile') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'spectrumMobile'), 1, 0)) AS portals_settings_navigate_to_mobile,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'voiceOnlineManager') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'voiceOnlineManager'), 1, 0)) AS portals_settings_navigate_to_vom,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'parentalControls') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'discoverMoreCard' AND state__view__current_page__page_section__name = 'discoverMore' AND state__view__current_page__page_sub_section__name = 'parentalControls'), 1, 0)) AS portals_settings_parental_controls_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelAddPerson') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelAddPerson'), 1, 0)) AS portals_settings_sign_in_security_add_person_cancel_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveAddPerson') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveAddPerson'), 1, 0)) AS portals_settings_sign_in_security_add_person_save_modal,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelSignInSecurity') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelSignInSecurity'), 1, 0)) AS portals_settings_sign_in_security_cancel_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageSignInSecurityInfo') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageSignInSecurityInfo'), 1, 0)) AS portals_settings_sign_in_security_manage_select_action,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'manageVoiceLine' , 1, 0)) AS portals_settings_sign_in_security_manage_voice_line_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'addPerson' AND state__view__current_page__page_section__name = 'peopleStickyNav') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'addPerson' AND state__view__current_page__page_section__name = 'peopleStickyNav'), 1, 0)) AS portals_settings_sign_in_security_people_add_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'deleteRole' AND state__view__current_page__page_section__name = 'contextualMenu') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'deleteRole' AND state__view__current_page__page_section__name = 'contextualMenu'), 1, 0)) AS portals_settings_sign_in_security_people_delete_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveSignInSecurity') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveSignInSecurity'), 1, 0)) AS portals_settings_sign_in_security_save_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'subNavPeople' AND state__view__current_page__page_section__name = 'subNav') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'subNavPeople' AND state__view__current_page__page_section__name = 'subNav'), 1, 0)) AS portals_settings_sign_in_security_subnav_people_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voiceAccessToggle' AND operation__toggle_state = FALSE) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voiceAccessToggle' AND operation__toggle_state = FALSE), 1, 0)) AS portals_settings_sign_in_security_voice_access_toggleoff_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voiceAccessToggle' AND operation__toggle_state = TRUE) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voiceAccessToggle' AND operation__toggle_state = TRUE), 1, 0)) AS portals_settings_sign_in_security_voice_access_toggleon_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verify') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'verify'), 1, 0)) AS portals_settings_verify_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelContactInfo') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelContactInfo'), 1, 0)) AS portals_settings_your_info_cancel_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'changeRole' AND state__view__current_page__page_section__name = 'role') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'changeRole' AND state__view__current_page__page_section__name = 'role'), 1, 0)) AS portals_settings_your_info_change_role_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND state__view__current_page__page_name = 'contactInfo' AND operation__operation_type = 'spinnerSuccess') OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND state__view__current_page__page_name = 'contactInfo' AND operation__operation_type = 'spinnerSuccess'), 1, 0)) AS portals_settings_your_info_changes_success,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageContact' AND state__view__current_page__page_section__name = 'contactInfo') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageContact' AND state__view__current_page__page_section__name = 'contactInfo'), 1, 0)) AS portals_settings_your_info_manage_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resendVerificationCode') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resendVerificationCode'), 1, 0)) AS portals_settings_your_info_resend_verify_code,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveContactInfo') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'saveContactInfo'), 1, 0)) AS portals_settings_your_info_save_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'subNavYourInfo') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'subNavYourInfo'), 1, 0)) AS portals_settings_your_info_select_action,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'spinnerFailure') OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'spinnerFailure'), 1, 0)) AS portals_settings_your_info_verify_failure,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__text = 'Verify Your Identity Email') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__text = 'Verify Your Identity Email'), 1, 0)) AS portals_settings_your_info_verify_identity_email_modal_view,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__modal_type = 'message') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__modal_type = 'message'), 1, 0)) AS portals_settings_your_info_verify_identity_modal_view,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__text = 'Verify Your Identity Phone') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND state__view__modal__name = 'verifyIdentity' AND state__view__modal__text = 'Verify Your Identity Phone'), 1, 0)) AS portals_settings_your_info_verify_identity_phone_modal_view,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'applicationActivity' AND operation__operation_type = 'spinnerSuccess') OR (visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity' AND operation__operation_type = 'spinnerSuccess'), 1, 0)) AS portals_settings_your_info_verify_success,
        SUM(IF((visit__application_details__application_name = 'MySpectrum') OR (visit__application_details__application_name = 'SpecNet') OR (visit__application_details__application_name = 'SMB'), 1, 0)) AS portals_site_unique,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'loginStop' AND operation__success = TRUE) OR (visit__application_details__application_name = 'SpecNet' AND (message__name = 'userConfigSet') OR (message__name = 'loginStop' AND operation__success = TRUE)) OR (visit__application_details__application_name = 'SMB' AND (message__name = 'userConfigSet') OR (message__name = 'loginStop' AND operation__success = TRUE)), 1, 0)) AS portals_site_unique_auth,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND visit__device__operating_system RLIKE '.*iOS|Android.*') OR (visit__application_details__application_name = 'SMB'  AND visit__device__operating_system RLIKE '.*iOS|Android.*'), 1, 0)) AS portals_site_unique_mobile,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND visit__device__operating_system NOT RLIKE '.*iOS|Android.*') OR (visit__application_details__application_name = 'SMB'  AND visit__device__operating_system NOT RLIKE '.*iOS|Android.*'), 1, 0)) AS portals_site_unique_pc,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'pauseDeviceConfirm' , 1, 0)) AS portals_start_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'unpauseDeviceConfirm' , 1, 0)) AS portals_start_unpause_device,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'applicationActivity'  AND operation__operation_type = 'userAddSuccessBanner'  AND message__context = 'Standard' , 1, 0)) AS portals_sub_acct_created,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'addNewUserConfirm'  AND (state__view__current_page__elements__element_string_value = 'Standard' or message__context = 'Standard') , 1, 0)) AS portals_sub_user_creation_attempts,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportArticleSelect' , 1, 0)) AS portals_support_article_select,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHome' , 1, 0)) AS portals_support_button,
        SUM(IF((visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'account') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'Account'), 1, 0)) AS portals_support_header_nav_account,
        SUM(IF(visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'   AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation'  AND state__view__current_page__page_section__name = 'supportHeader'  AND state__view__current_page__elements__ui_name = 'homeSecurity' , 1, 0)) AS portals_support_header_nav_home_security,
        SUM(IF((visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'internet') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'Internet'), 1, 0)) AS portals_support_header_nav_internet,
        SUM(IF(visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'   AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation'  AND state__view__current_page__page_section__name = 'supportHeader'  AND state__view__current_page__elements__ui_name = 'mobile' , 1, 0)) AS portals_support_header_nav_mobile,
        SUM(IF((visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'supportHome') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'Support Home'), 1, 0)) AS portals_support_header_nav_support_home,
        SUM(IF((visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'tv') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'TV'), 1, 0)) AS portals_support_header_nav_tv,
        SUM(IF((visit__application_details__application_name = 'SpecNet'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'voice') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'supportHeaderNavigation' AND state__view__current_page__page_section__name = 'supportHeader' AND state__view__current_page__elements__ui_name = 'Voice'), 1, 0)) AS portals_support_header_nav_voice,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__app_section = 'support') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__app_section = 'support') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__app_section = 'support'), 1, 0)) AS portals_support_page_views,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'assetDisplayed' AND state__view__current_page__page_section__name = 'accountSummary') OR (visit__application_details__application_name = 'SMB' AND message__name = 'assetDisplayed' AND state__view__current_page__page_section__name = 'accountSummary'), 1, 0)) AS portals_tech_tracker_auth_views,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('appointment-service-cancel', 'appointment-installation-cancel')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('appointment-service-cancel', 'appointment-installation-cancel')), 1, 0)) AS portals_tech_tracker_cancel_attempt_auth,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'unAuthApptCancel') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'unAuthApptCancel'), 1, 0)) AS portals_tech_tracker_cancel_attempt_unauth,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('appointment-installation-reschedule', 'appointment-service-reschedule')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('appointment-installation-reschedule', 'appointment-service-reschedule')), 1, 0)) AS portals_tech_tracker_reschedule_starts_auth,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'unAuthApptReschedule') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'unAuthApptReschedule'), 1, 0)) AS portals_tech_tracker_reschedule_starts_unauth,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name = 'unauthenticatedServiceAppts') OR (visit__application_details__application_name = 'SMB' AND message__name = 'pageView' AND state__view__current_page__page_name = 'unauthenticatedServiceAppts'), 1, 0)) AS portals_tech_tracker_unauth_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'onboardingTour'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 4' , 1, 0)) AS portals_tutorial_account_page_five_page_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'onboardingTour'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 3' , 1, 0)) AS portals_tutorial_account_page_four_page_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'onboardingTour'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 2' , 1, 0)) AS portals_tutorial_equip_page_three_page_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'onboardingTour'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 1' , 1, 0)) AS portals_tutorial_otp_page_two_page_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'onboardingTour'  AND state__view__current_page__page_title = 'LoginOnboarding.json Page: 0' , 1, 0)) AS portals_tutorial_start_page_one_page_view,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'onboardingTour' , 1, 0)) AS portals_tutorial_views,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.tv.troubleshoot.reset-equip.cancel' , 1, 0)) AS portals_tv_equipment_reset_flow_cancel_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.tv.troubleshoot.reset-equip.reset-failure-modal-continue' , 1, 0)) AS portals_tv_equipment_reset_flow_failure_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__current_page__page_name = 'tvTab' AND state__view__modal__name IN ('resetrouterfail-modal','resetmodemfail-modal')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure'), 1, 0)) AS portals_tv_equipment_reset_flow_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) =  'reset-equipment-tv-failure' , 1, 0)) AS portals_tv_equipment_reset_flow_failures_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.tv.troubleshoot.reset-equip.complete-modal-issue-resolved' , 1, 0)) AS portals_tv_equipment_reset_flow_manual_success_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset'), 1, 0)) AS portals_tv_equipment_reset_flow_modal_wait,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__page_name = 'tvTab' AND state__view__current_page__elements__standardized_name = 'troubleshoot') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset'), 1, 0)) AS portals_tv_equipment_reset_flow_starts,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.tv.troubleshoot' , 1, 0)) AS portals_tv_equipment_reset_flow_starts_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resetEquip' AND state__view__current_page__page_name = 'tvTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'tvTroubleshoot') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'tvTroubleshoot'), 1, 0)) AS portals_tv_equipment_reset_flow_submit,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.tv.troubleshoot.reset-equip.start' , 1, 0)) AS portals_tv_equipment_reset_flow_submit_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.tv.troubleshoot.reset-equip.complete-modal-continue' , 1, 0)) AS portals_tv_equipment_reset_flow_success_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name = 'resetsuccess-modal' AND state__view__previous_page__page_name = 'tvTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'tvTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success'), 1, 0)) AS portals_tv_equipment_reset_flow_successes,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) =  'reset-equipment-tv-success' , 1, 0)) AS portals_tv_equipment_reset_flow_successes_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__current_page__page_name = 'tvTab'  AND state__view__modal__name = 'resetmodemfail-modal' , 1, 0)) AS portals_tv_modem_reset_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__current_page__page_name = 'tvTab'  AND state__view__modal__name = 'resetrouterfail-modal' , 1, 0)) AS portals_tv_router_reset_failures,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView' AND state__view__current_page__page_name = 'home-unauth') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'pageView' AND state__view__current_page__page_name = 'homeUnauth'), 1, 0)) AS portals_unauth_homepage_page_views,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'apiCall' AND ((message__event_case_id IN('SPECTRUM_Campaigns_API_Success', 'SPECTRUM_Campaigns_API_Failure') AND (application__api__response_text RLIKE '.*NAME_INVALID_IDENTITY_CONTACT.*' OR application__api__response_text RLIKE '.*NAME_MISSING_IDENTITY_CONTACT.*' OR application__api__response_text RLIKE '.*NAME_ANNUAL_IDENTITY_CONTACT.*' )) OR (message__event_case_id IN('SPECNET_Generic_API_Call_Success', 'SPECNET_Generic_API_Call_Failure') AND application__api__response_text RLIKE '.*NAME_MISSING_IDENTITY_CONTACT.*'))) OR (visit__application_details__application_name = 'SMB' AND message__name = 'apiCall' AND ((message__event_case_id IN('SPECTRUM_Campaigns_API_Success', 'SPECTRUM_Campaigns_API_Failure') AND (application__api__response_text RLIKE '.*NAME_INVALID_IDENTITY_CONTACT.*' OR application__api__response_text RLIKE '.*NAME_MISSING_IDENTITY_CONTACT.*' OR application__api__response_text RLIKE '.*NAME_ANNUAL_IDENTITY_CONTACT.*' )) OR (message__event_case_id IN('SPECNET_Generic_API_Call_Success', 'SPECNET_Generic_API_Call_Failure') AND application__api__response_text RLIKE '.*NAME_MISSING_IDENTITY_CONTACT.*'))), 1, 0)) AS portals_update_missing_contact_campaign_interaction,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelCampaign' AND state__view__current_page__page_name = 'campaignContact') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'cancelCampaign' AND state__view__current_page__page_name = 'campaignContact'), 1, 0)) AS portals_update_missing_contact_cancel_close_window,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'iconCampaign' AND state__view__current_page__elements__ui_name = 'Update Your Contact Info') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'iconCampaign' AND state__view__current_page__elements__ui_name = 'Update Your Contact Info'), 1, 0)) AS portals_update_missing_contact_icon_click,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveCampaign') AND state__view__current_page__page_name = 'campaignContact') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveCampaign') AND state__view__current_page__page_name = 'campaignContact'), 1, 0)) AS portals_update_missing_contact_save,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveCampaign', 'saveAndContinueCampaign') AND state__view__current_page__page_name = 'campaignContact') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveCampaign', 'saveAndContinueCampaign') AND state__view__current_page__page_name = 'campaignContact'), 1, 0)) AS portals_update_missing_contact_save_all,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveAndContinueCampaign') AND state__view__current_page__page_name = 'campaignContact') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN('saveAndContinueCampaign') AND state__view__current_page__page_name = 'campaignContact'), 1, 0)) AS portals_update_missing_contact_save_and_continue,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'skipThisCampaign' AND state__view__current_page__page_name = 'campaignContact') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'skipThisCampaign' AND state__view__current_page__page_name = 'campaignContact'), 1, 0)) AS portals_update_missing_contact_skip_this,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'updateCampaign' AND state__view__current_page__elements__ui_name = 'Update All') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'updateCampaign' AND state__view__current_page__elements__ui_name = 'Update All'), 1, 0)) AS portals_update_missing_contact_update_all,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_name = 'home-authenticated'  AND state__view__current_page__elements__standardized_name = 'Upgrade-Overview-Banner' , 1, 0)) AS portals_upgrade_links_overview,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.internet.upgrade-service' , 1, 0)) AS portals_upgrade_service_internet,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.tv.upgrade-service' , 1, 0)) AS portals_upgrade_service_tv,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equipment.voice.upgrade-your-service' , 1, 0)) AS portals_upgrade_service_voice,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'utilityNav-email' , 1, 0)) AS portals_utilitynav_email,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'utilityNav-support') OR (visit__application_details__application_name = 'SMB'  AND message__name = 'selectAction' AND state__view__current_page__page_section__name = 'header' AND state__view__current_page__elements__standardized_name = 'support'), 1, 0)) AS portals_utilitynav_support,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'utilityNav-voice' , 1, 0)) AS portals_utilitynav_voice,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Desktop Security' , 1, 0)) AS portals_vas_tile_desktop_security,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Domain' , 1, 0)) AS portals_vas_tile_domain_registration,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Email' , 1, 0)) AS portals_vas_tile_email,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'moreServices'  AND state__view__current_page__elements__ui_name = 'Web Hosting' , 1, 0)) AS portals_vas_tile_web_hosting,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section = 'support'  AND state__view__current_page__page_url RLIKE '/support/tv*' , 1, 0)) AS portals_video_support_views,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetConnectedDevices' , 1, 0)) AS portals_view_connected_devices,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'deviceNickname' , 1, 0)) AS portals_view_edit_device_nickname,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView'  AND state__view__current_page__page_name = 'editNetwork' , 1, 0)) AS portals_view_edit_wifi_network,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'hostnametooltip-modal' , 1, 0)) AS portals_view_hostname_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'macaddresstooltip-modal' , 1, 0)) AS portals_view_mac_address_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'internetnetworktooltip-modal' , 1, 0)) AS portals_view_network_tooltip,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetNotConnectedDevices' , 1, 0)) AS portals_view_not_connected_devices,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name = 'statementDetail') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN( 'downloadStatement', 'pay-bill.billing-statement-download')) OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name IN( 'downloadStatement', 'pay-bill.billing-statement-download')), 1, 0)) AS portals_view_online_statments,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'pausedevice-modal' , 1, 0)) AS portals_view_pause_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetPausedDevices' , 1, 0)) AS portals_view_paused_devices,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'removedevice-modal' , 1, 0)) AS portals_view_remove_device,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__modal__name = 'unpausedevice-modal' , 1, 0)) AS portals_view_unpause_device,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voicemailDelete') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'deleteMessage'), 1, 0)) AS portals_voice_delete_messages,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.voice.troubleshoot.reset-equip.cancel' , 1, 0)) AS portals_voice_equipment_reset_flow_cancel_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'equip.voice.troubleshoot.reset-equip.reset-failure-modal-continue' , 1, 0)) AS portals_voice_equipment_reset_flow_failure_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__current_page__page_name = 'voiceTab' AND (state__view__modal__name IN ('resetrouterfail-modal','resetmodemfail-modal')) OR (visit__application_details__application_name = 'myspectrum' AND message__name = 'modalView' AND state__view__modal__name IN ('resetrouterfail-modal','resetmodemfail-modal') AND state__view__current_page__page_name = 'voiceTab')) OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'resetFailureModal' AND state__view__modal__name = 'Reset-Equipment-Failure'), 1, 0)) AS portals_voice_equipment_reset_flow_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) =  'reset-equipment-voice-failure' , 1, 0)) AS portals_voice_equipment_reset_flow_failures_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name =  'equip.voice.troubleshoot.reset-equip.success-modal-issue-resolved' , 1, 0)) AS portals_voice_equipment_reset_flow_manual_success_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'waitToResetModal' AND state__view__modal__name = 'waitToReset'), 1, 0)) AS portals_voice_equipment_reset_flow_modal_wait,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__page_name = 'voiceTab' AND state__view__current_page__elements__standardized_name = 'troubleshoot') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'featureStart' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset') OR (visit__application_details__application_name = 'SMB' AND message__name = 'featureStart' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'openEquipmentReset'), 1, 0)) AS portals_voice_equipment_reset_flow_starts,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name =  'equipment.voice.troubleshoot' , 1, 0)) AS portals_voice_equipment_reset_flow_starts_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum'  AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'resetEquip' AND state__view__current_page__page_name = 'voiceTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'voiceTroubleshoot') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equip.troubleshoot.reset-equip.start' AND message__feature__feature_step_name = 'startReset' AND message__feature__feature_name = 'voiceTroubleshoot'), 1, 0)) AS portals_voice_equipment_reset_flow_submit,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('equip.voice.troubleshoot.reset-equip.start') , 1, 0)) AS portals_voice_equipment_reset_flow_submit_deprecated_cl68,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name IN ('equip.voice.troubleshoot.reset-equip.success-modal-continue') , 1, 0)) AS portals_voice_equipment_reset_flow_success_modal_continue_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView' AND state__view__modal__name = 'resetsuccess-modal' AND state__view__current_page__page_name = 'voiceTab') OR (visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success') OR (visit__application_details__application_name = 'SMB' AND message__name = 'modalView' AND message__feature__feature_name = 'voiceTroubleshoot' AND message__feature__feature_step_name = 'resetSuccessModal' AND state__view__modal__name = 'Reset-Equipment-Success'), 1, 0)) AS portals_voice_equipment_reset_flow_successes,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'modalView'  AND LOWER(state__view__modal__name) =  'reset-equipment-voice-success' , 1, 0)) AS portals_voice_equipment_reset_flow_successes_deprecated_cl68,
        SUM(IF((visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'equipment.voice.go-to-voice-online-manager') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'manageVoice'), 1, 0)) AS portals_voice_go_to_vom,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__current_page__page_name = 'voiceTab'  AND state__view__modal__name = 'resetmodemfail-modal' , 1, 0)) AS portals_voice_modem_reset_failures,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__previous_page__page_name = 'voiceTab'  AND state__view__modal__name = 'resetsuccess-modal' , 1, 0)) AS portals_voice_modem_reset_successes,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'pageView' AND state__view__current_page__page_name = 'voicemailHome') OR (visit__application_details__application_name = 'SMB' AND state__view__current_page__app_section = 'voice' AND message__name = 'pageView'), 1, 0)) AS portals_voice_pageviews,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'voicemailPlay') OR (visit__application_details__application_name = 'SMB' AND message__name = 'selectAction' AND state__view__current_page__elements__standardized_name = 'playMessage'), 1, 0)) AS portals_voice_play_messages,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'modalView'  AND state__view__current_page__page_name = 'voiceTab'  AND state__view__modal__name = 'resetrouterfail-modal' , 1, 0)) AS portals_voice_router_reset_failures,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'pageView'  AND state__view__current_page__app_section = 'support'  AND state__view__current_page__page_url RLIKE '/support/voice*' , 1, 0)) AS portals_voice_support_views,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'voiceSettingsForwardingSave' , 1, 0)) AS portals_voice_update_call_forward_settings,
        SUM(IF(visit__application_details__application_name = 'SMB' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'toggleMessages' , 1, 0)) AS portals_voice_view_messages,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'voicemailPause' , 1, 0)) AS portals_voice_voicemail_pause_select_action,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'viewVoicemail' , 1, 0)) AS portals_voice_voicemail_view_select_action,
        SUM(IF(visit__application_details__application_name = 'MySpectrum' AND message__name = 'selectAction'  AND state__view__current_page__elements__standardized_name = 'internetShowPassword' , 1, 0)) AS portals_wifi_password_views,
        SUM(IF((visit__application_details__application_name = 'MySpectrum' AND operation__operation_type = 'finalConfirm' AND state__view__current_page__elements__element_string_value = 'WPA2 Password Change: true') OR (visit__application_details__application_name = 'SpecNet' AND operation__operation_type = 'finalConfirm' AND state__view__current_page__elements__element_string_value = 'WPA2 Password Change: true') OR (visit__application_details__application_name = 'SMB' AND operation__operation_type = 'finalConfirm' AND state__view__current_page__elements__element_string_value = 'WPA2 Password Change: true'), 1, 0)) AS portals_wifi_pw_changes,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'equipment'  AND state__view__current_page__elements__standardized_name = 'internet' , 1, 0)) AS portals_yourservicesequip_internet,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'equipment'  AND state__view__current_page__elements__standardized_name = 'mobile' , 1, 0)) AS portals_yourservicesequip_mobile,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'equipment'  AND state__view__current_page__elements__standardized_name = 'tv' , 1, 0)) AS portals_yourservicesequip_tv,
        SUM(IF(visit__application_details__application_name = 'SpecNet' AND message__name = 'selectAction'  AND state__view__current_page__page_section__name = 'equipment'  AND state__view__current_page__elements__standardized_name = 'voice' , 1, 0)) AS portals_yourservicesequip_voice,
visit__account__enc_account_number as portals_unique_acct_key,
visit__activated_experiments as activated_experiments,
visit__application_details__technology_type as technology_type,
epoch_converter(received__timestamp, 'America/Denver') AS denver_date
FROM

(SELECT application__api__api_name,
      application__api__path,
      application__api__response_code,
      application__api__response_text,
      application__api__service_result,
      application__error__error_code,
      application__error__error_message,
      application__error__error_type,
      message__context,
      message__event_case_id,
      message__feature__feature_name,
      message__feature__feature_step_changed,
      message__feature__feature_step_name,
      message__name,
      operation__billing__payment_amount_usd,
      operation__billing__payment_date,
      operation__billing__payment_due_date,
      operation__billing__payment_method,
      operation__operation_type,
      operation__success,
      operation__toggle_state,
      operation__user_entry__enc_feedback,
      operation__user_entry__entry_type,
      operation__user_entry__str_value,
      received__timestamp,
      state__content__content_class,
      state__content__details__episode_number,
      state__content__details__genres,
      state__content__details__season_number,
      state__content__identifiers__tms_program_id,
      state__content__programmer__linear__channel_name,
      state__content__stream__playback_id,
      state__content__stream__playback_type,
      state__view__current_page__app_section,
      state__view__current_page__current_balance_amount,
      state__view__current_page__elements__element_int_value,
      state__view__current_page__elements__element_string_value,
      state__view__current_page__elements__selected_options,
      state__view__current_page__elements__standardized_name,
      state__view__current_page__elements__ui_name,
      state__view__current_page__page_name,
      state__view__current_page__page_section__name,
      state__view__current_page__page_sub_section__name,
      state__view__current_page__page_title,
      state__view__current_page__page_url,
      state__view__current_page__past_due_amount,
      state__view__current_page__total_amount_due,
      state__view__modal__modal_type,
      state__view__modal__name,
      state__view__modal__text,
      state__view__previous_page__app_section,
      state__view__previous_page__page_name,
      visit__account__details__auto_pay_status,
      visit__account__details__billing_status,
      visit__account__details__mso,
      visit__account__enc_account_billing_division,
      visit__account__enc_account_billing_division_id,
      visit__account__enc_account_billing_id,
      visit__account__enc_account_number,
      visit__activated_experiments,
      visit__application_details__app_version,
      visit__application_details__application_name,
      visit__application_details__application_type,
      visit__application_details__technology_type,
      visit__connection__connection_type,
      visit__connection__network_status,
      visit__device__browser__name,
      visit__device__browser__user_agent,
      visit__device__browser__version,
      visit__device__device_form_factor,
      visit__device__device_type,
      visit__device__enc_uuid,
      visit__device__model,
      visit__device__operating_system,
      visit__location__enc_city,
      visit__location__enc_zip_code,
      visit__location__state,
      visit__login__logged_in,
      visit__login__login_duration_ms,
      visit__variant_uuids,
      visit__visit_id
FROm  core_quantum_events
WHERE partition_date_hour_utc >= '${hiveconf:START_DATE_TZ}'
AND partition_date_hour_utc <  '${hiveconf:END_DATE_TZ}'
AND visit__application_details__application_name
  IN ('SpecNet',
      'SMB',
      'MySpectrum',
      'IDManagement',
      'PrivacyMicrosite'
     )
) dictionary

GROUP BY
  CASE
    WHEN  visit__account__details__mso IN ('CHARTER','CHTR','"CHTR"')       THEN 'L-CHTR'
    WHEN  visit__account__details__mso IN ('TWC','"TWC"', 'NONECAPTURED')   THEN 'L-TWC'
    WHEN  visit__account__details__mso IN ('BH','BHN','"BHN"')              THEN 'L-BHN'
    WHEN (visit__account__details__mso IN ('','unknown','"NONE"', 'NONE')
          OR visit__account__details__mso IS NULL )                         THEN 'MSO-MISSING'
    ELSE visit__account__details__mso
  END,
 visit__application_details__application_type,
LOWER(visit__device__device_type),
visit__device__model,
visit__connection__connection_type,
visit__connection__network_status,
state__content__stream__playback_type,
IF(visit__application_details__application_type = 'Android', IF(visit__device__operating_system   RLIKE '^(Android 4.0)' OR visit__device__operating_system RLIKE '^(Android 4.1)' OR   visit__device__operating_system RLIKE '^(Android 4.2)' OR visit__device__operating_system RLIKE  '^(Android 4.3)', 'Android 4.1 - 4.3', 'Android 4.4+'), NULL),
CASE
  WHEN visit__application_details__application_type IN('iOS','Android') THEN 'Mobile'
  WHEN visit__application_details__application_type IN('Xbox','SamsungTV') THEN 'Connected Devices'
 ELSE visit__application_details__application_type
END,
state__content__stream__playback_id,
visit__visit_id,
visit__device__enc_uuid,
visit__account__enc_account_number,
visit__variant_uuids,
state__content__details__episode_number,
state__content__details__season_number,
state__content__details__genres,
state__content__programmer__linear__channel_name,
visit__device__browser__name,
visit__device__browser__user_agent,
visit__device__browser__version,
state__content__identifiers__tms_program_id,
visit__account__enc_account_billing_id,
visit__account__enc_account_billing_division,
visit__account__enc_account_billing_division_id,
visit__location__enc_city,
visit__location__state,
visit__location__enc_zip_code,
visit__application_details__app_version,
state__content__content_class,
CONCAT(
visit__account__enc_account_billing_division_id ,
visit__account__enc_account_billing_division ,
visit__account__enc_account_billing_id
),
IF(LOWER(visit__application_details__application_name) IN('oneapp','specu','bulkmdu'), 'IPTV',  LOWER(visit__application_details__application_name)),
LOWER(visit__application_details__application_name),
visit__login__logged_in,
visit__device__operating_system,
visit__device__device_form_factor,
visit__account__details__billing_status,
visit__account__details__auto_pay_status,
visit__account__enc_account_number,
visit__activated_experiments,
visit__application_details__technology_type,
epoch_converter(received__timestamp, 'America/Denver')
;
