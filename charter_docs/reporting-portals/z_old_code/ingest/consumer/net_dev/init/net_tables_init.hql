USE ${env:ENVIRONMENT};

CREATE TABLE IF NOT EXISTS net_dev_raw_history
(
  accept_language String,
  browser String,
  browser_height Int,
  browser_width Int,
  campaign String,
  c_color String,
  channel String,
  click_action String,
  click_action_type Int,
  click_context String,
  click_context_type Int,
  click_sourceid Int,
  click_tag String,
  code_ver String,
  color Int,
  connection_type Int,
  cookies String,
  country Int,
  ct_connect_type String,
  currency String,
  curr_factor Int,
  curr_rate Double,
  cust_hit_time_gmt BigInt,
  cust_visid String,
  daily_visitor Int,
  date_time String,
  domain String,
  duplicated_from String,
  duplicate_events String,
  duplicate_purchase Int,
  evar1 String,
  evar2 String,
  evar3 String,
  evar4 String,
  evar5 String,
  evar6 String,
  evar7 String,
  evar8 String,
  evar9 String,
  evar10 String,
  evar11 String,
  evar12 String,
  evar13 String,
  evar14 String,
  evar15 String,
  evar16 String,
  evar17 String,
  evar18 String,
  evar19 String,
  evar20 String,
  evar21 String,
  evar22 String,
  evar23 String,
  evar24 String,
  evar25 String,
  evar26 String,
  evar27 String,
  evar28 String,
  evar29 String,
  evar30 String,
  evar31 String,
  evar32 String,
  evar33 String,
  evar34 String,
  evar35 String,
  evar36 String,
  evar37 String,
  evar38 String,
  evar39 String,
  evar40 String,
  evar41 String,
  evar42 String,
  evar43 String,
  evar44 String,
  evar45 String,
  evar46 String,
  evar47 String,
  evar48 String,
  evar49 String,
  evar50 String,
  evar51 String,
  evar52 String,
  evar53 String,
  evar54 String,
  evar55 String,
  evar56 String,
  evar57 String,
  evar58 String,
  evar59 String,
  evar60 String,
  evar61 String,
  evar62 String,
  evar63 String,
  evar64 String,
  evar65 String,
  evar66 String,
  evar67 String,
  evar68 String,
  evar69 String,
  evar70 String,
  evar71 String,
  evar72 String,
  evar73 String,
  evar74 String,
  evar75 String,
  event_list String,
  exclude_hit Int,
  first_hit_pagename String,
  first_hit_page_url String,
  first_hit_referrer String,
  first_hit_time_gmt BigInt,
  geo_city String,
  geo_country String,
  geo_dma Int,
  geo_region String,
  geo_zip String,
  hier1 String,
  hier2 String,
  hier3 String,
  hier4 String,
  hier5 String,
  hitid_high BigInt,
  hitid_low BigInt,
  hit_source Int,
  hit_time_gmt BigInt,
  homepage String,
  hourly_visitor Int,
  ip String,
  ip2 String,
  java_enabled String,
  javascript Int,
  j_jscript String,
  language Int,
  last_hit_time_gmt BigInt,
  last_purchase_num Int,
  last_purchase_time_gmt BigInt,
  mobile_id Int,
  monthly_visitor Int,
  mvvar1 String,
  mvvar2 String,
  mvvar3 String,
  namespace String,
  new_visit Int,
  os Int,
  page_event Int,
  page_event_var1 String,
  page_event_var2 String,
  page_event_var3 String,
  pagename String,
  page_type String,
  page_url String,
  paid_search Int,
  partner_plugins String,
  persistent_cookie String,
  plugins String,
  post_browser_height Int,
  post_browser_width Int,
  post_campaign String,
  post_channel String,
  post_cookies String,
  post_currency String,
  post_cust_hit_time_gmt BigInt,
  post_cust_visid Int,
  post_evar1 String,
  post_evar2 String,
  post_evar3 String,
  post_evar4 String,
  post_evar5 String,
  post_evar6 String,
  post_evar7 String,
  post_evar8 String,
  post_evar9 String,
  post_evar10 String,
  post_evar11 String,
  post_evar12 String,
  post_evar13 String,
  post_evar14 String,
  post_evar15 String,
  post_evar16 String,
  post_evar17 String,
  post_evar18 String,
  post_evar19 String,
  post_evar20 String,
  post_evar21 String,
  post_evar22 String,
  post_evar23 String,
  post_evar24 String,
  post_evar25 String,
  post_evar26 String,
  post_evar27 String,
  post_evar28 String,
  post_evar29 String,
  post_evar30 String,
  post_evar31 String,
  post_evar32 String,
  post_evar33 String,
  post_evar34 String,
  post_evar35 String,
  post_evar36 String,
  post_evar37 String,
  post_evar38 String,
  post_evar39 String,
  post_evar40 String,
  post_evar41 String,
  post_evar42 String,
  post_evar43 String,
  post_evar44 String,
  post_evar45 String,
  post_evar46 String,
  post_evar47 String,
  post_evar48 String,
  post_evar49 String,
  post_evar50 String,
  post_evar51 String,
  post_evar52 String,
  post_evar53 String,
  post_evar54 String,
  post_evar55 String,
  post_evar56 String,
  post_evar57 String,
  post_evar58 String,
  post_evar59 String,
  post_evar60 String,
  post_evar61 String,
  post_evar62 String,
  post_evar63 String,
  post_evar64 String,
  post_evar65 String,
  post_evar66 String,
  post_evar67 String,
  post_evar68 String,
  post_evar69 String,
  post_evar70 String,
  post_evar71 String,
  post_evar72 String,
  post_evar73 String,
  post_evar74 String,
  post_evar75 String,
  post_event_list String,
  post_hier1 String,
  post_hier2 String,
  post_hier3 String,
  post_hier4 String,
  post_hier5 String,
  post_java_enabled String,
  post_keywords String,
  post_mvvar1 String,
  post_mvvar2 String,
  post_mvvar3 String,
  post_page_event Int,
  post_page_event_var1 String,
  post_page_event_var2 String,
  post_page_event_var3 String,
  post_pagename String,
  post_pagename_no_url String,
  post_page_type String,
  post_page_url String,
  post_partner_plugins String,
  post_persistent_cookie String,
  post_product_list String,
  post_prop1 String,
  post_prop2 String,
  post_prop3 String,
  post_prop4 String,
  post_prop5 String,
  post_prop6 String,
  post_prop7 String,
  post_prop8 String,
  post_prop9 String,
  post_prop10 String,
  post_prop11 String,
  post_prop12 String,
  post_prop13 String,
  post_prop14 String,
  post_prop15 String,
  post_prop16 String,
  post_prop17 String,
  post_prop18 String,
  post_prop19 String,
  post_prop20 String,
  post_prop21 String,
  post_prop22 String,
  post_prop23 String,
  post_prop24 String,
  post_prop25 String,
  post_prop26 String,
  post_prop27 String,
  post_prop28 String,
  post_prop29 String,
  post_prop30 String,
  post_prop31 String,
  post_prop32 String,
  post_prop33 String,
  post_prop34 String,
  post_prop35 String,
  post_prop36 String,
  post_prop37 String,
  post_prop38 String,
  post_prop39 String,
  post_prop40 String,
  post_prop41 String,
  post_prop42 String,
  post_prop43 String,
  post_prop44 String,
  post_prop45 String,
  post_prop46 String,
  post_prop47 String,
  post_prop48 String,
  post_prop49 String,
  post_prop50 String,
  post_prop51 String,
  post_prop52 String,
  post_prop53 String,
  post_prop54 String,
  post_prop55 String,
  post_prop56 String,
  post_prop57 String,
  post_prop58 String,
  post_prop59 String,
  post_prop60 String,
  post_prop61 String,
  post_prop62 String,
  post_prop63 String,
  post_prop64 String,
  post_prop65 String,
  post_prop66 String,
  post_prop67 String,
  post_prop68 String,
  post_prop69 String,
  post_prop70 String,
  post_prop71 String,
  post_prop72 String,
  post_prop73 String,
  post_prop74 String,
  post_prop75 String,
  post_purchaseid String,
  post_referrer String,
  post_search_engine Int,
  post_state String,
  post_survey String,
  post_tnt String,
  post_transactionid String,
  post_t_time_info String,
  post_visid_high BigInt,
  post_visid_low BigInt,
  post_visid_type Int,
  post_zip String,
  p_plugins String,
  prev_page Int,
  product_list String,
  product_merchandising String,
  prop1 String,
  prop2 String,
  prop3 String,
  prop4 String,
  prop5 String,
  prop6 String,
  prop7 String,
  prop8 String,
  prop9 String,
  prop10 String,
  prop11 String,
  prop12 String,
  prop13 String,
  prop14 String,
  prop15 String,
  prop16 String,
  prop17 String,
  prop18 String,
  prop19 String,
  prop20 String,
  prop21 String,
  prop22 String,
  prop23 String,
  prop24 String,
  prop25 String,
  prop26 String,
  prop27 String,
  prop28 String,
  prop29 String,
  prop30 String,
  prop31 String,
  prop32 String,
  prop33 String,
  prop34 String,
  prop35 String,
  prop36 String,
  prop37 String,
  prop38 String,
  prop39 String,
  prop40 String,
  prop41 String,
  prop42 String,
  prop43 String,
  prop44 String,
  prop45 String,
  prop46 String,
  prop47 String,
  prop48 String,
  prop49 String,
  prop50 String,
  prop51 String,
  prop52 String,
  prop53 String,
  prop54 String,
  prop55 String,
  prop56 String,
  prop57 String,
  prop58 String,
  prop59 String,
  prop60 String,
  prop61 String,
  prop62 String,
  prop63 String,
  prop64 String,
  prop65 String,
  prop66 String,
  prop67 String,
  prop68 String,
  prop69 String,
  prop70 String,
  prop71 String,
  prop72 String,
  prop73 String,
  prop74 String,
  prop75 String,
  purchaseid String,
  quarterly_visitor Int,
  ref_domain String,
  referrer String,
  ref_type Int,
  resolution Int,
  sampled_hit String,
  search_engine Int,
  search_page_num Int,
  secondary_hit Int,
  service String,
  sourceid Int,
  s_resolution String,
  state String,
  stats_server String,
  tnt String,
  tnt_post_vista String,
  transactionid String,
  truncated_hit String,
  t_time_info String,
  ua_color String,
  ua_os String,
  ua_pixels String,
  user_agent String,
  user_hash Int,
  userid Int,
  username String,
  user_server String,
  va_closer_detail Int,
  va_closer_id String,
  va_finder_detail String,
  va_finder_id Int,
  va_instance_event Int,
  va_new_engagement Int,
  visid_high BigInt,
  visid_low BigInt,
  visid_new String,
  visid_timestamp BigInt,
  visid_type Int,
  visit_keywords String,
  visit_num Int,
  visit_page_num Int,
  visit_referrer String,
  visit_search_engine Int,
  visit_start_pagename String,
  visit_start_page_url String,
  visit_start_time_gmt BigInt,
  weekly_visitor Int,
  yearly_visitor Int,
  zip BigInt
)
PARTITIONED BY (partition_date_utc STRING)
STORED AS ORC  
TBLPROPERTIES ('ORC.COMPRESS'='SNAPPY', 'orc.row.index.stride'='40000')
;

CREATE TABLE IF NOT EXISTS ${env:TMP_db}.net_DEV_raw
( 
  accept_language String,
  browser String,
  browser_height Int,
  browser_width Int,
  campaign String,
  c_color String,
  channel String,
  click_action String,
  click_action_type Int,
  click_context String,
  click_context_type Int,
  click_sourceid Int,
  click_tag String,
  code_ver String,
  color Int,
  connection_type Int,
  cookies String,
  country Int,
  ct_connect_type String,
  currency String,
  curr_factor Int,
  curr_rate Double,
  cust_hit_time_gmt BigInt,
  cust_visid String,
  daily_visitor Int,
  date_time String,
  domain String,
  duplicated_from String,
  duplicate_events String,
  duplicate_purchase Int,
  evar1 String,
  evar2 String,
  evar3 String,
  evar4 String,
  evar5 String,
  evar6 String,
  evar7 String,
  evar8 String,
  evar9 String,
  evar10 String,
  evar11 String,
  evar12 String,
  evar13 String,
  evar14 String,
  evar15 String,
  evar16 String,
  evar17 String,
  evar18 String,
  evar19 String,
  evar20 String,
  evar21 String,
  evar22 String,
  evar23 String,
  evar24 String,
  evar25 String,
  evar26 String,
  evar27 String,
  evar28 String,
  evar29 String,
  evar30 String,
  evar31 String,
  evar32 String,
  evar33 String,
  evar34 String,
  evar35 String,
  evar36 String,
  evar37 String,
  evar38 String,
  evar39 String,
  evar40 String,
  evar41 String,
  evar42 String,
  evar43 String,
  evar44 String,
  evar45 String,
  evar46 String,
  evar47 String,
  evar48 String,
  evar49 String,
  evar50 String,
  evar51 String,
  evar52 String,
  evar53 String,
  evar54 String,
  evar55 String,
  evar56 String,
  evar57 String,
  evar58 String,
  evar59 String,
  evar60 String,
  evar61 String,
  evar62 String,
  evar63 String,
  evar64 String,
  evar65 String,
  evar66 String,
  evar67 String,
  evar68 String,
  evar69 String,
  evar70 String,
  evar71 String,
  evar72 String,
  evar73 String,
  evar74 String,
  evar75 String,
  event_list String,
  exclude_hit Int,
  first_hit_pagename String,
  first_hit_page_url String,
  first_hit_referrer String,
  first_hit_time_gmt BigInt,
  geo_city String,
  geo_country String,
  geo_dma Int,
  geo_region String,
  geo_zip String,
  hier1 String,
  hier2 String,
  hier3 String,
  hier4 String,
  hier5 String,
  hitid_high BigInt,
  hitid_low BigInt,
  hit_source Int,
  hit_time_gmt BigInt,
  homepage String,
  hourly_visitor Int,
  ip String,
  ip2 String,
  java_enabled String,
  javascript Int,
  j_jscript String,
  language Int,
  last_hit_time_gmt BigInt,
  last_purchase_num Int,
  last_purchase_time_gmt BigInt,
  mobile_id Int,
  monthly_visitor Int,
  mvvar1 String,
  mvvar2 String,
  mvvar3 String,
  namespace String,
  new_visit Int,
  os Int,
  page_event Int,
  page_event_var1 String,
  page_event_var2 String,
  page_event_var3 String,
  pagename String,
  page_type String,
  page_url String,
  paid_search Int,
  partner_plugins String,
  persistent_cookie String,
  plugins String,
  post_browser_height Int,
  post_browser_width Int,
  post_campaign String,
  post_channel String,
  post_cookies String,
  post_currency String,
  post_cust_hit_time_gmt BigInt,
  post_cust_visid Int,
  post_evar1 String,
  post_evar2 String,
  post_evar3 String,
  post_evar4 String,
  post_evar5 String,
  post_evar6 String,
  post_evar7 String,
  post_evar8 String,
  post_evar9 String,
  post_evar10 String,
  post_evar11 String,
  post_evar12 String,
  post_evar13 String,
  post_evar14 String,
  post_evar15 String,
  post_evar16 String,
  post_evar17 String,
  post_evar18 String,
  post_evar19 String,
  post_evar20 String,
  post_evar21 String,
  post_evar22 String,
  post_evar23 String,
  post_evar24 String,
  post_evar25 String,
  post_evar26 String,
  post_evar27 String,
  post_evar28 String,
  post_evar29 String,
  post_evar30 String,
  post_evar31 String,
  post_evar32 String,
  post_evar33 String,
  post_evar34 String,
  post_evar35 String,
  post_evar36 String,
  post_evar37 String,
  post_evar38 String,
  post_evar39 String,
  post_evar40 String,
  post_evar41 String,
  post_evar42 String,
  post_evar43 String,
  post_evar44 String,
  post_evar45 String,
  post_evar46 String,
  post_evar47 String,
  post_evar48 String,
  post_evar49 String,
  post_evar50 String,
  post_evar51 String,
  post_evar52 String,
  post_evar53 String,
  post_evar54 String,
  post_evar55 String,
  post_evar56 String,
  post_evar57 String,
  post_evar58 String,
  post_evar59 String,
  post_evar60 String,
  post_evar61 String,
  post_evar62 String,
  post_evar63 String,
  post_evar64 String,
  post_evar65 String,
  post_evar66 String,
  post_evar67 String,
  post_evar68 String,
  post_evar69 String,
  post_evar70 String,
  post_evar71 String,
  post_evar72 String,
  post_evar73 String,
  post_evar74 String,
  post_evar75 String,
  post_event_list String,
  post_hier1 String,
  post_hier2 String,
  post_hier3 String,
  post_hier4 String,
  post_hier5 String,
  post_java_enabled String,
  post_keywords String,
  post_mvvar1 String,
  post_mvvar2 String,
  post_mvvar3 String,
  post_page_event Int,
  post_page_event_var1 String,
  post_page_event_var2 String,
  post_page_event_var3 String,
  post_pagename String,
  post_pagename_no_url String,
  post_page_type String,
  post_page_url String,
  post_partner_plugins String,
  post_persistent_cookie String,
  post_product_list String,
  post_prop1 String,
  post_prop2 String,
  post_prop3 String,
  post_prop4 String,
  post_prop5 String,
  post_prop6 String,
  post_prop7 String,
  post_prop8 String,
  post_prop9 String,
  post_prop10 String,
  post_prop11 String,
  post_prop12 String,
  post_prop13 String,
  post_prop14 String,
  post_prop15 String,
  post_prop16 String,
  post_prop17 String,
  post_prop18 String,
  post_prop19 String,
  post_prop20 String,
  post_prop21 String,
  post_prop22 String,
  post_prop23 String,
  post_prop24 String,
  post_prop25 String,
  post_prop26 String,
  post_prop27 String,
  post_prop28 String,
  post_prop29 String,
  post_prop30 String,
  post_prop31 String,
  post_prop32 String,
  post_prop33 String,
  post_prop34 String,
  post_prop35 String,
  post_prop36 String,
  post_prop37 String,
  post_prop38 String,
  post_prop39 String,
  post_prop40 String,
  post_prop41 String,
  post_prop42 String,
  post_prop43 String,
  post_prop44 String,
  post_prop45 String,
  post_prop46 String,
  post_prop47 String,
  post_prop48 String,
  post_prop49 String,
  post_prop50 String,
  post_prop51 String,
  post_prop52 String,
  post_prop53 String,
  post_prop54 String,
  post_prop55 String,
  post_prop56 String,
  post_prop57 String,
  post_prop58 String,
  post_prop59 String,
  post_prop60 String,
  post_prop61 String,
  post_prop62 String,
  post_prop63 String,
  post_prop64 String,
  post_prop65 String,
  post_prop66 String,
  post_prop67 String,
  post_prop68 String,
  post_prop69 String,
  post_prop70 String,
  post_prop71 String,
  post_prop72 String,
  post_prop73 String,
  post_prop74 String,
  post_prop75 String,
  post_purchaseid String,
  post_referrer String,
  post_search_engine Int,
  post_state String,
  post_survey String,
  post_tnt String,
  post_transactionid String,
  post_t_time_info String,
  post_visid_high BigInt,
  post_visid_low BigInt,
  post_visid_type Int,
  post_zip String,
  p_plugins String,
  prev_page Int,
  product_list String,
  product_merchandising String,
  prop1 String,
  prop2 String,
  prop3 String,
  prop4 String,
  prop5 String,
  prop6 String,
  prop7 String,
  prop8 String,
  prop9 String,
  prop10 String,
  prop11 String,
  prop12 String,
  prop13 String,
  prop14 String,
  prop15 String,
  prop16 String,
  prop17 String,
  prop18 String,
  prop19 String,
  prop20 String,
  prop21 String,
  prop22 String,
  prop23 String,
  prop24 String,
  prop25 String,
  prop26 String,
  prop27 String,
  prop28 String,
  prop29 String,
  prop30 String,
  prop31 String,
  prop32 String,
  prop33 String,
  prop34 String,
  prop35 String,
  prop36 String,
  prop37 String,
  prop38 String,
  prop39 String,
  prop40 String,
  prop41 String,
  prop42 String,
  prop43 String,
  prop44 String,
  prop45 String,
  prop46 String,
  prop47 String,
  prop48 String,
  prop49 String,
  prop50 String,
  prop51 String,
  prop52 String,
  prop53 String,
  prop54 String,
  prop55 String,
  prop56 String,
  prop57 String,
  prop58 String,
  prop59 String,
  prop60 String,
  prop61 String,
  prop62 String,
  prop63 String,
  prop64 String,
  prop65 String,
  prop66 String,
  prop67 String,
  prop68 String,
  prop69 String,
  prop70 String,
  prop71 String,
  prop72 String,
  prop73 String,
  prop74 String,
  prop75 String,
  purchaseid String,
  quarterly_visitor Int,
  ref_domain String,
  referrer String,
  ref_type Int,
  resolution Int,
  sampled_hit String,
  search_engine Int,
  search_page_num Int,
  secondary_hit Int,
  service String,
  sourceid Int,
  s_resolution String,
  state String,
  stats_server String,
  tnt String,
  tnt_post_vista String,
  transactionid String,
  truncated_hit String,
  t_time_info String,
  ua_color String,
  ua_os String,
  ua_pixels String,
  user_agent String,
  user_hash Int,
  userid Int,
  username String,
  user_server String,
  va_closer_detail Int,
  va_closer_id String,
  va_finder_detail String,
  va_finder_id Int,
  va_instance_event Int,
  va_new_engagement Int,
  visid_high BigInt,
  visid_low BigInt,
  visid_new String,
  visid_timestamp BigInt,
  visid_type Int,
  visit_keywords String,
  visit_num Int,
  visit_page_num Int,
  visit_referrer String,
  visit_search_engine Int,
  visit_start_pagename String,
  visit_start_page_url String,
  visit_start_time_gmt BigInt,
  weekly_visitor Int,
  yearly_visitor Int,
  zip BigInt
)
row format delimited fields terminated by '\t'
lines terminated by '\n'
stored as textfile TBLPROPERTIES('serialization.null.format'='');

CREATE TABLE IF NOT EXISTS ${env:TMP_db}.net_DEV_denorm
(
  unique_id String,
  rank_id BigInt,
  accept_language String,
  browser String,
  browser_height Int,
  browser_width Int,
  campaign String,
  c_color String,
  channel String,
  click_action String,
  click_action_type Int,
  click_context String,
  click_context_type Int,
  click_sourceid Int,
  click_tag String,
  code_ver String,
  color Int,
  connection_type String,
  cookies String,
  country String,
  ct_connect_type String,
  currency String,
  curr_factor Int,
  curr_rate Double,
  cust_hit_time_gmt BigInt,
  cust_visid String,
  daily_visitor Int,
  date_time String,
  domain String,
  duplicated_from String,
  duplicate_events String,
  duplicate_purchase Int,
  event_list String,
  exclude_hit Int,
  first_hit_pagename String,
  first_hit_page_url String,
  first_hit_referrer String,
  first_hit_time_gmt BigInt,
  geo_city String,
  geo_country String,
  geo_dma Int,
  geo_region String,
  geo_zip String,
  hier1 String,
  hier2 String,
  hier3 String,
  hier4 String,
  hier5 String,
  hitid_high BigInt,
  hitid_low BigInt,
  hit_source Int,
  hit_time_gmt BigInt,
  homepage String,
  hourly_visitor Int,
  ip String,
  ip2 String,
  java_enabled String,
  javascript Int,
  j_jscript String,
  language Int,
  last_hit_time_gmt BigInt,
  last_purchase_num Int,
  last_purchase_time_gmt BigInt,
  mobile_id Int,
  monthly_visitor Int,
  mvvar1 String,
  mvvar2 String,
  mvvar3 String,
  namespace String,
  new_visit Int,
  os String,
  page_event Int,
  page_event_var1 String,
  page_event_var2 String,
  page_event_var3 String,
  pagename String,
  page_type String,
  page_url String,
  paid_search Int,
  partner_plugins String,
  persistent_cookie String,
  plugins String,
  post_browser_height Int,
  post_browser_width Int,
  post_campaign String,
  post_channel String,
  post_cookies String,
  post_currency String,
  post_cust_hit_time_gmt BigInt,
  post_cust_visid Int,
  post_evar1 String,
  post_evar2 String,
  post_evar3 String,
  post_evar4 String,
  post_evar5 String,
  post_evar6 String,
  post_evar7 String,
  post_evar8 String,
  post_evar9 String,
  post_evar10 String,
  post_evar11 String,
  post_evar12 String,
  post_evar13 String,
  post_evar14 String,
  post_evar15 String,
  post_evar16 String,
  post_evar17 String,
  post_evar18 String,
  post_evar19 String,
  post_evar20 String,
  post_evar21 String,
  post_evar22 String,
  post_evar23 String,
  post_evar24 String,
  post_evar25 String,
  post_evar26 String,
  post_evar27 String,
  post_evar28 String,
  post_evar29 String,
  post_evar30 String,
  post_evar31 String,
  post_evar32 String,
  post_evar33 String,
  post_evar34 String,
  post_evar35 String,
  post_evar36 String,
  post_evar37 String,
  post_evar38 String,
  post_evar39 String,
  post_evar40 String,
  post_evar41 String,
  post_evar42 String,
  post_evar43 String,
  post_evar44 String,
  post_evar45 String,
  post_evar46 String,
  post_evar47 String,
  post_evar48 String,
  post_evar49 String,
  post_evar50 String,
  post_evar51 String,
  post_evar52 String,
  post_evar53 String,
  post_evar54 String,
  post_evar55 String,
  post_evar56 String,
  post_evar57 String,
  post_evar58 String,
  post_evar59 String,
  post_evar60 String,
  post_evar61 String,
  post_evar62 String,
  post_evar63 String,
  post_evar64 String,
  post_evar65 String,
  post_evar66 String,
  post_evar67 String,
  post_evar68 String,
  post_evar69 String,
  post_evar70 String,
  post_evar71 String,
  post_evar72 String,
  post_evar73 String,
  post_evar74 String,
  post_evar75 String,
  post_event_list String,
  post_hier1 String,
  post_hier2 String,
  post_hier3 String,
  post_hier4 String,
  post_hier5 String,
  post_java_enabled String,
  post_keywords String,
  post_mvvar1 String,
  post_mvvar2 String,
  post_mvvar3 String,
  post_page_event Int,
  post_page_event_var1 String,
  post_page_event_var2 String,
  post_page_event_var3 String,
  post_pagename String,
  post_pagename_no_url String,
  post_page_type String,
  post_page_url String,
  post_partner_plugins String,
  post_persistent_cookie String,
  post_product_list String,
  post_prop1 String,
  post_prop2 String,
  post_prop3 String,
  post_prop4 String,
  post_prop5 String,
  post_prop6 String,
  post_prop7 String,
  post_prop8 String,
  post_prop9 String,
  post_prop10 String,
  post_prop11 String,
  post_prop12 String,
  post_prop13 String,
  post_prop14 String,
  post_prop15 String,
  post_prop16 String,
  post_prop17 String,
  post_prop18 String,
  post_prop19 String,
  post_prop20 String,
  post_prop21 String,
  post_prop22 String,
  post_prop23 String,
  post_prop24 String,
  post_prop25 String,
  post_prop26 String,
  post_prop27 String,
  post_prop28 String,
  post_prop29 String,
  post_prop30 String,
  post_prop31 String,
  post_prop32 String,
  post_prop33 String,
  post_prop34 String,
  post_prop35 String,
  post_prop36 String,
  post_prop37 String,
  post_prop38 String,
  post_prop39 String,
  post_prop40 String,
  post_prop41 String,
  post_prop42 String,
  post_prop43 String,
  post_prop44 String,
  post_prop45 String,
  post_prop46 String,
  post_prop47 String,
  post_prop48 String,
  post_prop49 String,
  post_prop50 String,
  post_prop51 String,
  post_prop52 String,
  post_prop53 String,
  post_prop54 String,
  post_prop55 String,
  post_prop56 String,
  post_prop57 String,
  post_prop58 String,
  post_prop59 String,
  post_prop60 String,
  post_prop61 String,
  post_prop62 String,
  post_prop63 String,
  post_prop64 String,
  post_prop65 String,
  post_prop66 String,
  post_prop67 String,
  post_prop68 String,
  post_prop69 String,
  post_prop70 String,
  post_prop71 String,
  post_prop72 String,
  post_prop73 String,
  post_prop74 String,
  post_prop75 String,
  post_purchaseid String,
  post_referrer String,
  post_search_engine Int,
  post_state String,
  post_survey String,
  post_tnt String,
  post_transactionid String,
  post_t_time_info String,
  post_visid_high BigInt,
  post_visid_low BigInt,
  post_visid_type Int,
  post_zip String,
  p_plugins String,
  prev_page Int,
  product_list String,
  product_merchandising String,
  purchaseid String,
  quarterly_visitor Int,
  ref_domain String,
  referrer String,
  ref_type Int,
  resolution String,
  sampled_hit String,
  search_engine Int,
  search_page_num Int,
  secondary_hit Int,
  service String,
  sourceid Int,
  s_resolution String,
  state String,
  stats_server String,
  tnt String,
  tnt_post_vista String,
  transactionid String,
  truncated_hit String,
  t_time_info String,
  ua_color String,
  ua_os String,
  ua_pixels String,
  user_agent String,
  user_hash Int,
  userid Int,
  username String,
  user_server String,
  va_closer_detail Int,
  va_closer_id String,
  va_finder_detail String,
  va_finder_id Int,
  va_instance_event Int,
  va_new_engagement Int,
  visid_high BigInt,
  visid_low BigInt,
  visid_new String,
  visid_timestamp BigInt,
  visid_type Int,
  visit_keywords String,
  visit_num Int,
  visit_page_num Int,
  visit_referrer String,
  visit_search_engine Int,
  visit_start_pagename String,
  visit_start_page_url String,
  visit_start_time_gmt BigInt,
  weekly_visitor Int,
  yearly_visitor Int,
  zip BigInt
)
row format delimited fields terminated by '\t'
lines terminated by '\n'
stored as textfile TBLPROPERTIES('serialization.null.format'='');

CREATE TABLE IF NOT EXISTS ${env:TMP_db}.net_DEV_calc
(
  unique_id String,
  visit_id String,
  previous_visit_id String,
  page_sub_section String,
  sequence_number Int,
  visit_failed_attempts Int,
  visit_login_duration Double,
  visit_start_timestamp Bigint,
  message_name String
  
)
row format delimited fields terminated by '\t'
lines terminated by '\n'
stored as textfile TBLPROPERTIES('serialization.null.format'='');

CREATE TABLE IF NOT EXISTS ${env:TMP_db}.net_DEV_events_no_part
(
  domain STRING,
  customer STRING,
  received_timestamp BIGINT,
  unfinished_created_timestamp BIGINT,
  finished_created_timestamp BIGINT,
  visit__visit_id STRING,
  visit__previous_visit_id STRING,
  visit__visit_start_timestamp BIGINT,
  visit__visit_startup_time INT,
  visit__referrer_link STRING,
  visit__device__type STRING,
  visit__device__model STRING, 
  visit__device__operating_system STRING,
  visit__device__enc_uuid STRING,
  visit__device__available_storage STRING,
  visit__device__browser__name STRING,
  visit__device__browser__version STRING,
  visit__device__linked_device__dvr_capable BOOLEAN,
  visit__device__linked_device__name STRING,
  visit__device__enc_linked_device__id STRING,
  visit__login__failed_attempts INT,
  visit__login__login_duration DOUBLE,
  visit__login__login_completed_timestamp BIGINT,
  visit__video_zone__details MAP<STRING, STRING>,
  visit__isp__enc_ip_address STRING,
  visit__isp__location_id STRING,
  visit__isp__organization STRING,
  visit__isp__isp STRING,
  visit__isp__status STRING,
  visit__connection__type STRING,
  visit__connection__network_status STRING,
  visit__connection__online BOOLEAN,
  visit__connection__speed_test__output STRING,
  visit__connection__speed_test__start_time BIGINT,
  visit__connection__speed_test__end_time BIGINT,
  visit__account__id STRING,
  visit__account__enc_account_number STRING,
  visit__account__address__address_type STRING,
  visit__account__address__city STRING,
  visit__account__address__state STRING,
  visit__account__address__zip_code STRING,
  visit__account__details MAP<STRING, STRING>,
  visit__account__subscription__service_level STRING,
  visit__account__status STRING,
  visit__user__enc_id STRING,
  visit__user__role STRING,
  visit__user__is_test_user BOOLEAN,
  visit__user__details MAP<STRING, STRING>,
  visit__user__status STRING,
  visit__location__country_code STRING,
  visit__location__country_name STRING,
  visit__location__region STRING,
  visit__location__region_name STRING,
  visit__location__enc_city STRING,
  visit__location__state STRING,
  visit__location__enc_zip_code STRING,
  visit__location__enc_latitude STRING,
  visit__location__enc_longitude STRING,
  visit__location__metro_code STRING,
  visit__location__timezone STRING,
  visit__location__status STRING,
  visit__app_version STRING,
  visit__library_version STRING,
  visit__app_name STRING,
  visit__environment STRING,
  visit__resolution STRING,
  visit__settings MAP<STRING, STRING>,
  application__error__type STRING,
  application__error__code STRING,
  application__error__details STRING,
  application__api__response_code STRING,
  application__api__response_text STRING,
  application__api__timeout BOOLEAN,
  application__api__response_time_in_ms BIGINT,
  application__api__host STRING,
  application__api__api_name STRING,
  application__api__http_verb STRING,
  application__api__query_parameters STRING,
  message__category STRING,
  message__name STRING,
  message__sequence_number INT,
  message__timestamp BIGINT,
  message__initiated_by STRING,
  message__feature__name STRING,
  message__feature__current_step INT,
  message__feature__number_of_steps INT,
  state__name STRING,
  state__entry_timestamp BIGINT,
  state__entry_content_position INT,
  state__current_content_position INT,
  state__previous_state__name STRING,
  state__previous_state__entry_timestamp BIGINT,
  state__previous_state__entry_content_position INT,
  state__previous_state__exit_timestamp BIGINT,
  state__previous_state__exit_content_position INT,
  state__playback__playback_started_timestamp BIGINT,
  state__playback__tune_timestamp BIGINT,
  state__playback__heart_beat__time_elapsed_in_seconds INT,
  state__playback__heart_beat__content_elapsed_in_seconds INT,
  state__playback__bit_rate__current_bit_rate DOUBLE,
  state__playback__bit_rate__content_elapsed_at_current_bit_rate DOUBLE,
  state__playback__bit_rate__previous_bit_rate DOUBLE,
  state__playback__bit_rate__content_elapsed_at_previous_bit_rate DOUBLE,
  state__playback__trick_play__scrub_speed STRING,
  state__playback__trick_play__scrub_type STRING,
  state__playback__trick_play__scrub_start_position INT,
  state__playback__trick_play__scrub_end_position INT,
  state__content__stream__content_uri STRING,
  state__content__stream__type STRING,
  state__content__stream__content_format STRING,
  state__content__stream__drm_type STRING,
  state__content__stream__scrubbing_capability STRING,
  state__content__stream__closed_captioning_capable BOOLEAN,
  state__content__stream__bookmark_position INT,
  state__content__stream__entitled BOOLEAN,
  state__content__stream__parentally_blocked BOOLEAN,
  state__content__stream__favorited BOOLEAN,
  state__content__stream__view_id STRING,
  state__content__stream__price STRING,
  state__content__stream__license_type STRING,
  state__content__stream__start_timestamp BIGINT,
  state__content__stream__end_timestamp BIGINT,
  state__content__identifiers__id STRING,
  state__content__identifiers__id_type STRING,
  state__content__identifiers__series_id_type STRING,
  state__content__identifiers__series_id STRING,
  state__content__identifiers__recording_timestamp BIGINT,
  state__content__details__type STRING,
  state__content__details__title STRING,
  state__content__details__episode_number STRING,
  state__content__details__season_number STRING,
  state__content__details__available_date BIGINT,
  state__content__details__closed_captioned BOOLEAN,
  state__content__details__long_form BOOLEAN,
  state__content__details__runtime BIGINT,
  state__content__details__expiration_date BIGINT,
  state__content__details__original_air_date BIGINT,
  state__content__details__original_network_name STRING,
  state__content__details__rating STRING,
  state__content__details__description STRING,
  state__content__details__year STRING,
  state__content__details__episode_title STRING,
  state__content__details__hd BOOLEAN,
  state__content__details__actors ARRAY<STRING>,
  state__content__details__genres ARRAY<STRING>,
  state__content__programmer__callsign STRING,
  state__content__programmer__id STRING,
  state__content__programmer__vod__provider_id STRING,
  state__content__programmer__vod__provider_name STRING,
  state__content__programmer__vod__product STRING,
  state__content__programmer__linear__channel_name STRING,
  state__content__programmer__linear__network_name STRING,
  state__content__programmer__linear__channel_category STRING,
  state__content__programmer__linear__channel_number STRING,
  state__ad__id STRING,
  state__ad__title STRING,
  state__ad__number INT,
  state__ad__ad_start_timestamp BIGINT,
  state__ad__break_start_timestamp BIGINT,
  state__ad__break_start_position INT,
  state__ad__break_length_seconds INT,
  state__ad__break_number INT,
  state__ad__commodity_code STRING,
  state__ad__vast MAP<STRING, STRING>,
  state__ad__campaign STRING,
  state__view__current_page__name STRING,
  state__view__current_page__section STRING,
  state__view__current_page__sub_section STRING,
  state__view__current_page__page_id STRING,
  state__view__current_page__page_load_time INT,
  state__view__current_page__type STRING,
  state__view__current_page__display_type STRING,
  state__view__current_page__sort_and_filter__applied_sorts STRING,
  state__view__current_page__sort_and_filter__applied_filters STRING,
  state__view__current_page__search_text STRING,
  state__view__current_page__page_number STRING,
  state__view__current_page__elements__name STRING,
  state__view__current_page__elements__number_of_items INT,
  state__view__current_page__elements__type STRING,
  state__view__current_page__elements__parentally_blocked_items INT,
  state__view__current_page__elements__entitled_items INT,
  state__view__current_page__settings MAP<STRING, STRING>,
  state__view__previous_page__name STRING,
  state__view__previous_page__section STRING,
  state__view__previous_page__sub_section STRING,
  state__view__previous_page__page_id STRING,
  state__view__previous_page__page_load_time INT,
  state__view__modal__name STRING,
  state__view__modal__text STRING,
  state__view__modal__type STRING,
  state__view__modal__load_time INT,
  state__download__content_window BIGINT,
  state__download__quality STRING,
  state__download__watched BOOLEAN,
  operation__toggle_state BOOLEAN,
  operation__type STRING,
  operation__success BOOLEAN,
  operation__selected__index INT,
  operation__selected__view_element_name STRING,
  operation__user_entry__enc_text STRING,
  operation__user_entry__type STRING
)
row format delimited fields terminated by '\t'
lines terminated by '\n'
stored as orc TBLPROPERTIES('serialization.null.format'='');

CREATE TABLE IF NOT EXISTS net_dev_events
(
  domain STRING,
  customer STRING,
  received_timestamp BIGINT,
  unfinished_created_timestamp BIGINT,
  finished_created_timestamp BIGINT,
  visit__visit_id STRING,
  visit__previous_visit_id STRING,
  visit__visit_start_timestamp BIGINT,
  visit__visit_startup_time INT,
  visit__referrer_link STRING,
  visit__device__type STRING,
  visit__device__model STRING, 
  visit__device__operating_system STRING,
  visit__device__enc_uuid STRING,
  visit__device__available_storage STRING,
  visit__device__browser__name STRING,
  visit__device__browser__version STRING,
  visit__device__linked_device__dvr_capable BOOLEAN,
  visit__device__linked_device__name STRING,
  visit__device__enc_linked_device__id STRING,
  visit__login__failed_attempts INT,
  visit__login__login_duration DOUBLE,
  visit__login__login_completed_timestamp BIGINT,
  visit__video_zone__details MAP<STRING, STRING>,
  visit__isp__enc_ip_address STRING,
  visit__isp__location_id STRING,
  visit__isp__organization STRING,
  visit__isp__isp STRING,
  visit__isp__status STRING,
  visit__connection__type STRING,
  visit__connection__network_status STRING,
  visit__connection__online BOOLEAN,
  visit__connection__speed_test__output STRING,
  visit__connection__speed_test__start_time BIGINT,
  visit__connection__speed_test__end_time BIGINT,
  visit__account__id STRING,
  visit__account__enc_account_number STRING,
  visit__account__address__address_type STRING,
  visit__account__address__city STRING,
  visit__account__address__state STRING,
  visit__account__address__zip_code STRING,
  visit__account__details MAP<STRING, STRING>,
  visit__account__subscription__service_level STRING,
  visit__account__status STRING,
  visit__user__enc_id STRING,
  visit__user__role STRING,
  visit__user__is_test_user BOOLEAN,
  visit__user__details MAP<STRING, STRING>,
  visit__user__status STRING,
  visit__location__country_code STRING,
  visit__location__country_name STRING,
  visit__location__region STRING,
  visit__location__region_name STRING,
  visit__location__enc_city STRING,
  visit__location__state STRING,
  visit__location__enc_zip_code STRING,
  visit__location__enc_latitude STRING,
  visit__location__enc_longitude STRING,
  visit__location__metro_code STRING,
  visit__location__timezone STRING,
  visit__location__status STRING,
  visit__app_version STRING,
  visit__library_version STRING,
  visit__app_name STRING,
  visit__environment STRING,
  visit__resolution STRING,
  visit__settings MAP<STRING, STRING>,
  application__error__type STRING,
  application__error__code STRING,
  application__error__details STRING,
  application__api__response_code STRING,
  application__api__response_text STRING,
  application__api__timeout BOOLEAN,
  application__api__response_time_in_ms BIGINT,
  application__api__host STRING,
  application__api__api_name STRING,
  application__api__http_verb STRING,
  application__api__query_parameters STRING,
  message__category STRING,
  message__name STRING,
  message__sequence_number INT,
  message__timestamp BIGINT,
  message__initiated_by STRING,
  message__feature__name STRING,
  message__feature__current_step INT,
  message__feature__number_of_steps INT,
  state__name STRING,
  state__entry_timestamp BIGINT,
  state__entry_content_position INT,
  state__current_content_position INT,
  state__previous_state__name STRING,
  state__previous_state__entry_timestamp BIGINT,
  state__previous_state__entry_content_position INT,
  state__previous_state__exit_timestamp BIGINT,
  state__previous_state__exit_content_position INT,
  state__playback__playback_started_timestamp BIGINT,
  state__playback__tune_timestamp BIGINT,
  state__playback__heart_beat__time_elapsed_in_seconds INT,
  state__playback__heart_beat__content_elapsed_in_seconds INT,
  state__playback__bit_rate__current_bit_rate DOUBLE,
  state__playback__bit_rate__content_elapsed_at_current_bit_rate DOUBLE,
  state__playback__bit_rate__previous_bit_rate DOUBLE,
  state__playback__bit_rate__content_elapsed_at_previous_bit_rate DOUBLE,
  state__playback__trick_play__scrub_speed STRING,
  state__playback__trick_play__scrub_type STRING,
  state__playback__trick_play__scrub_start_position INT,
  state__playback__trick_play__scrub_end_position INT,
  state__content__stream__content_uri STRING,
  state__content__stream__type STRING,
  state__content__stream__content_format STRING,
  state__content__stream__drm_type STRING,
  state__content__stream__scrubbing_capability STRING,
  state__content__stream__closed_captioning_capable BOOLEAN,
  state__content__stream__bookmark_position INT,
  state__content__stream__entitled BOOLEAN,
  state__content__stream__parentally_blocked BOOLEAN,
  state__content__stream__favorited BOOLEAN,
  state__content__stream__view_id STRING,
  state__content__stream__price STRING,
  state__content__stream__license_type STRING,
  state__content__stream__start_timestamp BIGINT,
  state__content__stream__end_timestamp BIGINT,
  state__content__identifiers__id STRING,
  state__content__identifiers__id_type STRING,
  state__content__identifiers__series_id_type STRING,
  state__content__identifiers__series_id STRING,
  state__content__identifiers__recording_timestamp BIGINT,
  state__content__details__type STRING,
  state__content__details__title STRING,
  state__content__details__episode_number STRING,
  state__content__details__season_number STRING,
  state__content__details__available_date BIGINT,
  state__content__details__closed_captioned BOOLEAN,
  state__content__details__long_form BOOLEAN,
  state__content__details__runtime BIGINT,
  state__content__details__expiration_date BIGINT,
  state__content__details__original_air_date BIGINT,
  state__content__details__original_network_name STRING,
  state__content__details__rating STRING,
  state__content__details__description STRING,
  state__content__details__year STRING,
  state__content__details__episode_title STRING,
  state__content__details__hd BOOLEAN,
  state__content__details__actors ARRAY<STRING>,
  state__content__details__genres ARRAY<STRING>,
  state__content__programmer__callsign STRING,
  state__content__programmer__id STRING,
  state__content__programmer__vod__provider_id STRING,
  state__content__programmer__vod__provider_name STRING,
  state__content__programmer__vod__product STRING,
  state__content__programmer__linear__channel_name STRING,
  state__content__programmer__linear__network_name STRING,
  state__content__programmer__linear__channel_category STRING,
  state__content__programmer__linear__channel_number STRING,
  state__ad__id STRING,
  state__ad__title STRING,
  state__ad__number INT,
  state__ad__ad_start_timestamp BIGINT,
  state__ad__break_start_timestamp BIGINT,
  state__ad__break_start_position INT,
  state__ad__break_length_seconds INT,
  state__ad__break_number INT,
  state__ad__commodity_code STRING,
  state__ad__vast MAP<STRING, STRING>,
  state__ad__campaign STRING,
  state__view__current_page__name STRING,
  state__view__current_page__section STRING,
  state__view__current_page__sub_section STRING,
  state__view__current_page__page_id STRING,
  state__view__current_page__page_load_time INT,
  state__view__current_page__type STRING,
  state__view__current_page__display_type STRING,
  state__view__current_page__sort_and_filter__applied_sorts STRING,
  state__view__current_page__sort_and_filter__applied_filters STRING,
  state__view__current_page__search_text STRING,
  state__view__current_page__page_number STRING,
  state__view__current_page__elements__name STRING,
  state__view__current_page__elements__number_of_items INT,
  state__view__current_page__elements__type STRING,
  state__view__current_page__elements__parentally_blocked_items INT,
  state__view__current_page__elements__entitled_items INT,
  state__view__current_page__settings MAP<STRING, STRING>,
  state__view__previous_page__name STRING,
  state__view__previous_page__section STRING,
  state__view__previous_page__sub_section STRING,
  state__view__previous_page__page_id STRING,
  state__view__previous_page__page_load_time INT,
  state__view__modal__name STRING,
  state__view__modal__text STRING,
  state__view__modal__type STRING,
  state__view__modal__load_time INT,
  state__download__content_window BIGINT,
  state__download__quality STRING,
  state__download__watched BOOLEAN,
  operation__toggle_state BOOLEAN,
  operation__type STRING,
  operation__success BOOLEAN,
  operation__selected__index INT,
  operation__selected__view_element_name STRING,
  operation__user_entry__enc_text STRING,
  operation__user_entry__type STRING
)
PARTITIONED BY (partition_date_utc STRING)
STORED AS ORC  
TBLPROPERTIES ('ORC.COMPRESS'='SNAPPY', 'orc.row.index.stride'='40000')
;
