CREATE EXTERNAL TABLE IF NOT EXISTS ${db_name}.asp_asapp_convos_metadata_ingest (
    first_utterance_text STRING,
    company_id INT,
    issue_created_ts STRING,
    last_event_ts STRING,
    is_review_required STRING,
    session_id STRING,
    customer_id STRING,
    last_agent_id INT,
    company_name STRING,
    sentiment_valence STRING,
    app_version_asapp STRING,
    internal_session_id STRING,
    ended_resolved INT,
    last_srs_event_ts STRING,
    company_subdivision STRING,
    escalated_to_chat STRING,
    internal_session_type STRING,
    first_agent_id INT,
    trigger_link STRING,
    external_user_id STRING,
    first_rep_id INT,
    ended_auto INT,
    external_channel STRING,
    external_session_id STRING,
    ended_other INT,
    disposition_notes STRING,
    internal_user_identifier STRING,
    issue_queue_name STRING,
    device_type STRING,
    auth_state STRING,
    conversation_end_ts STRING,
    ended_unresolved INT,
    issue_id BIGINT,
    external_issue_id STRING,
    end_srs_selection STRING,
    external_session_type STRING,
    external_rep_id STRING,
    disposition_ts STRING,
    mid_issue_auth_ts STRING,
    external_agent_id STRING,
    auth_source STRING,
    disposition_event_type STRING,
    first_utterance_ts STRING,
    auth_external_user_type STRING,
    session_event_type STRING,
    external_user_type STRING,
    auth_external_user_id STRING,
    assigned_to_rep_time STRING,
    app_version_client STRING,
    session_metadata STRING,
    company_segments STRING,
    platform STRING,
    csat_rating FLOAT,
    deep_link_queue STRING,
    issue_queue_id STRING,
    ended_timeout INT,
    last_sequence_id SMALLINT,
    last_rep_id INT,
    termination_event_type STRING,
    internal_user_session_type STRING,
    session_type STRING,
    auth_external_token_id STRING,
    partition_date STRING,
    partition_hour STRING,
    last_event_hour string
)
PARTITIONED BY (last_event_date string)
STORED AS ORC
LOCATION '${s3_location}'
TBLPROPERTIES ("orc.compress"="SNAPPY");
