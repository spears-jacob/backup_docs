USE ${env:DASP_db};

set hive.auto.convert.join=false;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.optimize.sort.dynamic.partition=false;
set hive.support.concurrency=false;
set hive.tez.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
set orc.force.positional.evolution=true;
SET hive.merge.tezfiles=true;
set hive.merge.smallfiles.avgsize=2048000000;
set hive.merge.size.per.task=2048000000;

-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
--
-- accounts metrics
--
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

INSERT INTO ${env:TMP_db}.quantum_set_agg_portals_stage_accounts_${hiveconf:execid}_${hiveconf:stepid}
SELECT
  CASE WHEN (grouping_id & 65536) = 0 THEN mso ELSE 'All Companies' END AS mso,
  CASE WHEN (grouping_id & 32768) = 0 THEN application_type ELSE 'All Applications' END AS application_type,
  CASE WHEN (grouping_id & 16384) = 0 THEN device_type ELSE 'All Devices' END AS device_type,
  CASE WHEN (grouping_id & 8192) = 0 THEN connection_type ELSE 'All Connections' END AS connection_type,
  CASE WHEN (grouping_id & 4096) = 0 THEN network_status ELSE 'All Network Statuses' END AS network_status,
  CASE WHEN (grouping_id & 2048) = 0 THEN playback_type ELSE 'All Playback Types' END AS playback_type,
  CASE WHEN (grouping_id & 1024) = 0 THEN cust_type ELSE 'All Customer Types' END AS cust_type,
  CASE WHEN (grouping_id & 512) = 0 THEN application_group_type ELSE 'All Application Group Types' END AS application_group_type,
  CASE WHEN (grouping_id & 256) = 0 THEN app_version ELSE 'All App Versions' END AS app_version,
  grouping_id,
  metric_name,
  metric_value,
  CASE WHEN (grouping_id & 128) = 0 THEN logged_in_status ELSE 'All Logged In Statuses' END AS logged_in_status,
  CASE WHEN (grouping_id & 64) = 0 THEN application_name ELSE 'All App Versions' END AS application_name,
  CASE WHEN (grouping_id & 32) = 0 THEN os_name ELSE 'All OS Names' END AS os_name,
  CASE WHEN (grouping_id & 16) = 0 THEN os_version ELSE 'All OS Versions' END AS os_version,
  CASE WHEN (grouping_id & 8) = 0 THEN browser_name ELSE 'All Browser Names' END AS browser_name,
  CASE WHEN (grouping_id & 4) = 0 THEN browser_version ELSE 'All Browser Versions' END AS browser_version,
  CASE WHEN (grouping_id & 2) = 0 THEN form_factor ELSE 'All Form Factors' END AS form_factor,
  '${hiveconf:ProcessTimestamp}' as process_date_time_denver,
  '${hiveconf:ProcessUser}' AS process_identity,
  unit_type,
  IF('accounts'='visits',cast(metric_calls as string),cast(NULL as string)) as call_count_24h,
  label_date_denver,
  '${hiveconf:grain}' AS grain
FROM
  (
  SELECT
    '${hiveconf:label_date_denver}' AS label_date_denver,
    mso,
    application_type,
    device_type,
    connection_type,
    network_status,
    playback_type,
    cust_type,
    application_group_type,
    app_version,
    logged_in_status,
    application_name,
    os_name,
    os_version,
    browser_name,
    browser_version,
    unit_type,
    form_factor,
    grouping_id,
      MAP(

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
     'portals_access_voice_platform_via_tile', SUM(portals_access_voice_platform_via_tile),
     'portals_account_billing_support_views', SUM(portals_account_billing_support_views),
     'portals_account_settings_click_install_wifi_profile', SUM(portals_account_settings_click_install_wifi_profile),
     'portals_account_settings_click_manage_people', SUM(portals_account_settings_click_manage_people),
     'portals_account_settings_click_save_contact_info', SUM(portals_account_settings_click_save_contact_info),
     'portals_account_settings_home_page_views', SUM(portals_account_settings_home_page_views),
     'portals_account_settings_manage_contact_info_page_views', SUM(portals_account_settings_manage_contact_info_page_views),
     'portals_account_settings_manage_people_page_views', SUM(portals_account_settings_manage_people_page_views),
     'portals_account_settings_your_info_tab_views', SUM(portals_account_settings_your_info_tab_views),
     'portals_all_equipment_reset_flow_failures', SUM(portals_all_equipment_reset_flow_failures),
     'portals_all_equipment_reset_flow_starts', SUM(portals_all_equipment_reset_flow_starts),
     'portals_all_equipment_reset_flow_successes', SUM(portals_all_equipment_reset_flow_successes),
     'portals_asd_paperless_enroll', SUM(portals_asd_paperless_enroll),
     'portals_auth_homepage_page_views', SUM(portals_auth_homepage_page_views),
     'portals_bill_delivery_pref_exit', SUM(portals_bill_delivery_pref_exit),
     'portals_bill_delivery_pref_keep_paperless', SUM(portals_bill_delivery_pref_keep_paperless),
     'portals_bill_delivery_pref_manage_paperless', SUM(portals_bill_delivery_pref_manage_paperless),
     'portals_bill_delivery_pref_paper', SUM(portals_bill_delivery_pref_paper),
     'portals_bill_delivery_pref_paper_failure', SUM(portals_bill_delivery_pref_paper_failure),
     'portals_bill_delivery_pref_paper_success', SUM(portals_bill_delivery_pref_paper_success),
     'portals_bill_delivery_pref_paperless_enroll_from_homepage', SUM(portals_bill_delivery_pref_paperless_enroll_from_homepage),
     'portals_bill_delivery_pref_paperless_failure', SUM(portals_bill_delivery_pref_paperless_failure),
     'portals_bill_delivery_pref_paperless_submit', SUM(portals_bill_delivery_pref_paperless_submit),
     'portals_bill_delivery_pref_paperless_submit_from_billinghome', SUM(portals_bill_delivery_pref_paperless_submit_from_billinghome),
     'portals_bill_delivery_pref_paperless_submit_from_homepage', SUM(portals_bill_delivery_pref_paperless_submit_from_homepage),
     'portals_bill_delivery_pref_paperless_success', SUM(portals_bill_delivery_pref_paperless_success),
     'portals_billing_feature_interaction', SUM(portals_billing_feature_interaction),
     'portals_billing_feature_page_view', SUM(portals_billing_feature_page_view),
     'portals_biometrics_fingerprint_enroll', SUM(portals_biometrics_fingerprint_enroll),
     'portals_call_support', SUM(portals_call_support),
     'portals_cancel_pause_device', SUM(portals_cancel_pause_device),
     'portals_cancel_tutorial_equip_page_three', SUM(portals_cancel_tutorial_equip_page_three),
     'portals_cancel_tutorial_otp_page_two', SUM(portals_cancel_tutorial_otp_page_two),
     'portals_cancel_tutorial_start_page_one', SUM(portals_cancel_tutorial_start_page_one),
     'portals_cancel_unpause_device', SUM(portals_cancel_unpause_device),
     'portals_cancelled_service_appointment_start', SUM(portals_cancelled_service_appointment_start),
     'portals_cancelled_service_appointments', SUM(portals_cancelled_service_appointments),
     'portals_confirm_remove_device', SUM(portals_confirm_remove_device),
     'portals_contact_us_page_views', SUM(portals_contact_us_page_views),
     'portals_csat_campaign_dismiss', SUM(portals_csat_campaign_dismiss),
     'portals_csat_campaign_interaction', SUM(portals_csat_campaign_interaction),
     'portals_csat_submit_feedback_cancel_written_feedback', SUM(portals_csat_submit_feedback_cancel_written_feedback),
     'portals_csat_submit_rating_1_very_dissatisfied', SUM(portals_csat_submit_rating_1_very_dissatisfied),
     'portals_csat_submit_rating_2_dissatisfied', SUM(portals_csat_submit_rating_2_dissatisfied),
     'portals_csat_submit_rating_3_neutral', SUM(portals_csat_submit_rating_3_neutral),
     'portals_csat_submit_rating_4_satisfied', SUM(portals_csat_submit_rating_4_satisfied),
     'portals_csat_submit_rating_5_very_satisfied', SUM(portals_csat_submit_rating_5_very_satisfied),
     'portals_csat_submit_rating_all', SUM(portals_csat_submit_rating_all),
     'portals_csat_submit_written_feedback', SUM(portals_csat_submit_written_feedback),
     'portals_download_wifi_profile_button_click', SUM(portals_download_wifi_profile_button_click),
     'portals_download_wifi_profile_button_click_android', SUM(portals_download_wifi_profile_button_click_android),
     'portals_download_wifi_profile_button_click_ios', SUM(portals_download_wifi_profile_button_click_ios),
     'portals_download_wifi_profile_success', SUM(portals_download_wifi_profile_success),
     'portals_download_wifi_profile_success_android', SUM(portals_download_wifi_profile_success_android),
     'portals_ed_my_internet_services', SUM(portals_ed_my_internet_services),
     'portals_ed_my_voice_services', SUM(portals_ed_my_voice_services),
     'portals_equipment_cancel_edit_ssid_select_action', SUM(portals_equipment_cancel_edit_ssid_select_action),
     'portals_equipment_confirm_edit_ssid_select_action', SUM(portals_equipment_confirm_edit_ssid_select_action),
     'portals_equipment_detail_views', SUM(portals_equipment_detail_views),
     'portals_equipment_edit_ssid_select_action', SUM(portals_equipment_edit_ssid_select_action),
     'portals_equipment_feature_interaction', SUM(portals_equipment_feature_interaction),
     'portals_equipment_list_view', SUM(portals_equipment_list_view),
     'portals_equipment_reset_flow_submit_all', SUM(portals_equipment_reset_flow_submit_all),
     'portals_footer_getsupport_acct_support', SUM(portals_footer_getsupport_acct_support),
     'portals_footer_getsupport_support_home', SUM(portals_footer_getsupport_support_home),
     'portals_forgot_password_flow_start', SUM(portals_forgot_password_flow_start),
     'portals_forgot_password_success', SUM(portals_forgot_password_success),
     'portals_forgot_username_flow_start', SUM(portals_forgot_username_flow_start),
     'portals_forgot_username_success', SUM(portals_forgot_username_success),
     'portals_guided_tour_click_next', SUM(portals_guided_tour_click_next),
     'portals_guided_tour_exit', SUM(portals_guided_tour_exit),
     'portals_guided_tour_initiated_modal_view', SUM(portals_guided_tour_initiated_modal_view),
     'portals_guided_tour_one_of_three', SUM(portals_guided_tour_one_of_three),
     'portals_guided_tour_show_me_later', SUM(portals_guided_tour_show_me_later),
     'portals_guided_tour_three_of_three', SUM(portals_guided_tour_three_of_three),
     'portals_guided_tour_two_of_three', SUM(portals_guided_tour_two_of_three),
     'portals_install_wifi_profile_start', SUM(portals_install_wifi_profile_start),
     'portals_install_wifi_profile_success', SUM(portals_install_wifi_profile_success),
     'portals_internet_equipment_reset_flow_failures', SUM(portals_internet_equipment_reset_flow_failures),
     'portals_internet_equipment_reset_flow_starts', SUM(portals_internet_equipment_reset_flow_starts),
     'portals_internet_equipment_reset_flow_submit', SUM(portals_internet_equipment_reset_flow_submit),
     'portals_internet_equipment_reset_flow_successes', SUM(portals_internet_equipment_reset_flow_successes),
     'portals_internet_modem_reset_failures', SUM(portals_internet_modem_reset_failures),
     'portals_internet_modem_router_reset_starts', SUM(portals_internet_modem_router_reset_starts),
     'portals_internet_router_reset_failures', SUM(portals_internet_router_reset_failures),
     'portals_internet_router_reset_successes', SUM(portals_internet_router_reset_successes),
     'portals_internet_support_views', SUM(portals_internet_support_views),
     'portals_iva_opens', SUM(portals_iva_opens),
     'portals_localnav_billing', SUM(portals_localnav_billing),
     'portals_login_attempts', SUM(portals_login_attempts),
     'portals_login_failures', SUM(portals_login_failures),
     'portals_logout', SUM(portals_logout),
     'portals_manage_auto_payment_cancel', SUM(portals_manage_auto_payment_cancel),
     'portals_manage_auto_payment_starts', SUM(portals_manage_auto_payment_starts),
     'portals_manage_auto_payment_successes', SUM(portals_manage_auto_payment_successes),
     'portals_manual_reset_failures', SUM(portals_manual_reset_failures),
     'portals_manual_reset_starts', SUM(portals_manual_reset_starts),
     'portals_manual_reset_success', SUM(portals_manual_reset_success),
     'portals_msa_experience_feedback_click_submit_feedback', SUM(portals_msa_experience_feedback_click_submit_feedback),
     'portals_msa_experience_feedback_goal_accomplished', SUM(portals_msa_experience_feedback_goal_accomplished),
     'portals_msa_experience_feedback_goal_not_accomplished', SUM(portals_msa_experience_feedback_goal_not_accomplished),
     'portals_one_time_alert_clicked', SUM(portals_one_time_alert_clicked),
     'portals_one_time_page_alert_displayed', SUM(portals_one_time_page_alert_displayed),
     'portals_one_time_payment_amount', SUM(portals_one_time_payment_amount),
     'portals_one_time_payment_checking', SUM(portals_one_time_payment_checking),
     'portals_one_time_payment_checking_account', SUM(portals_one_time_payment_checking_account),
     'portals_one_time_payment_credit', SUM(portals_one_time_payment_credit),
     'portals_one_time_payment_credit_debit_card', SUM(portals_one_time_payment_credit_debit_card),
     'portals_one_time_payment_date', SUM(portals_one_time_payment_date),
     'portals_one_time_payment_date_other', SUM(portals_one_time_payment_date_other),
     'portals_one_time_payment_date_past_due', SUM(portals_one_time_payment_date_past_due),
     'portals_one_time_payment_date_today', SUM(portals_one_time_payment_date_today),
     'portals_one_time_payment_failures', SUM(portals_one_time_payment_failures),
     'portals_one_time_payment_savings', SUM(portals_one_time_payment_savings),
     'portals_one_time_payment_savings_account', SUM(portals_one_time_payment_savings_account),
     'portals_one_time_payment_select_amount', SUM(portals_one_time_payment_select_amount),
     'portals_one_time_payment_select_date', SUM(portals_one_time_payment_select_date),
     'portals_one_time_payment_select_payment_method', SUM(portals_one_time_payment_select_payment_method),
     'portals_one_time_payment_starts', SUM(portals_one_time_payment_starts),
     'portals_one_time_payment_submission_new_payment_method', SUM(portals_one_time_payment_submission_new_payment_method),
     'portals_one_time_payment_submission_new_payment_method_not_stored', SUM(portals_one_time_payment_submission_new_payment_method_not_stored),
     'portals_one_time_payment_submission_new_payment_method_stored', SUM(portals_one_time_payment_submission_new_payment_method_stored),
     'portals_one_time_payment_submission_previously_stored_payment_method', SUM(portals_one_time_payment_submission_previously_stored_payment_method),
     'portals_one_time_payment_submits', SUM(portals_one_time_payment_submits),
     'portals_one_time_payment_submits_with_ap', SUM(portals_one_time_payment_submits_with_ap),
     'portals_one_time_payment_submits_without_ap', SUM(portals_one_time_payment_submits_without_ap),
     'portals_one_time_payment_successes', SUM(portals_one_time_payment_successes),
     'portals_one_time_payment_successes_with_ap_enroll', SUM(portals_one_time_payment_successes_with_ap_enroll),
     'portals_one_time_payment_successes_without_ap_enroll', SUM(portals_one_time_payment_successes_without_ap_enroll),
     'portals_page_views', SUM(portals_page_views),
     'portals_paperless_radio_toggle', SUM(portals_paperless_radio_toggle),
     'portals_paperless_toggle', SUM(portals_paperless_toggle),
     'portals_rescheduled_service_appointment_start', SUM(portals_rescheduled_service_appointment_start),
     'portals_rescheduled_service_appointments', SUM(portals_rescheduled_service_appointments),
     'portals_router_advanced_settings_click_about_port_forward', SUM(portals_router_advanced_settings_click_about_port_forward),
     'portals_router_advanced_settings_click_add_port_assignment', SUM(portals_router_advanced_settings_click_add_port_assignment),
     'portals_router_advanced_settings_click_cancel_dns_change', SUM(portals_router_advanced_settings_click_cancel_dns_change),
     'portals_router_advanced_settings_click_cancel_port_assignment', SUM(portals_router_advanced_settings_click_cancel_port_assignment),
     'portals_router_advanced_settings_click_create_ip_reservation', SUM(portals_router_advanced_settings_click_create_ip_reservation),
     'portals_router_advanced_settings_click_delete_or_cancel_delete_port', SUM(portals_router_advanced_settings_click_delete_or_cancel_delete_port),
     'portals_router_advanced_settings_click_delete_port', SUM(portals_router_advanced_settings_click_delete_port),
     'portals_router_advanced_settings_click_dns', SUM(portals_router_advanced_settings_click_dns),
     'portals_router_advanced_settings_click_manage_dns', SUM(portals_router_advanced_settings_click_manage_dns),
     'portals_router_advanced_settings_click_manage_ip_reservations', SUM(portals_router_advanced_settings_click_manage_ip_reservations),
     'portals_router_advanced_settings_click_port_forward', SUM(portals_router_advanced_settings_click_port_forward),
     'portals_router_advanced_settings_click_reset_dns_default', SUM(portals_router_advanced_settings_click_reset_dns_default),
     'portals_router_advanced_settings_click_save_confirm_dns', SUM(portals_router_advanced_settings_click_save_confirm_dns),
     'portals_router_advanced_settings_click_spectrum_dns_default', SUM(portals_router_advanced_settings_click_spectrum_dns_default),
     'portals_router_advanced_settings_click_upnp', SUM(portals_router_advanced_settings_click_upnp),
     'portals_router_advanced_settings_click_use_existing_port', SUM(portals_router_advanced_settings_click_use_existing_port),
     'portals_router_advanced_settings_delete_port_assignment_via_swipe', SUM(portals_router_advanced_settings_delete_port_assignment_via_swipe),
     'portals_router_advanced_settings_port_unavailable_modal', SUM(portals_router_advanced_settings_port_unavailable_modal),
     'portals_router_advanced_settings_reserve_ip_toggle_off', SUM(portals_router_advanced_settings_reserve_ip_toggle_off),
     'portals_router_advanced_settings_reserve_ip_toggle_on', SUM(portals_router_advanced_settings_reserve_ip_toggle_on),
     'portals_router_advanced_settings_upnp_toggle_off', SUM(portals_router_advanced_settings_upnp_toggle_off),
     'portals_router_advanced_settings_upnp_toggle_on', SUM(portals_router_advanced_settings_upnp_toggle_on),
     'portals_save_edit_device_nickname', SUM(portals_save_edit_device_nickname),
     'portals_scp_click_cancel_pause_device', SUM(portals_scp_click_cancel_pause_device),
     'portals_scp_click_cancel_unpause_device', SUM(portals_scp_click_cancel_unpause_device),
     'portals_scp_click_not_connected_devices_tab', SUM(portals_scp_click_not_connected_devices_tab),
     'portals_scp_click_pause_device', SUM(portals_scp_click_pause_device),
     'portals_scp_click_paused_tab', SUM(portals_scp_click_paused_tab),
     'portals_scp_click_unpause_device', SUM(portals_scp_click_unpause_device),
     'portals_scp_final_confirm_create_pod_name_failure', SUM(portals_scp_final_confirm_create_pod_name_failure),
     'portals_scp_final_confirm_create_pod_name_success', SUM(portals_scp_final_confirm_create_pod_name_success),
     'portals_scp_final_confirm_device_nickname_change_failure', SUM(portals_scp_final_confirm_device_nickname_change_failure),
     'portals_scp_final_confirm_device_nickname_change_success', SUM(portals_scp_final_confirm_device_nickname_change_success),
     'portals_scp_final_confirm_device_type_and_nickname_change_failure', SUM(portals_scp_final_confirm_device_type_and_nickname_change_failure),
     'portals_scp_final_confirm_device_type_and_nickname_change_success', SUM(portals_scp_final_confirm_device_type_and_nickname_change_success),
     'portals_scp_final_confirm_device_type_icon_update_failure', SUM(portals_scp_final_confirm_device_type_icon_update_failure),
     'portals_scp_final_confirm_device_type_icon_update_success', SUM(portals_scp_final_confirm_device_type_icon_update_success),
     'portals_scp_final_confirm_edit_pod_name_failure', SUM(portals_scp_final_confirm_edit_pod_name_failure),
     'portals_scp_final_confirm_edit_pod_name_success', SUM(portals_scp_final_confirm_edit_pod_name_success),
     'portals_scp_final_confirm_pause_failure', SUM(portals_scp_final_confirm_pause_failure),
     'portals_scp_final_confirm_pause_success', SUM(portals_scp_final_confirm_pause_success),
     'portals_scp_final_confirm_refresh_pod_failure', SUM(portals_scp_final_confirm_refresh_pod_failure),
     'portals_scp_final_confirm_refresh_pod_success', SUM(portals_scp_final_confirm_refresh_pod_success),
     'portals_scp_final_confirm_remove_device_failure', SUM(portals_scp_final_confirm_remove_device_failure),
     'portals_scp_final_confirm_remove_device_success', SUM(portals_scp_final_confirm_remove_device_success),
     'portals_scp_final_confirm_unpause_failure', SUM(portals_scp_final_confirm_unpause_failure),
     'portals_scp_final_confirm_unpause_success', SUM(portals_scp_final_confirm_unpause_success),
     'portals_scp_list_of_pods_pv', SUM(portals_scp_list_of_pods_pv),
     'portals_scp_pod_details_pv', SUM(portals_scp_pod_details_pv),
     'portals_scp_remove_device_cancel', SUM(portals_scp_remove_device_cancel),
     'portals_scp_select_pod_from_list', SUM(portals_scp_select_pod_from_list),
     'portals_security_qa_campaign_interaction', SUM(portals_security_qa_campaign_interaction),
     'portals_security_qa_update_security_page_view', SUM(portals_security_qa_update_security_page_view),
     'portals_select_actions', SUM(portals_select_actions),
     'portals_set_up_auto_payment_failures', SUM(portals_set_up_auto_payment_failures),
     'portals_set_up_auto_payment_starts', SUM(portals_set_up_auto_payment_starts),
     'portals_set_up_auto_payment_submits', SUM(portals_set_up_auto_payment_submits),
     'portals_set_up_auto_payment_submits_plus_otp', SUM(portals_set_up_auto_payment_submits_plus_otp),
     'portals_set_up_auto_payment_successes', SUM(portals_set_up_auto_payment_successes),
     'portals_set_up_auto_payment_successes_with_payment', SUM(portals_set_up_auto_payment_successes_with_payment),
     'portals_set_up_auto_payment_successes_without_payment', SUM(portals_set_up_auto_payment_successes_without_payment),
     'portals_settings_sign_in_security_manage_select_action', SUM(portals_settings_sign_in_security_manage_select_action),
     'portals_settings_sign_in_security_subnav_people_select_action', SUM(portals_settings_sign_in_security_subnav_people_select_action),
     'portals_settings_verify_select_action', SUM(portals_settings_verify_select_action),
     'portals_settings_your_info_changes_success', SUM(portals_settings_your_info_changes_success),
     'portals_settings_your_info_manage_select_action', SUM(portals_settings_your_info_manage_select_action),
     'portals_settings_your_info_save_select_action', SUM(portals_settings_your_info_save_select_action),
     'portals_settings_your_info_verify_identity_modal_view', SUM(portals_settings_your_info_verify_identity_modal_view),
     'portals_settings_your_info_verify_success', SUM(portals_settings_your_info_verify_success),
     'portals_site_unique', SUM(portals_site_unique),
     'portals_site_unique_auth', SUM(portals_site_unique_auth),
     'portals_site_unique_mobile', SUM(portals_site_unique_mobile),
     'portals_site_unique_pc', SUM(portals_site_unique_pc),
     'portals_start_pause_device', SUM(portals_start_pause_device),
     'portals_start_unpause_device', SUM(portals_start_unpause_device),
     'portals_support_article_select', SUM(portals_support_article_select),
     'portals_support_button', SUM(portals_support_button),
     'portals_support_page_views', SUM(portals_support_page_views),
     'portals_tech_tracker_auth_views', SUM(portals_tech_tracker_auth_views),
     'portals_tech_tracker_unauth_views', SUM(portals_tech_tracker_unauth_views),
     'portals_tutorial_account_page_five_page_view', SUM(portals_tutorial_account_page_five_page_view),
     'portals_tutorial_account_page_four_page_view', SUM(portals_tutorial_account_page_four_page_view),
     'portals_tutorial_equip_page_three_page_view', SUM(portals_tutorial_equip_page_three_page_view),
     'portals_tutorial_otp_page_two_page_view', SUM(portals_tutorial_otp_page_two_page_view),
     'portals_tutorial_start_page_one_page_view', SUM(portals_tutorial_start_page_one_page_view),
     'portals_tutorial_views', SUM(portals_tutorial_views),
     'portals_tv_equipment_reset_flow_failures', SUM(portals_tv_equipment_reset_flow_failures),
     'portals_tv_equipment_reset_flow_starts', SUM(portals_tv_equipment_reset_flow_starts),
     'portals_tv_equipment_reset_flow_submit', SUM(portals_tv_equipment_reset_flow_submit),
     'portals_tv_equipment_reset_flow_successes', SUM(portals_tv_equipment_reset_flow_successes),
     'portals_tv_modem_reset_failures', SUM(portals_tv_modem_reset_failures),
     'portals_tv_router_reset_failures', SUM(portals_tv_router_reset_failures),
     'portals_unauth_homepage_page_views', SUM(portals_unauth_homepage_page_views),
     'portals_update_missing_contact_campaign_interaction', SUM(portals_update_missing_contact_campaign_interaction),
     'portals_update_missing_contact_cancel_close_window', SUM(portals_update_missing_contact_cancel_close_window),
     'portals_update_missing_contact_save', SUM(portals_update_missing_contact_save),
     'portals_update_missing_contact_save_all', SUM(portals_update_missing_contact_save_all),
     'portals_update_missing_contact_save_and_continue', SUM(portals_update_missing_contact_save_and_continue),
     'portals_update_missing_contact_skip_this', SUM(portals_update_missing_contact_skip_this),
     'portals_update_missing_contact_update_all', SUM(portals_update_missing_contact_update_all),
     'portals_upgrade_links_overview', SUM(portals_upgrade_links_overview),
     'portals_upgrade_service_internet', SUM(portals_upgrade_service_internet),
     'portals_video_support_views', SUM(portals_video_support_views),
     'portals_view_connected_devices', SUM(portals_view_connected_devices),
     'portals_view_online_statments', SUM(portals_view_online_statments),
     'portals_voice_delete_messages', SUM(portals_voice_delete_messages),
     'portals_voice_equipment_reset_flow_failures', SUM(portals_voice_equipment_reset_flow_failures),
     'portals_voice_equipment_reset_flow_starts', SUM(portals_voice_equipment_reset_flow_starts),
     'portals_voice_equipment_reset_flow_submit', SUM(portals_voice_equipment_reset_flow_submit),
     'portals_voice_equipment_reset_flow_successes', SUM(portals_voice_equipment_reset_flow_successes),
     'portals_voice_modem_reset_failures', SUM(portals_voice_modem_reset_failures),
     'portals_voice_pageviews', SUM(portals_voice_pageviews),
     'portals_voice_play_messages', SUM(portals_voice_play_messages),
     'portals_voice_router_reset_failures', SUM(portals_voice_router_reset_failures),
     'portals_voice_support_views', SUM(portals_voice_support_views),
     'portals_voice_update_call_forward_settings', SUM(portals_voice_update_call_forward_settings),
     'portals_voice_view_messages', SUM(portals_voice_view_messages),
     'portals_voice_voicemail_view_select_action', SUM(portals_voice_voicemail_view_select_action),
     'portals_wifi_password_views', SUM(portals_wifi_password_views),
     'portals_wifi_pw_changes', SUM(portals_wifi_pw_changes)

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

) AS metric_map,

MAP(

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
     'portals_access_voice_platform_via_tile', SUM(portals_access_voice_platform_via_tile_calls),
     'portals_account_billing_support_views', SUM(portals_account_billing_support_views_calls),
     'portals_account_settings_click_install_wifi_profile', SUM(portals_account_settings_click_install_wifi_profile_calls),
     'portals_account_settings_click_manage_people', SUM(portals_account_settings_click_manage_people_calls),
     'portals_account_settings_click_save_contact_info', SUM(portals_account_settings_click_save_contact_info_calls),
     'portals_account_settings_home_page_views', SUM(portals_account_settings_home_page_views_calls),
     'portals_account_settings_manage_contact_info_page_views', SUM(portals_account_settings_manage_contact_info_page_views_calls),
     'portals_account_settings_manage_people_page_views', SUM(portals_account_settings_manage_people_page_views_calls),
     'portals_account_settings_your_info_tab_views', SUM(portals_account_settings_your_info_tab_views_calls),
     'portals_all_equipment_reset_flow_failures', SUM(portals_all_equipment_reset_flow_failures_calls),
     'portals_all_equipment_reset_flow_starts', SUM(portals_all_equipment_reset_flow_starts_calls),
     'portals_all_equipment_reset_flow_successes', SUM(portals_all_equipment_reset_flow_successes_calls),
     'portals_asd_paperless_enroll', SUM(portals_asd_paperless_enroll_calls),
     'portals_auth_homepage_page_views', SUM(portals_auth_homepage_page_views_calls),
     'portals_bill_delivery_pref_exit', SUM(portals_bill_delivery_pref_exit_calls),
     'portals_bill_delivery_pref_keep_paperless', SUM(portals_bill_delivery_pref_keep_paperless_calls),
     'portals_bill_delivery_pref_manage_paperless', SUM(portals_bill_delivery_pref_manage_paperless_calls),
     'portals_bill_delivery_pref_paper', SUM(portals_bill_delivery_pref_paper_calls),
     'portals_bill_delivery_pref_paper_failure', SUM(portals_bill_delivery_pref_paper_failure_calls),
     'portals_bill_delivery_pref_paper_success', SUM(portals_bill_delivery_pref_paper_success_calls),
     'portals_bill_delivery_pref_paperless_enroll_from_homepage', SUM(portals_bill_delivery_pref_paperless_enroll_from_homepage_calls),
     'portals_bill_delivery_pref_paperless_failure', SUM(portals_bill_delivery_pref_paperless_failure_calls),
     'portals_bill_delivery_pref_paperless_submit', SUM(portals_bill_delivery_pref_paperless_submit_calls),
     'portals_bill_delivery_pref_paperless_submit_from_billinghome', SUM(portals_bill_delivery_pref_paperless_submit_from_billinghome_calls),
     'portals_bill_delivery_pref_paperless_submit_from_homepage', SUM(portals_bill_delivery_pref_paperless_submit_from_homepage_calls),
     'portals_bill_delivery_pref_paperless_success', SUM(portals_bill_delivery_pref_paperless_success_calls),
     'portals_billing_feature_interaction', SUM(portals_billing_feature_interaction_calls),
     'portals_billing_feature_page_view', SUM(portals_billing_feature_page_view_calls),
     'portals_biometrics_fingerprint_enroll', SUM(portals_biometrics_fingerprint_enroll_calls),
     'portals_call_support', SUM(portals_call_support_calls),
     'portals_cancel_pause_device', SUM(portals_cancel_pause_device_calls),
     'portals_cancel_tutorial_equip_page_three', SUM(portals_cancel_tutorial_equip_page_three_calls),
     'portals_cancel_tutorial_otp_page_two', SUM(portals_cancel_tutorial_otp_page_two_calls),
     'portals_cancel_tutorial_start_page_one', SUM(portals_cancel_tutorial_start_page_one_calls),
     'portals_cancel_unpause_device', SUM(portals_cancel_unpause_device_calls),
     'portals_cancelled_service_appointment_start', SUM(portals_cancelled_service_appointment_start_calls),
     'portals_cancelled_service_appointments', SUM(portals_cancelled_service_appointments_calls),
     'portals_confirm_remove_device', SUM(portals_confirm_remove_device_calls),
     'portals_contact_us_page_views', SUM(portals_contact_us_page_views_calls),
     'portals_csat_campaign_dismiss', SUM(portals_csat_campaign_dismiss_calls),
     'portals_csat_campaign_interaction', SUM(portals_csat_campaign_interaction_calls),
     'portals_csat_submit_feedback_cancel_written_feedback', SUM(portals_csat_submit_feedback_cancel_written_feedback_calls),
     'portals_csat_submit_rating_1_very_dissatisfied', SUM(portals_csat_submit_rating_1_very_dissatisfied_calls),
     'portals_csat_submit_rating_2_dissatisfied', SUM(portals_csat_submit_rating_2_dissatisfied_calls),
     'portals_csat_submit_rating_3_neutral', SUM(portals_csat_submit_rating_3_neutral_calls),
     'portals_csat_submit_rating_4_satisfied', SUM(portals_csat_submit_rating_4_satisfied_calls),
     'portals_csat_submit_rating_5_very_satisfied', SUM(portals_csat_submit_rating_5_very_satisfied_calls),
     'portals_csat_submit_rating_all', SUM(portals_csat_submit_rating_all_calls),
     'portals_csat_submit_written_feedback', SUM(portals_csat_submit_written_feedback_calls),
     'portals_download_wifi_profile_button_click', SUM(portals_download_wifi_profile_button_click_calls),
     'portals_download_wifi_profile_button_click_android', SUM(portals_download_wifi_profile_button_click_android_calls),
     'portals_download_wifi_profile_button_click_ios', SUM(portals_download_wifi_profile_button_click_ios_calls),
     'portals_download_wifi_profile_success', SUM(portals_download_wifi_profile_success_calls),
     'portals_download_wifi_profile_success_android', SUM(portals_download_wifi_profile_success_android_calls),
     'portals_ed_my_internet_services', SUM(portals_ed_my_internet_services_calls),
     'portals_ed_my_voice_services', SUM(portals_ed_my_voice_services_calls),
     'portals_equipment_cancel_edit_ssid_select_action', SUM(portals_equipment_cancel_edit_ssid_select_action_calls),
     'portals_equipment_confirm_edit_ssid_select_action', SUM(portals_equipment_confirm_edit_ssid_select_action_calls),
     'portals_equipment_detail_views', SUM(portals_equipment_detail_views_calls),
     'portals_equipment_edit_ssid_select_action', SUM(portals_equipment_edit_ssid_select_action_calls),
     'portals_equipment_feature_interaction', SUM(portals_equipment_feature_interaction_calls),
     'portals_equipment_list_view', SUM(portals_equipment_list_view_calls),
     'portals_equipment_reset_flow_submit_all', SUM(portals_equipment_reset_flow_submit_all_calls),
     'portals_footer_getsupport_acct_support', SUM(portals_footer_getsupport_acct_support_calls),
     'portals_footer_getsupport_support_home', SUM(portals_footer_getsupport_support_home_calls),
     'portals_forgot_password_flow_start', SUM(portals_forgot_password_flow_start_calls),
     'portals_forgot_password_success', SUM(portals_forgot_password_success_calls),
     'portals_forgot_username_flow_start', SUM(portals_forgot_username_flow_start_calls),
     'portals_forgot_username_success', SUM(portals_forgot_username_success_calls),
     'portals_guided_tour_click_next', SUM(portals_guided_tour_click_next_calls),
     'portals_guided_tour_exit', SUM(portals_guided_tour_exit_calls),
     'portals_guided_tour_initiated_modal_view', SUM(portals_guided_tour_initiated_modal_view_calls),
     'portals_guided_tour_one_of_three', SUM(portals_guided_tour_one_of_three_calls),
     'portals_guided_tour_show_me_later', SUM(portals_guided_tour_show_me_later_calls),
     'portals_guided_tour_three_of_three', SUM(portals_guided_tour_three_of_three_calls),
     'portals_guided_tour_two_of_three', SUM(portals_guided_tour_two_of_three_calls),
     'portals_install_wifi_profile_start', SUM(portals_install_wifi_profile_start_calls),
     'portals_install_wifi_profile_success', SUM(portals_install_wifi_profile_success_calls),
     'portals_internet_equipment_reset_flow_failures', SUM(portals_internet_equipment_reset_flow_failures_calls),
     'portals_internet_equipment_reset_flow_starts', SUM(portals_internet_equipment_reset_flow_starts_calls),
     'portals_internet_equipment_reset_flow_submit', SUM(portals_internet_equipment_reset_flow_submit_calls),
     'portals_internet_equipment_reset_flow_successes', SUM(portals_internet_equipment_reset_flow_successes_calls),
     'portals_internet_modem_reset_failures', SUM(portals_internet_modem_reset_failures_calls),
     'portals_internet_modem_router_reset_starts', SUM(portals_internet_modem_router_reset_starts_calls),
     'portals_internet_router_reset_failures', SUM(portals_internet_router_reset_failures_calls),
     'portals_internet_router_reset_successes', SUM(portals_internet_router_reset_successes_calls),
     'portals_internet_support_views', SUM(portals_internet_support_views_calls),
     'portals_iva_opens', SUM(portals_iva_opens_calls),
     'portals_localnav_billing', SUM(portals_localnav_billing_calls),
     'portals_login_attempts', SUM(portals_login_attempts_calls),
     'portals_login_failures', SUM(portals_login_failures_calls),
     'portals_logout', SUM(portals_logout_calls),
     'portals_manage_auto_payment_cancel', SUM(portals_manage_auto_payment_cancel_calls),
     'portals_manage_auto_payment_starts', SUM(portals_manage_auto_payment_starts_calls),
     'portals_manage_auto_payment_successes', SUM(portals_manage_auto_payment_successes_calls),
     'portals_manual_reset_failures', SUM(portals_manual_reset_failures_calls),
     'portals_manual_reset_starts', SUM(portals_manual_reset_starts_calls),
     'portals_manual_reset_success', SUM(portals_manual_reset_success_calls),
     'portals_msa_experience_feedback_click_submit_feedback', SUM(portals_msa_experience_feedback_click_submit_feedback_calls),
     'portals_msa_experience_feedback_goal_accomplished', SUM(portals_msa_experience_feedback_goal_accomplished_calls),
     'portals_msa_experience_feedback_goal_not_accomplished', SUM(portals_msa_experience_feedback_goal_not_accomplished_calls),
     'portals_one_time_alert_clicked', SUM(portals_one_time_alert_clicked_calls),
     'portals_one_time_page_alert_displayed', SUM(portals_one_time_page_alert_displayed_calls),
     'portals_one_time_payment_amount', SUM(portals_one_time_payment_amount_calls),
     'portals_one_time_payment_checking', SUM(portals_one_time_payment_checking_calls),
     'portals_one_time_payment_checking_account', SUM(portals_one_time_payment_checking_account_calls),
     'portals_one_time_payment_credit', SUM(portals_one_time_payment_credit_calls),
     'portals_one_time_payment_credit_debit_card', SUM(portals_one_time_payment_credit_debit_card_calls),
     'portals_one_time_payment_date', SUM(portals_one_time_payment_date_calls),
     'portals_one_time_payment_date_other', SUM(portals_one_time_payment_date_other_calls),
     'portals_one_time_payment_date_past_due', SUM(portals_one_time_payment_date_past_due_calls),
     'portals_one_time_payment_date_today', SUM(portals_one_time_payment_date_today_calls),
     'portals_one_time_payment_failures', SUM(portals_one_time_payment_failures_calls),
     'portals_one_time_payment_savings', SUM(portals_one_time_payment_savings_calls),
     'portals_one_time_payment_savings_account', SUM(portals_one_time_payment_savings_account_calls),
     'portals_one_time_payment_select_amount', SUM(portals_one_time_payment_select_amount_calls),
     'portals_one_time_payment_select_date', SUM(portals_one_time_payment_select_date_calls),
     'portals_one_time_payment_select_payment_method', SUM(portals_one_time_payment_select_payment_method_calls),
     'portals_one_time_payment_starts', SUM(portals_one_time_payment_starts_calls),
     'portals_one_time_payment_submission_new_payment_method', SUM(portals_one_time_payment_submission_new_payment_method_calls),
     'portals_one_time_payment_submission_new_payment_method_not_stored', SUM(portals_one_time_payment_submission_new_payment_method_not_stored_calls),
     'portals_one_time_payment_submission_new_payment_method_stored', SUM(portals_one_time_payment_submission_new_payment_method_stored_calls),
     'portals_one_time_payment_submission_previously_stored_payment_method', SUM(portals_one_time_payment_submission_previously_stored_payment_method_calls),
     'portals_one_time_payment_submits', SUM(portals_one_time_payment_submits_calls),
     'portals_one_time_payment_submits_with_ap', SUM(portals_one_time_payment_submits_with_ap_calls),
     'portals_one_time_payment_submits_without_ap', SUM(portals_one_time_payment_submits_without_ap_calls),
     'portals_one_time_payment_successes', SUM(portals_one_time_payment_successes_calls),
     'portals_one_time_payment_successes_with_ap_enroll', SUM(portals_one_time_payment_successes_with_ap_enroll_calls),
     'portals_one_time_payment_successes_without_ap_enroll', SUM(portals_one_time_payment_successes_without_ap_enroll_calls),
     'portals_page_views', SUM(portals_page_views_calls),
     'portals_paperless_radio_toggle', SUM(portals_paperless_radio_toggle_calls),
     'portals_paperless_toggle', SUM(portals_paperless_toggle_calls),
     'portals_rescheduled_service_appointment_start', SUM(portals_rescheduled_service_appointment_start_calls),
     'portals_rescheduled_service_appointments', SUM(portals_rescheduled_service_appointments_calls),
     'portals_router_advanced_settings_click_about_port_forward', SUM(portals_router_advanced_settings_click_about_port_forward_calls),
     'portals_router_advanced_settings_click_add_port_assignment', SUM(portals_router_advanced_settings_click_add_port_assignment_calls),
     'portals_router_advanced_settings_click_cancel_dns_change', SUM(portals_router_advanced_settings_click_cancel_dns_change_calls),
     'portals_router_advanced_settings_click_cancel_port_assignment', SUM(portals_router_advanced_settings_click_cancel_port_assignment_calls),
     'portals_router_advanced_settings_click_create_ip_reservation', SUM(portals_router_advanced_settings_click_create_ip_reservation_calls),
     'portals_router_advanced_settings_click_delete_or_cancel_delete_port', SUM(portals_router_advanced_settings_click_delete_or_cancel_delete_port_calls),
     'portals_router_advanced_settings_click_delete_port', SUM(portals_router_advanced_settings_click_delete_port_calls),
     'portals_router_advanced_settings_click_dns', SUM(portals_router_advanced_settings_click_dns_calls),
     'portals_router_advanced_settings_click_manage_dns', SUM(portals_router_advanced_settings_click_manage_dns_calls),
     'portals_router_advanced_settings_click_manage_ip_reservations', SUM(portals_router_advanced_settings_click_manage_ip_reservations_calls),
     'portals_router_advanced_settings_click_port_forward', SUM(portals_router_advanced_settings_click_port_forward_calls),
     'portals_router_advanced_settings_click_reset_dns_default', SUM(portals_router_advanced_settings_click_reset_dns_default_calls),
     'portals_router_advanced_settings_click_save_confirm_dns', SUM(portals_router_advanced_settings_click_save_confirm_dns_calls),
     'portals_router_advanced_settings_click_spectrum_dns_default', SUM(portals_router_advanced_settings_click_spectrum_dns_default_calls),
     'portals_router_advanced_settings_click_upnp', SUM(portals_router_advanced_settings_click_upnp_calls),
     'portals_router_advanced_settings_click_use_existing_port', SUM(portals_router_advanced_settings_click_use_existing_port_calls),
     'portals_router_advanced_settings_delete_port_assignment_via_swipe', SUM(portals_router_advanced_settings_delete_port_assignment_via_swipe_calls),
     'portals_router_advanced_settings_port_unavailable_modal', SUM(portals_router_advanced_settings_port_unavailable_modal_calls),
     'portals_router_advanced_settings_reserve_ip_toggle_off', SUM(portals_router_advanced_settings_reserve_ip_toggle_off_calls),
     'portals_router_advanced_settings_reserve_ip_toggle_on', SUM(portals_router_advanced_settings_reserve_ip_toggle_on_calls),
     'portals_router_advanced_settings_upnp_toggle_off', SUM(portals_router_advanced_settings_upnp_toggle_off_calls),
     'portals_router_advanced_settings_upnp_toggle_on', SUM(portals_router_advanced_settings_upnp_toggle_on_calls),
     'portals_save_edit_device_nickname', SUM(portals_save_edit_device_nickname_calls),
     'portals_scp_click_cancel_pause_device', SUM(portals_scp_click_cancel_pause_device_calls),
     'portals_scp_click_cancel_unpause_device', SUM(portals_scp_click_cancel_unpause_device_calls),
     'portals_scp_click_not_connected_devices_tab', SUM(portals_scp_click_not_connected_devices_tab_calls),
     'portals_scp_click_pause_device', SUM(portals_scp_click_pause_device_calls),
     'portals_scp_click_paused_tab', SUM(portals_scp_click_paused_tab_calls),
     'portals_scp_click_unpause_device', SUM(portals_scp_click_unpause_device_calls),
     'portals_scp_final_confirm_create_pod_name_failure', SUM(portals_scp_final_confirm_create_pod_name_failure_calls),
     'portals_scp_final_confirm_create_pod_name_success', SUM(portals_scp_final_confirm_create_pod_name_success_calls),
     'portals_scp_final_confirm_device_nickname_change_failure', SUM(portals_scp_final_confirm_device_nickname_change_failure_calls),
     'portals_scp_final_confirm_device_nickname_change_success', SUM(portals_scp_final_confirm_device_nickname_change_success_calls),
     'portals_scp_final_confirm_device_type_and_nickname_change_failure', SUM(portals_scp_final_confirm_device_type_and_nickname_change_failure_calls),
     'portals_scp_final_confirm_device_type_and_nickname_change_success', SUM(portals_scp_final_confirm_device_type_and_nickname_change_success_calls),
     'portals_scp_final_confirm_device_type_icon_update_failure', SUM(portals_scp_final_confirm_device_type_icon_update_failure_calls),
     'portals_scp_final_confirm_device_type_icon_update_success', SUM(portals_scp_final_confirm_device_type_icon_update_success_calls),
     'portals_scp_final_confirm_edit_pod_name_failure', SUM(portals_scp_final_confirm_edit_pod_name_failure_calls),
     'portals_scp_final_confirm_edit_pod_name_success', SUM(portals_scp_final_confirm_edit_pod_name_success_calls),
     'portals_scp_final_confirm_pause_failure', SUM(portals_scp_final_confirm_pause_failure_calls),
     'portals_scp_final_confirm_pause_success', SUM(portals_scp_final_confirm_pause_success_calls),
     'portals_scp_final_confirm_refresh_pod_failure', SUM(portals_scp_final_confirm_refresh_pod_failure_calls),
     'portals_scp_final_confirm_refresh_pod_success', SUM(portals_scp_final_confirm_refresh_pod_success_calls),
     'portals_scp_final_confirm_remove_device_failure', SUM(portals_scp_final_confirm_remove_device_failure_calls),
     'portals_scp_final_confirm_remove_device_success', SUM(portals_scp_final_confirm_remove_device_success_calls),
     'portals_scp_final_confirm_unpause_failure', SUM(portals_scp_final_confirm_unpause_failure_calls),
     'portals_scp_final_confirm_unpause_success', SUM(portals_scp_final_confirm_unpause_success_calls),
     'portals_scp_list_of_pods_pv', SUM(portals_scp_list_of_pods_pv_calls),
     'portals_scp_pod_details_pv', SUM(portals_scp_pod_details_pv_calls),
     'portals_scp_remove_device_cancel', SUM(portals_scp_remove_device_cancel_calls),
     'portals_scp_select_pod_from_list', SUM(portals_scp_select_pod_from_list_calls),
     'portals_security_qa_campaign_interaction', SUM(portals_security_qa_campaign_interaction_calls),
     'portals_security_qa_update_security_page_view', SUM(portals_security_qa_update_security_page_view_calls),
     'portals_select_actions', SUM(portals_select_actions_calls),
     'portals_set_up_auto_payment_failures', SUM(portals_set_up_auto_payment_failures_calls),
     'portals_set_up_auto_payment_starts', SUM(portals_set_up_auto_payment_starts_calls),
     'portals_set_up_auto_payment_submits', SUM(portals_set_up_auto_payment_submits_calls),
     'portals_set_up_auto_payment_submits_plus_otp', SUM(portals_set_up_auto_payment_submits_plus_otp_calls),
     'portals_set_up_auto_payment_successes', SUM(portals_set_up_auto_payment_successes_calls),
     'portals_set_up_auto_payment_successes_with_payment', SUM(portals_set_up_auto_payment_successes_with_payment_calls),
     'portals_set_up_auto_payment_successes_without_payment', SUM(portals_set_up_auto_payment_successes_without_payment_calls),
     'portals_settings_sign_in_security_manage_select_action', SUM(portals_settings_sign_in_security_manage_select_action_calls),
     'portals_settings_sign_in_security_subnav_people_select_action', SUM(portals_settings_sign_in_security_subnav_people_select_action_calls),
     'portals_settings_verify_select_action', SUM(portals_settings_verify_select_action_calls),
     'portals_settings_your_info_changes_success', SUM(portals_settings_your_info_changes_success_calls),
     'portals_settings_your_info_manage_select_action', SUM(portals_settings_your_info_manage_select_action_calls),
     'portals_settings_your_info_save_select_action', SUM(portals_settings_your_info_save_select_action_calls),
     'portals_settings_your_info_verify_identity_modal_view', SUM(portals_settings_your_info_verify_identity_modal_view_calls),
     'portals_settings_your_info_verify_success', SUM(portals_settings_your_info_verify_success_calls),
     'portals_site_unique', SUM(portals_site_unique_calls),
     'portals_site_unique_auth', SUM(portals_site_unique_auth_calls),
     'portals_site_unique_mobile', SUM(portals_site_unique_mobile_calls),
     'portals_site_unique_pc', SUM(portals_site_unique_pc_calls),
     'portals_start_pause_device', SUM(portals_start_pause_device_calls),
     'portals_start_unpause_device', SUM(portals_start_unpause_device_calls),
     'portals_support_article_select', SUM(portals_support_article_select_calls),
     'portals_support_button', SUM(portals_support_button_calls),
     'portals_support_page_views', SUM(portals_support_page_views_calls),
     'portals_tech_tracker_auth_views', SUM(portals_tech_tracker_auth_views_calls),
     'portals_tech_tracker_unauth_views', SUM(portals_tech_tracker_unauth_views_calls),
     'portals_tutorial_account_page_five_page_view', SUM(portals_tutorial_account_page_five_page_view_calls),
     'portals_tutorial_account_page_four_page_view', SUM(portals_tutorial_account_page_four_page_view_calls),
     'portals_tutorial_equip_page_three_page_view', SUM(portals_tutorial_equip_page_three_page_view_calls),
     'portals_tutorial_otp_page_two_page_view', SUM(portals_tutorial_otp_page_two_page_view_calls),
     'portals_tutorial_start_page_one_page_view', SUM(portals_tutorial_start_page_one_page_view_calls),
     'portals_tutorial_views', SUM(portals_tutorial_views_calls),
     'portals_tv_equipment_reset_flow_failures', SUM(portals_tv_equipment_reset_flow_failures_calls),
     'portals_tv_equipment_reset_flow_starts', SUM(portals_tv_equipment_reset_flow_starts_calls),
     'portals_tv_equipment_reset_flow_submit', SUM(portals_tv_equipment_reset_flow_submit_calls),
     'portals_tv_equipment_reset_flow_successes', SUM(portals_tv_equipment_reset_flow_successes_calls),
     'portals_tv_modem_reset_failures', SUM(portals_tv_modem_reset_failures_calls),
     'portals_tv_router_reset_failures', SUM(portals_tv_router_reset_failures_calls),
     'portals_unauth_homepage_page_views', SUM(portals_unauth_homepage_page_views_calls),
     'portals_update_missing_contact_campaign_interaction', SUM(portals_update_missing_contact_campaign_interaction_calls),
     'portals_update_missing_contact_cancel_close_window', SUM(portals_update_missing_contact_cancel_close_window_calls),
     'portals_update_missing_contact_save', SUM(portals_update_missing_contact_save_calls),
     'portals_update_missing_contact_save_all', SUM(portals_update_missing_contact_save_all_calls),
     'portals_update_missing_contact_save_and_continue', SUM(portals_update_missing_contact_save_and_continue_calls),
     'portals_update_missing_contact_skip_this', SUM(portals_update_missing_contact_skip_this_calls),
     'portals_update_missing_contact_update_all', SUM(portals_update_missing_contact_update_all_calls),
     'portals_upgrade_links_overview', SUM(portals_upgrade_links_overview_calls),
     'portals_upgrade_service_internet', SUM(portals_upgrade_service_internet_calls),
     'portals_video_support_views', SUM(portals_video_support_views_calls),
     'portals_view_connected_devices', SUM(portals_view_connected_devices_calls),
     'portals_view_online_statments', SUM(portals_view_online_statments_calls),
     'portals_voice_delete_messages', SUM(portals_voice_delete_messages_calls),
     'portals_voice_equipment_reset_flow_failures', SUM(portals_voice_equipment_reset_flow_failures_calls),
     'portals_voice_equipment_reset_flow_starts', SUM(portals_voice_equipment_reset_flow_starts_calls),
     'portals_voice_equipment_reset_flow_submit', SUM(portals_voice_equipment_reset_flow_submit_calls),
     'portals_voice_equipment_reset_flow_successes', SUM(portals_voice_equipment_reset_flow_successes_calls),
     'portals_voice_modem_reset_failures', SUM(portals_voice_modem_reset_failures_calls),
     'portals_voice_pageviews', SUM(portals_voice_pageviews_calls),
     'portals_voice_play_messages', SUM(portals_voice_play_messages_calls),
     'portals_voice_router_reset_failures', SUM(portals_voice_router_reset_failures_calls),
     'portals_voice_support_views', SUM(portals_voice_support_views_calls),
     'portals_voice_update_call_forward_settings', SUM(portals_voice_update_call_forward_settings_calls),
     'portals_voice_view_messages', SUM(portals_voice_view_messages_calls),
     'portals_voice_voicemail_view_select_action', SUM(portals_voice_voicemail_view_select_action_calls),
     'portals_wifi_password_views', SUM(portals_wifi_password_views_calls),
     'portals_wifi_pw_changes', SUM(portals_wifi_pw_changes_calls)

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

) AS call_map
  FROM
    (
    SELECT
      unit_type,
      unit_identifier,
      mso,
      application_type,
      device_type,
      connection_type,
      network_status,
      playback_type,
      cust_type,
      application_group_type,
      app_version,
      logged_in_status,
      application_name,
      os_name,
      os_version,
      browser_name,
      browser_version,
      form_factor,
      CAST(grouping__id AS INT) AS grouping_id,

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
        IF(SUM(portals_access_voice_platform_via_tile) > 0, 1, 0) AS portals_access_voice_platform_via_tile,
        IF(SUM(portals_account_billing_support_views) > 0, 1, 0) AS portals_account_billing_support_views,
        IF(SUM(portals_account_settings_click_install_wifi_profile) > 0, 1, 0) AS portals_account_settings_click_install_wifi_profile,
        IF(SUM(portals_account_settings_click_manage_people) > 0, 1, 0) AS portals_account_settings_click_manage_people,
        IF(SUM(portals_account_settings_click_save_contact_info) > 0, 1, 0) AS portals_account_settings_click_save_contact_info,
        IF(SUM(portals_account_settings_home_page_views) > 0, 1, 0) AS portals_account_settings_home_page_views,
        IF(SUM(portals_account_settings_manage_contact_info_page_views) > 0, 1, 0) AS portals_account_settings_manage_contact_info_page_views,
        IF(SUM(portals_account_settings_manage_people_page_views) > 0, 1, 0) AS portals_account_settings_manage_people_page_views,
        IF(SUM(portals_account_settings_your_info_tab_views) > 0, 1, 0) AS portals_account_settings_your_info_tab_views,
        IF(SUM(portals_all_equipment_reset_flow_failures) > 0, 1, 0) AS portals_all_equipment_reset_flow_failures,
        IF(SUM(portals_all_equipment_reset_flow_starts) > 0, 1, 0) AS portals_all_equipment_reset_flow_starts,
        IF(SUM(portals_all_equipment_reset_flow_successes) > 0, 1, 0) AS portals_all_equipment_reset_flow_successes,
        IF(SUM(portals_asd_paperless_enroll) > 0, 1, 0) AS portals_asd_paperless_enroll,
        IF(SUM(portals_auth_homepage_page_views) > 0, 1, 0) AS portals_auth_homepage_page_views,
        IF(SUM(portals_bill_delivery_pref_exit) > 0, 1, 0) AS portals_bill_delivery_pref_exit,
        IF(SUM(portals_bill_delivery_pref_keep_paperless) > 0, 1, 0) AS portals_bill_delivery_pref_keep_paperless,
        IF(SUM(portals_bill_delivery_pref_manage_paperless) > 0, 1, 0) AS portals_bill_delivery_pref_manage_paperless,
        IF(SUM(portals_bill_delivery_pref_paper) > 0, 1, 0) AS portals_bill_delivery_pref_paper,
        IF(SUM(portals_bill_delivery_pref_paper_failure) > 0, 1, 0) AS portals_bill_delivery_pref_paper_failure,
        IF(SUM(portals_bill_delivery_pref_paper_success) > 0, 1, 0) AS portals_bill_delivery_pref_paper_success,
        IF(SUM(portals_bill_delivery_pref_paperless_enroll_from_homepage) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_enroll_from_homepage,
        IF(SUM(portals_bill_delivery_pref_paperless_failure) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_failure,
        IF(SUM(portals_bill_delivery_pref_paperless_submit) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit,
        IF(SUM(portals_bill_delivery_pref_paperless_submit_from_billinghome) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit_from_billinghome,
        IF(SUM(portals_bill_delivery_pref_paperless_submit_from_homepage) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit_from_homepage,
        IF(SUM(portals_bill_delivery_pref_paperless_success) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_success,
        IF(SUM(portals_billing_feature_interaction) > 0, 1, 0) AS portals_billing_feature_interaction,
        IF(SUM(portals_billing_feature_page_view) > 0, 1, 0) AS portals_billing_feature_page_view,
        IF(SUM(portals_biometrics_fingerprint_enroll) > 0, 1, 0) AS portals_biometrics_fingerprint_enroll,
        IF(SUM(portals_call_support) > 0, 1, 0) AS portals_call_support,
        IF(SUM(portals_cancel_pause_device) > 0, 1, 0) AS portals_cancel_pause_device,
        IF(SUM(portals_cancel_tutorial_equip_page_three) > 0, 1, 0) AS portals_cancel_tutorial_equip_page_three,
        IF(SUM(portals_cancel_tutorial_otp_page_two) > 0, 1, 0) AS portals_cancel_tutorial_otp_page_two,
        IF(SUM(portals_cancel_tutorial_start_page_one) > 0, 1, 0) AS portals_cancel_tutorial_start_page_one,
        IF(SUM(portals_cancel_unpause_device) > 0, 1, 0) AS portals_cancel_unpause_device,
        IF(SUM(portals_cancelled_service_appointment_start) > 0, 1, 0) AS portals_cancelled_service_appointment_start,
        IF(SUM(portals_cancelled_service_appointments) > 0, 1, 0) AS portals_cancelled_service_appointments,
        IF(SUM(portals_confirm_remove_device) > 0, 1, 0) AS portals_confirm_remove_device,
        IF(SUM(portals_contact_us_page_views) > 0, 1, 0) AS portals_contact_us_page_views,
        IF(SUM(portals_csat_campaign_dismiss) > 0, 1, 0) AS portals_csat_campaign_dismiss,
        IF(SUM(portals_csat_campaign_interaction) > 0, 1, 0) AS portals_csat_campaign_interaction,
        IF(SUM(portals_csat_submit_feedback_cancel_written_feedback) > 0, 1, 0) AS portals_csat_submit_feedback_cancel_written_feedback,
        IF(SUM(portals_csat_submit_rating_1_very_dissatisfied) > 0, 1, 0) AS portals_csat_submit_rating_1_very_dissatisfied,
        IF(SUM(portals_csat_submit_rating_2_dissatisfied) > 0, 1, 0) AS portals_csat_submit_rating_2_dissatisfied,
        IF(SUM(portals_csat_submit_rating_3_neutral) > 0, 1, 0) AS portals_csat_submit_rating_3_neutral,
        IF(SUM(portals_csat_submit_rating_4_satisfied) > 0, 1, 0) AS portals_csat_submit_rating_4_satisfied,
        IF(SUM(portals_csat_submit_rating_5_very_satisfied) > 0, 1, 0) AS portals_csat_submit_rating_5_very_satisfied,
        IF(SUM(portals_csat_submit_rating_all) > 0, 1, 0) AS portals_csat_submit_rating_all,
        IF(SUM(portals_csat_submit_written_feedback) > 0, 1, 0) AS portals_csat_submit_written_feedback,
        IF(SUM(portals_download_wifi_profile_button_click) > 0, 1, 0) AS portals_download_wifi_profile_button_click,
        IF(SUM(portals_download_wifi_profile_button_click_android) > 0, 1, 0) AS portals_download_wifi_profile_button_click_android,
        IF(SUM(portals_download_wifi_profile_button_click_ios) > 0, 1, 0) AS portals_download_wifi_profile_button_click_ios,
        IF(SUM(portals_download_wifi_profile_success) > 0, 1, 0) AS portals_download_wifi_profile_success,
        IF(SUM(portals_download_wifi_profile_success_android) > 0, 1, 0) AS portals_download_wifi_profile_success_android,
        IF(SUM(portals_ed_my_internet_services) > 0, 1, 0) AS portals_ed_my_internet_services,
        IF(SUM(portals_ed_my_voice_services) > 0, 1, 0) AS portals_ed_my_voice_services,
        IF(SUM(portals_equipment_cancel_edit_ssid_select_action) > 0, 1, 0) AS portals_equipment_cancel_edit_ssid_select_action,
        IF(SUM(portals_equipment_confirm_edit_ssid_select_action) > 0, 1, 0) AS portals_equipment_confirm_edit_ssid_select_action,
        IF(SUM(portals_equipment_detail_views) > 0, 1, 0) AS portals_equipment_detail_views,
        IF(SUM(portals_equipment_edit_ssid_select_action) > 0, 1, 0) AS portals_equipment_edit_ssid_select_action,
        IF(SUM(portals_equipment_feature_interaction) > 0, 1, 0) AS portals_equipment_feature_interaction,
        IF(SUM(portals_equipment_list_view) > 0, 1, 0) AS portals_equipment_list_view,
        IF(SUM(portals_equipment_reset_flow_submit_all) > 0, 1, 0) AS portals_equipment_reset_flow_submit_all,
        IF(SUM(portals_footer_getsupport_acct_support) > 0, 1, 0) AS portals_footer_getsupport_acct_support,
        IF(SUM(portals_footer_getsupport_support_home) > 0, 1, 0) AS portals_footer_getsupport_support_home,
        IF(SUM(portals_forgot_password_flow_start) > 0, 1, 0) AS portals_forgot_password_flow_start,
        IF(SUM(portals_forgot_password_success) > 0, 1, 0) AS portals_forgot_password_success,
        IF(SUM(portals_forgot_username_flow_start) > 0, 1, 0) AS portals_forgot_username_flow_start,
        IF(SUM(portals_forgot_username_success) > 0, 1, 0) AS portals_forgot_username_success,
        IF(SUM(portals_guided_tour_click_next) > 0, 1, 0) AS portals_guided_tour_click_next,
        IF(SUM(portals_guided_tour_exit) > 0, 1, 0) AS portals_guided_tour_exit,
        IF(SUM(portals_guided_tour_initiated_modal_view) > 0, 1, 0) AS portals_guided_tour_initiated_modal_view,
        IF(SUM(portals_guided_tour_one_of_three) > 0, 1, 0) AS portals_guided_tour_one_of_three,
        IF(SUM(portals_guided_tour_show_me_later) > 0, 1, 0) AS portals_guided_tour_show_me_later,
        IF(SUM(portals_guided_tour_three_of_three) > 0, 1, 0) AS portals_guided_tour_three_of_three,
        IF(SUM(portals_guided_tour_two_of_three) > 0, 1, 0) AS portals_guided_tour_two_of_three,
        IF(SUM(portals_install_wifi_profile_start) > 0, 1, 0) AS portals_install_wifi_profile_start,
        IF(SUM(portals_install_wifi_profile_success) > 0, 1, 0) AS portals_install_wifi_profile_success,
        IF(SUM(portals_internet_equipment_reset_flow_failures) > 0, 1, 0) AS portals_internet_equipment_reset_flow_failures,
        IF(SUM(portals_internet_equipment_reset_flow_starts) > 0, 1, 0) AS portals_internet_equipment_reset_flow_starts,
        IF(SUM(portals_internet_equipment_reset_flow_submit) > 0, 1, 0) AS portals_internet_equipment_reset_flow_submit,
        IF(SUM(portals_internet_equipment_reset_flow_successes) > 0, 1, 0) AS portals_internet_equipment_reset_flow_successes,
        IF(SUM(portals_internet_modem_reset_failures) > 0, 1, 0) AS portals_internet_modem_reset_failures,
        IF(SUM(portals_internet_modem_router_reset_starts) > 0, 1, 0) AS portals_internet_modem_router_reset_starts,
        IF(SUM(portals_internet_router_reset_failures) > 0, 1, 0) AS portals_internet_router_reset_failures,
        IF(SUM(portals_internet_router_reset_successes) > 0, 1, 0) AS portals_internet_router_reset_successes,
        IF(SUM(portals_internet_support_views) > 0, 1, 0) AS portals_internet_support_views,
        IF(SUM(portals_iva_opens) > 0, 1, 0) AS portals_iva_opens,
        IF(SUM(portals_localnav_billing) > 0, 1, 0) AS portals_localnav_billing,
        IF(SUM(portals_login_attempts) > 0, 1, 0) AS portals_login_attempts,
        IF(SUM(portals_login_failures) > 0, 1, 0) AS portals_login_failures,
        IF(SUM(portals_logout) > 0, 1, 0) AS portals_logout,
        IF(SUM(portals_manage_auto_payment_cancel) > 0, 1, 0) AS portals_manage_auto_payment_cancel,
        IF(SUM(portals_manage_auto_payment_starts) > 0, 1, 0) AS portals_manage_auto_payment_starts,
        IF(SUM(portals_manage_auto_payment_successes) > 0, 1, 0) AS portals_manage_auto_payment_successes,
        IF(SUM(portals_manual_reset_failures) > 0, 1, 0) AS portals_manual_reset_failures,
        IF(SUM(portals_manual_reset_starts) > 0, 1, 0) AS portals_manual_reset_starts,
        IF(SUM(portals_manual_reset_success) > 0, 1, 0) AS portals_manual_reset_success,
        IF(SUM(portals_msa_experience_feedback_click_submit_feedback) > 0, 1, 0) AS portals_msa_experience_feedback_click_submit_feedback,
        IF(SUM(portals_msa_experience_feedback_goal_accomplished) > 0, 1, 0) AS portals_msa_experience_feedback_goal_accomplished,
        IF(SUM(portals_msa_experience_feedback_goal_not_accomplished) > 0, 1, 0) AS portals_msa_experience_feedback_goal_not_accomplished,
        IF(SUM(portals_one_time_alert_clicked) > 0, 1, 0) AS portals_one_time_alert_clicked,
        IF(SUM(portals_one_time_page_alert_displayed) > 0, 1, 0) AS portals_one_time_page_alert_displayed,
        IF(SUM(portals_one_time_payment_amount) > 0, 1, 0) AS portals_one_time_payment_amount,
        IF(SUM(portals_one_time_payment_checking) > 0, 1, 0) AS portals_one_time_payment_checking,
        IF(SUM(portals_one_time_payment_checking_account) > 0, 1, 0) AS portals_one_time_payment_checking_account,
        IF(SUM(portals_one_time_payment_credit) > 0, 1, 0) AS portals_one_time_payment_credit,
        IF(SUM(portals_one_time_payment_credit_debit_card) > 0, 1, 0) AS portals_one_time_payment_credit_debit_card,
        IF(SUM(portals_one_time_payment_date) > 0, 1, 0) AS portals_one_time_payment_date,
        IF(SUM(portals_one_time_payment_date_other) > 0, 1, 0) AS portals_one_time_payment_date_other,
        IF(SUM(portals_one_time_payment_date_past_due) > 0, 1, 0) AS portals_one_time_payment_date_past_due,
        IF(SUM(portals_one_time_payment_date_today) > 0, 1, 0) AS portals_one_time_payment_date_today,
        IF(SUM(portals_one_time_payment_failures) > 0, 1, 0) AS portals_one_time_payment_failures,
        IF(SUM(portals_one_time_payment_savings) > 0, 1, 0) AS portals_one_time_payment_savings,
        IF(SUM(portals_one_time_payment_savings_account) > 0, 1, 0) AS portals_one_time_payment_savings_account,
        IF(SUM(portals_one_time_payment_select_amount) > 0, 1, 0) AS portals_one_time_payment_select_amount,
        IF(SUM(portals_one_time_payment_select_date) > 0, 1, 0) AS portals_one_time_payment_select_date,
        IF(SUM(portals_one_time_payment_select_payment_method) > 0, 1, 0) AS portals_one_time_payment_select_payment_method,
        IF(SUM(portals_one_time_payment_starts) > 0, 1, 0) AS portals_one_time_payment_starts,
        IF(SUM(portals_one_time_payment_submission_new_payment_method) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method,
        IF(SUM(portals_one_time_payment_submission_new_payment_method_not_stored) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method_not_stored,
        IF(SUM(portals_one_time_payment_submission_new_payment_method_stored) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method_stored,
        IF(SUM(portals_one_time_payment_submission_previously_stored_payment_method) > 0, 1, 0) AS portals_one_time_payment_submission_previously_stored_payment_method,
        IF(SUM(portals_one_time_payment_submits) > 0, 1, 0) AS portals_one_time_payment_submits,
        IF(SUM(portals_one_time_payment_submits_with_ap) > 0, 1, 0) AS portals_one_time_payment_submits_with_ap,
        IF(SUM(portals_one_time_payment_submits_without_ap) > 0, 1, 0) AS portals_one_time_payment_submits_without_ap,
        IF(SUM(portals_one_time_payment_successes) > 0, 1, 0) AS portals_one_time_payment_successes,
        IF(SUM(portals_one_time_payment_successes_with_ap_enroll) > 0, 1, 0) AS portals_one_time_payment_successes_with_ap_enroll,
        IF(SUM(portals_one_time_payment_successes_without_ap_enroll) > 0, 1, 0) AS portals_one_time_payment_successes_without_ap_enroll,
        IF(SUM(portals_page_views) > 0, 1, 0) AS portals_page_views,
        IF(SUM(portals_paperless_radio_toggle) > 0, 1, 0) AS portals_paperless_radio_toggle,
        IF(SUM(portals_paperless_toggle) > 0, 1, 0) AS portals_paperless_toggle,
        IF(SUM(portals_rescheduled_service_appointment_start) > 0, 1, 0) AS portals_rescheduled_service_appointment_start,
        IF(SUM(portals_rescheduled_service_appointments) > 0, 1, 0) AS portals_rescheduled_service_appointments,
        IF(SUM(portals_router_advanced_settings_click_about_port_forward) > 0, 1, 0) AS portals_router_advanced_settings_click_about_port_forward,
        IF(SUM(portals_router_advanced_settings_click_add_port_assignment) > 0, 1, 0) AS portals_router_advanced_settings_click_add_port_assignment,
        IF(SUM(portals_router_advanced_settings_click_cancel_dns_change) > 0, 1, 0) AS portals_router_advanced_settings_click_cancel_dns_change,
        IF(SUM(portals_router_advanced_settings_click_cancel_port_assignment) > 0, 1, 0) AS portals_router_advanced_settings_click_cancel_port_assignment,
        IF(SUM(portals_router_advanced_settings_click_create_ip_reservation) > 0, 1, 0) AS portals_router_advanced_settings_click_create_ip_reservation,
        IF(SUM(portals_router_advanced_settings_click_delete_or_cancel_delete_port) > 0, 1, 0) AS portals_router_advanced_settings_click_delete_or_cancel_delete_port,
        IF(SUM(portals_router_advanced_settings_click_delete_port) > 0, 1, 0) AS portals_router_advanced_settings_click_delete_port,
        IF(SUM(portals_router_advanced_settings_click_dns) > 0, 1, 0) AS portals_router_advanced_settings_click_dns,
        IF(SUM(portals_router_advanced_settings_click_manage_dns) > 0, 1, 0) AS portals_router_advanced_settings_click_manage_dns,
        IF(SUM(portals_router_advanced_settings_click_manage_ip_reservations) > 0, 1, 0) AS portals_router_advanced_settings_click_manage_ip_reservations,
        IF(SUM(portals_router_advanced_settings_click_port_forward) > 0, 1, 0) AS portals_router_advanced_settings_click_port_forward,
        IF(SUM(portals_router_advanced_settings_click_reset_dns_default) > 0, 1, 0) AS portals_router_advanced_settings_click_reset_dns_default,
        IF(SUM(portals_router_advanced_settings_click_save_confirm_dns) > 0, 1, 0) AS portals_router_advanced_settings_click_save_confirm_dns,
        IF(SUM(portals_router_advanced_settings_click_spectrum_dns_default) > 0, 1, 0) AS portals_router_advanced_settings_click_spectrum_dns_default,
        IF(SUM(portals_router_advanced_settings_click_upnp) > 0, 1, 0) AS portals_router_advanced_settings_click_upnp,
        IF(SUM(portals_router_advanced_settings_click_use_existing_port) > 0, 1, 0) AS portals_router_advanced_settings_click_use_existing_port,
        IF(SUM(portals_router_advanced_settings_delete_port_assignment_via_swipe) > 0, 1, 0) AS portals_router_advanced_settings_delete_port_assignment_via_swipe,
        IF(SUM(portals_router_advanced_settings_port_unavailable_modal) > 0, 1, 0) AS portals_router_advanced_settings_port_unavailable_modal,
        IF(SUM(portals_router_advanced_settings_reserve_ip_toggle_off) > 0, 1, 0) AS portals_router_advanced_settings_reserve_ip_toggle_off,
        IF(SUM(portals_router_advanced_settings_reserve_ip_toggle_on) > 0, 1, 0) AS portals_router_advanced_settings_reserve_ip_toggle_on,
        IF(SUM(portals_router_advanced_settings_upnp_toggle_off) > 0, 1, 0) AS portals_router_advanced_settings_upnp_toggle_off,
        IF(SUM(portals_router_advanced_settings_upnp_toggle_on) > 0, 1, 0) AS portals_router_advanced_settings_upnp_toggle_on,
        IF(SUM(portals_save_edit_device_nickname) > 0, 1, 0) AS portals_save_edit_device_nickname,
        IF(SUM(portals_scp_click_cancel_pause_device) > 0, 1, 0) AS portals_scp_click_cancel_pause_device,
        IF(SUM(portals_scp_click_cancel_unpause_device) > 0, 1, 0) AS portals_scp_click_cancel_unpause_device,
        IF(SUM(portals_scp_click_not_connected_devices_tab) > 0, 1, 0) AS portals_scp_click_not_connected_devices_tab,
        IF(SUM(portals_scp_click_pause_device) > 0, 1, 0) AS portals_scp_click_pause_device,
        IF(SUM(portals_scp_click_paused_tab) > 0, 1, 0) AS portals_scp_click_paused_tab,
        IF(SUM(portals_scp_click_unpause_device) > 0, 1, 0) AS portals_scp_click_unpause_device,
        IF(SUM(portals_scp_final_confirm_create_pod_name_failure) > 0, 1, 0) AS portals_scp_final_confirm_create_pod_name_failure,
        IF(SUM(portals_scp_final_confirm_create_pod_name_success) > 0, 1, 0) AS portals_scp_final_confirm_create_pod_name_success,
        IF(SUM(portals_scp_final_confirm_device_nickname_change_failure) > 0, 1, 0) AS portals_scp_final_confirm_device_nickname_change_failure,
        IF(SUM(portals_scp_final_confirm_device_nickname_change_success) > 0, 1, 0) AS portals_scp_final_confirm_device_nickname_change_success,
        IF(SUM(portals_scp_final_confirm_device_type_and_nickname_change_failure) > 0, 1, 0) AS portals_scp_final_confirm_device_type_and_nickname_change_failure,
        IF(SUM(portals_scp_final_confirm_device_type_and_nickname_change_success) > 0, 1, 0) AS portals_scp_final_confirm_device_type_and_nickname_change_success,
        IF(SUM(portals_scp_final_confirm_device_type_icon_update_failure) > 0, 1, 0) AS portals_scp_final_confirm_device_type_icon_update_failure,
        IF(SUM(portals_scp_final_confirm_device_type_icon_update_success) > 0, 1, 0) AS portals_scp_final_confirm_device_type_icon_update_success,
        IF(SUM(portals_scp_final_confirm_edit_pod_name_failure) > 0, 1, 0) AS portals_scp_final_confirm_edit_pod_name_failure,
        IF(SUM(portals_scp_final_confirm_edit_pod_name_success) > 0, 1, 0) AS portals_scp_final_confirm_edit_pod_name_success,
        IF(SUM(portals_scp_final_confirm_pause_failure) > 0, 1, 0) AS portals_scp_final_confirm_pause_failure,
        IF(SUM(portals_scp_final_confirm_pause_success) > 0, 1, 0) AS portals_scp_final_confirm_pause_success,
        IF(SUM(portals_scp_final_confirm_refresh_pod_failure) > 0, 1, 0) AS portals_scp_final_confirm_refresh_pod_failure,
        IF(SUM(portals_scp_final_confirm_refresh_pod_success) > 0, 1, 0) AS portals_scp_final_confirm_refresh_pod_success,
        IF(SUM(portals_scp_final_confirm_remove_device_failure) > 0, 1, 0) AS portals_scp_final_confirm_remove_device_failure,
        IF(SUM(portals_scp_final_confirm_remove_device_success) > 0, 1, 0) AS portals_scp_final_confirm_remove_device_success,
        IF(SUM(portals_scp_final_confirm_unpause_failure) > 0, 1, 0) AS portals_scp_final_confirm_unpause_failure,
        IF(SUM(portals_scp_final_confirm_unpause_success) > 0, 1, 0) AS portals_scp_final_confirm_unpause_success,
        IF(SUM(portals_scp_list_of_pods_pv) > 0, 1, 0) AS portals_scp_list_of_pods_pv,
        IF(SUM(portals_scp_pod_details_pv) > 0, 1, 0) AS portals_scp_pod_details_pv,
        IF(SUM(portals_scp_remove_device_cancel) > 0, 1, 0) AS portals_scp_remove_device_cancel,
        IF(SUM(portals_scp_select_pod_from_list) > 0, 1, 0) AS portals_scp_select_pod_from_list,
        IF(SUM(portals_security_qa_campaign_interaction) > 0, 1, 0) AS portals_security_qa_campaign_interaction,
        IF(SUM(portals_security_qa_update_security_page_view) > 0, 1, 0) AS portals_security_qa_update_security_page_view,
        IF(SUM(portals_select_actions) > 0, 1, 0) AS portals_select_actions,
        IF(SUM(portals_set_up_auto_payment_failures) > 0, 1, 0) AS portals_set_up_auto_payment_failures,
        IF(SUM(portals_set_up_auto_payment_starts) > 0, 1, 0) AS portals_set_up_auto_payment_starts,
        IF(SUM(portals_set_up_auto_payment_submits) > 0, 1, 0) AS portals_set_up_auto_payment_submits,
        IF(SUM(portals_set_up_auto_payment_submits_plus_otp) > 0, 1, 0) AS portals_set_up_auto_payment_submits_plus_otp,
        IF(SUM(portals_set_up_auto_payment_successes) > 0, 1, 0) AS portals_set_up_auto_payment_successes,
        IF(SUM(portals_set_up_auto_payment_successes_with_payment) > 0, 1, 0) AS portals_set_up_auto_payment_successes_with_payment,
        IF(SUM(portals_set_up_auto_payment_successes_without_payment) > 0, 1, 0) AS portals_set_up_auto_payment_successes_without_payment,
        IF(SUM(portals_settings_sign_in_security_manage_select_action) > 0, 1, 0) AS portals_settings_sign_in_security_manage_select_action,
        IF(SUM(portals_settings_sign_in_security_subnav_people_select_action) > 0, 1, 0) AS portals_settings_sign_in_security_subnav_people_select_action,
        IF(SUM(portals_settings_verify_select_action) > 0, 1, 0) AS portals_settings_verify_select_action,
        IF(SUM(portals_settings_your_info_changes_success) > 0, 1, 0) AS portals_settings_your_info_changes_success,
        IF(SUM(portals_settings_your_info_manage_select_action) > 0, 1, 0) AS portals_settings_your_info_manage_select_action,
        IF(SUM(portals_settings_your_info_save_select_action) > 0, 1, 0) AS portals_settings_your_info_save_select_action,
        IF(SUM(portals_settings_your_info_verify_identity_modal_view) > 0, 1, 0) AS portals_settings_your_info_verify_identity_modal_view,
        IF(SUM(portals_settings_your_info_verify_success) > 0, 1, 0) AS portals_settings_your_info_verify_success,
        IF(SUM(portals_site_unique) > 0, 1, 0) AS portals_site_unique,
        IF(SUM(portals_site_unique_auth) > 0, 1, 0) AS portals_site_unique_auth,
        IF(SUM(portals_site_unique_mobile) > 0, 1, 0) AS portals_site_unique_mobile,
        IF(SUM(portals_site_unique_pc) > 0, 1, 0) AS portals_site_unique_pc,
        IF(SUM(portals_start_pause_device) > 0, 1, 0) AS portals_start_pause_device,
        IF(SUM(portals_start_unpause_device) > 0, 1, 0) AS portals_start_unpause_device,
        IF(SUM(portals_support_article_select) > 0, 1, 0) AS portals_support_article_select,
        IF(SUM(portals_support_button) > 0, 1, 0) AS portals_support_button,
        IF(SUM(portals_support_page_views) > 0, 1, 0) AS portals_support_page_views,
        IF(SUM(portals_tech_tracker_auth_views) > 0, 1, 0) AS portals_tech_tracker_auth_views,
        IF(SUM(portals_tech_tracker_unauth_views) > 0, 1, 0) AS portals_tech_tracker_unauth_views,
        IF(SUM(portals_tutorial_account_page_five_page_view) > 0, 1, 0) AS portals_tutorial_account_page_five_page_view,
        IF(SUM(portals_tutorial_account_page_four_page_view) > 0, 1, 0) AS portals_tutorial_account_page_four_page_view,
        IF(SUM(portals_tutorial_equip_page_three_page_view) > 0, 1, 0) AS portals_tutorial_equip_page_three_page_view,
        IF(SUM(portals_tutorial_otp_page_two_page_view) > 0, 1, 0) AS portals_tutorial_otp_page_two_page_view,
        IF(SUM(portals_tutorial_start_page_one_page_view) > 0, 1, 0) AS portals_tutorial_start_page_one_page_view,
        IF(SUM(portals_tutorial_views) > 0, 1, 0) AS portals_tutorial_views,
        IF(SUM(portals_tv_equipment_reset_flow_failures) > 0, 1, 0) AS portals_tv_equipment_reset_flow_failures,
        IF(SUM(portals_tv_equipment_reset_flow_starts) > 0, 1, 0) AS portals_tv_equipment_reset_flow_starts,
        IF(SUM(portals_tv_equipment_reset_flow_submit) > 0, 1, 0) AS portals_tv_equipment_reset_flow_submit,
        IF(SUM(portals_tv_equipment_reset_flow_successes) > 0, 1, 0) AS portals_tv_equipment_reset_flow_successes,
        IF(SUM(portals_tv_modem_reset_failures) > 0, 1, 0) AS portals_tv_modem_reset_failures,
        IF(SUM(portals_tv_router_reset_failures) > 0, 1, 0) AS portals_tv_router_reset_failures,
        IF(SUM(portals_unauth_homepage_page_views) > 0, 1, 0) AS portals_unauth_homepage_page_views,
        IF(SUM(portals_update_missing_contact_campaign_interaction) > 0, 1, 0) AS portals_update_missing_contact_campaign_interaction,
        IF(SUM(portals_update_missing_contact_cancel_close_window) > 0, 1, 0) AS portals_update_missing_contact_cancel_close_window,
        IF(SUM(portals_update_missing_contact_save) > 0, 1, 0) AS portals_update_missing_contact_save,
        IF(SUM(portals_update_missing_contact_save_all) > 0, 1, 0) AS portals_update_missing_contact_save_all,
        IF(SUM(portals_update_missing_contact_save_and_continue) > 0, 1, 0) AS portals_update_missing_contact_save_and_continue,
        IF(SUM(portals_update_missing_contact_skip_this) > 0, 1, 0) AS portals_update_missing_contact_skip_this,
        IF(SUM(portals_update_missing_contact_update_all) > 0, 1, 0) AS portals_update_missing_contact_update_all,
        IF(SUM(portals_upgrade_links_overview) > 0, 1, 0) AS portals_upgrade_links_overview,
        IF(SUM(portals_upgrade_service_internet) > 0, 1, 0) AS portals_upgrade_service_internet,
        IF(SUM(portals_video_support_views) > 0, 1, 0) AS portals_video_support_views,
        IF(SUM(portals_view_connected_devices) > 0, 1, 0) AS portals_view_connected_devices,
        IF(SUM(portals_view_online_statments) > 0, 1, 0) AS portals_view_online_statments,
        IF(SUM(portals_voice_delete_messages) > 0, 1, 0) AS portals_voice_delete_messages,
        IF(SUM(portals_voice_equipment_reset_flow_failures) > 0, 1, 0) AS portals_voice_equipment_reset_flow_failures,
        IF(SUM(portals_voice_equipment_reset_flow_starts) > 0, 1, 0) AS portals_voice_equipment_reset_flow_starts,
        IF(SUM(portals_voice_equipment_reset_flow_submit) > 0, 1, 0) AS portals_voice_equipment_reset_flow_submit,
        IF(SUM(portals_voice_equipment_reset_flow_successes) > 0, 1, 0) AS portals_voice_equipment_reset_flow_successes,
        IF(SUM(portals_voice_modem_reset_failures) > 0, 1, 0) AS portals_voice_modem_reset_failures,
        IF(SUM(portals_voice_pageviews) > 0, 1, 0) AS portals_voice_pageviews,
        IF(SUM(portals_voice_play_messages) > 0, 1, 0) AS portals_voice_play_messages,
        IF(SUM(portals_voice_router_reset_failures) > 0, 1, 0) AS portals_voice_router_reset_failures,
        IF(SUM(portals_voice_support_views) > 0, 1, 0) AS portals_voice_support_views,
        IF(SUM(portals_voice_update_call_forward_settings) > 0, 1, 0) AS portals_voice_update_call_forward_settings,
        IF(SUM(portals_voice_view_messages) > 0, 1, 0) AS portals_voice_view_messages,
        IF(SUM(portals_voice_voicemail_view_select_action) > 0, 1, 0) AS portals_voice_voicemail_view_select_action,
        IF(SUM(portals_wifi_password_views) > 0, 1, 0) AS portals_wifi_password_views,
        IF(SUM(portals_wifi_pw_changes) > 0, 1, 0) AS portals_wifi_pw_changes,

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
        IF(SUM(portals_access_voice_platform_via_tile) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_access_voice_platform_via_tile_calls,
        IF(SUM(portals_account_billing_support_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_billing_support_views_calls,
        IF(SUM(portals_account_settings_click_install_wifi_profile) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_click_install_wifi_profile_calls,
        IF(SUM(portals_account_settings_click_manage_people) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_click_manage_people_calls,
        IF(SUM(portals_account_settings_click_save_contact_info) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_click_save_contact_info_calls,
        IF(SUM(portals_account_settings_home_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_home_page_views_calls,
        IF(SUM(portals_account_settings_manage_contact_info_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_manage_contact_info_page_views_calls,
        IF(SUM(portals_account_settings_manage_people_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_manage_people_page_views_calls,
        IF(SUM(portals_account_settings_your_info_tab_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_account_settings_your_info_tab_views_calls,
        IF(SUM(portals_all_equipment_reset_flow_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_all_equipment_reset_flow_failures_calls,
        IF(SUM(portals_all_equipment_reset_flow_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_all_equipment_reset_flow_starts_calls,
        IF(SUM(portals_all_equipment_reset_flow_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_all_equipment_reset_flow_successes_calls,
        IF(SUM(portals_asd_paperless_enroll) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_asd_paperless_enroll_calls,
        IF(SUM(portals_auth_homepage_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_auth_homepage_page_views_calls,
        IF(SUM(portals_bill_delivery_pref_exit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_exit_calls,
        IF(SUM(portals_bill_delivery_pref_keep_paperless) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_keep_paperless_calls,
        IF(SUM(portals_bill_delivery_pref_manage_paperless) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_manage_paperless_calls,
        IF(SUM(portals_bill_delivery_pref_paper) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paper_calls,
        IF(SUM(portals_bill_delivery_pref_paper_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paper_failure_calls,
        IF(SUM(portals_bill_delivery_pref_paper_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paper_success_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_enroll_from_homepage) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_enroll_from_homepage_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_failure_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_submit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_submit_from_billinghome) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit_from_billinghome_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_submit_from_homepage) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_submit_from_homepage_calls,
        IF(SUM(portals_bill_delivery_pref_paperless_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_bill_delivery_pref_paperless_success_calls,
        IF(SUM(portals_billing_feature_interaction) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_billing_feature_interaction_calls,
        IF(SUM(portals_billing_feature_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_billing_feature_page_view_calls,
        IF(SUM(portals_biometrics_fingerprint_enroll) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_biometrics_fingerprint_enroll_calls,
        IF(SUM(portals_call_support) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_call_support_calls,
        IF(SUM(portals_cancel_pause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancel_pause_device_calls,
        IF(SUM(portals_cancel_tutorial_equip_page_three) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancel_tutorial_equip_page_three_calls,
        IF(SUM(portals_cancel_tutorial_otp_page_two) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancel_tutorial_otp_page_two_calls,
        IF(SUM(portals_cancel_tutorial_start_page_one) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancel_tutorial_start_page_one_calls,
        IF(SUM(portals_cancel_unpause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancel_unpause_device_calls,
        IF(SUM(portals_cancelled_service_appointment_start) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancelled_service_appointment_start_calls,
        IF(SUM(portals_cancelled_service_appointments) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_cancelled_service_appointments_calls,
        IF(SUM(portals_confirm_remove_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_confirm_remove_device_calls,
        IF(SUM(portals_contact_us_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_contact_us_page_views_calls,
        IF(SUM(portals_csat_campaign_dismiss) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_campaign_dismiss_calls,
        IF(SUM(portals_csat_campaign_interaction) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_campaign_interaction_calls,
        IF(SUM(portals_csat_submit_feedback_cancel_written_feedback) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_feedback_cancel_written_feedback_calls,
        IF(SUM(portals_csat_submit_rating_1_very_dissatisfied) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_1_very_dissatisfied_calls,
        IF(SUM(portals_csat_submit_rating_2_dissatisfied) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_2_dissatisfied_calls,
        IF(SUM(portals_csat_submit_rating_3_neutral) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_3_neutral_calls,
        IF(SUM(portals_csat_submit_rating_4_satisfied) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_4_satisfied_calls,
        IF(SUM(portals_csat_submit_rating_5_very_satisfied) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_5_very_satisfied_calls,
        IF(SUM(portals_csat_submit_rating_all) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_rating_all_calls,
        IF(SUM(portals_csat_submit_written_feedback) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_csat_submit_written_feedback_calls,
        IF(SUM(portals_download_wifi_profile_button_click) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_download_wifi_profile_button_click_calls,
        IF(SUM(portals_download_wifi_profile_button_click_android) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_download_wifi_profile_button_click_android_calls,
        IF(SUM(portals_download_wifi_profile_button_click_ios) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_download_wifi_profile_button_click_ios_calls,
        IF(SUM(portals_download_wifi_profile_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_download_wifi_profile_success_calls,
        IF(SUM(portals_download_wifi_profile_success_android) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_download_wifi_profile_success_android_calls,
        IF(SUM(portals_ed_my_internet_services) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_ed_my_internet_services_calls,
        IF(SUM(portals_ed_my_voice_services) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_ed_my_voice_services_calls,
        IF(SUM(portals_equipment_cancel_edit_ssid_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_cancel_edit_ssid_select_action_calls,
        IF(SUM(portals_equipment_confirm_edit_ssid_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_confirm_edit_ssid_select_action_calls,
        IF(SUM(portals_equipment_detail_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_detail_views_calls,
        IF(SUM(portals_equipment_edit_ssid_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_edit_ssid_select_action_calls,
        IF(SUM(portals_equipment_feature_interaction) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_feature_interaction_calls,
        IF(SUM(portals_equipment_list_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_list_view_calls,
        IF(SUM(portals_equipment_reset_flow_submit_all) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_equipment_reset_flow_submit_all_calls,
        IF(SUM(portals_footer_getsupport_acct_support) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_footer_getsupport_acct_support_calls,
        IF(SUM(portals_footer_getsupport_support_home) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_footer_getsupport_support_home_calls,
        IF(SUM(portals_forgot_password_flow_start) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_forgot_password_flow_start_calls,
        IF(SUM(portals_forgot_password_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_forgot_password_success_calls,
        IF(SUM(portals_forgot_username_flow_start) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_forgot_username_flow_start_calls,
        IF(SUM(portals_forgot_username_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_forgot_username_success_calls,
        IF(SUM(portals_guided_tour_click_next) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_click_next_calls,
        IF(SUM(portals_guided_tour_exit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_exit_calls,
        IF(SUM(portals_guided_tour_initiated_modal_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_initiated_modal_view_calls,
        IF(SUM(portals_guided_tour_one_of_three) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_one_of_three_calls,
        IF(SUM(portals_guided_tour_show_me_later) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_show_me_later_calls,
        IF(SUM(portals_guided_tour_three_of_three) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_three_of_three_calls,
        IF(SUM(portals_guided_tour_two_of_three) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_guided_tour_two_of_three_calls,
        IF(SUM(portals_install_wifi_profile_start) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_install_wifi_profile_start_calls,
        IF(SUM(portals_install_wifi_profile_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_install_wifi_profile_success_calls,
        IF(SUM(portals_internet_equipment_reset_flow_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_equipment_reset_flow_failures_calls,
        IF(SUM(portals_internet_equipment_reset_flow_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_equipment_reset_flow_starts_calls,
        IF(SUM(portals_internet_equipment_reset_flow_submit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_equipment_reset_flow_submit_calls,
        IF(SUM(portals_internet_equipment_reset_flow_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_equipment_reset_flow_successes_calls,
        IF(SUM(portals_internet_modem_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_modem_reset_failures_calls,
        IF(SUM(portals_internet_modem_router_reset_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_modem_router_reset_starts_calls,
        IF(SUM(portals_internet_router_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_router_reset_failures_calls,
        IF(SUM(portals_internet_router_reset_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_router_reset_successes_calls,
        IF(SUM(portals_internet_support_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_internet_support_views_calls,
        IF(SUM(portals_iva_opens) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_iva_opens_calls,
        IF(SUM(portals_localnav_billing) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_localnav_billing_calls,
        IF(SUM(portals_login_attempts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_login_attempts_calls,
        IF(SUM(portals_login_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_login_failures_calls,
        IF(SUM(portals_logout) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_logout_calls,
        IF(SUM(portals_manage_auto_payment_cancel) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manage_auto_payment_cancel_calls,
        IF(SUM(portals_manage_auto_payment_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manage_auto_payment_starts_calls,
        IF(SUM(portals_manage_auto_payment_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manage_auto_payment_successes_calls,
        IF(SUM(portals_manual_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manual_reset_failures_calls,
        IF(SUM(portals_manual_reset_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manual_reset_starts_calls,
        IF(SUM(portals_manual_reset_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_manual_reset_success_calls,
        IF(SUM(portals_msa_experience_feedback_click_submit_feedback) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_msa_experience_feedback_click_submit_feedback_calls,
        IF(SUM(portals_msa_experience_feedback_goal_accomplished) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_msa_experience_feedback_goal_accomplished_calls,
        IF(SUM(portals_msa_experience_feedback_goal_not_accomplished) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_msa_experience_feedback_goal_not_accomplished_calls,
        IF(SUM(portals_one_time_alert_clicked) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_alert_clicked_calls,
        IF(SUM(portals_one_time_page_alert_displayed) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_page_alert_displayed_calls,
        IF(SUM(portals_one_time_payment_amount) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_amount_calls,
        IF(SUM(portals_one_time_payment_checking) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_checking_calls,
        IF(SUM(portals_one_time_payment_checking_account) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_checking_account_calls,
        IF(SUM(portals_one_time_payment_credit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_credit_calls,
        IF(SUM(portals_one_time_payment_credit_debit_card) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_credit_debit_card_calls,
        IF(SUM(portals_one_time_payment_date) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_date_calls,
        IF(SUM(portals_one_time_payment_date_other) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_date_other_calls,
        IF(SUM(portals_one_time_payment_date_past_due) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_date_past_due_calls,
        IF(SUM(portals_one_time_payment_date_today) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_date_today_calls,
        IF(SUM(portals_one_time_payment_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_failures_calls,
        IF(SUM(portals_one_time_payment_savings) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_savings_calls,
        IF(SUM(portals_one_time_payment_savings_account) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_savings_account_calls,
        IF(SUM(portals_one_time_payment_select_amount) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_select_amount_calls,
        IF(SUM(portals_one_time_payment_select_date) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_select_date_calls,
        IF(SUM(portals_one_time_payment_select_payment_method) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_select_payment_method_calls,
        IF(SUM(portals_one_time_payment_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_starts_calls,
        IF(SUM(portals_one_time_payment_submission_new_payment_method) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method_calls,
        IF(SUM(portals_one_time_payment_submission_new_payment_method_not_stored) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method_not_stored_calls,
        IF(SUM(portals_one_time_payment_submission_new_payment_method_stored) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submission_new_payment_method_stored_calls,
        IF(SUM(portals_one_time_payment_submission_previously_stored_payment_method) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submission_previously_stored_payment_method_calls,
        IF(SUM(portals_one_time_payment_submits) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submits_calls,
        IF(SUM(portals_one_time_payment_submits_with_ap) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submits_with_ap_calls,
        IF(SUM(portals_one_time_payment_submits_without_ap) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_submits_without_ap_calls,
        IF(SUM(portals_one_time_payment_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_successes_calls,
        IF(SUM(portals_one_time_payment_successes_with_ap_enroll) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_successes_with_ap_enroll_calls,
        IF(SUM(portals_one_time_payment_successes_without_ap_enroll) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_one_time_payment_successes_without_ap_enroll_calls,
        IF(SUM(portals_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_page_views_calls,
        IF(SUM(portals_paperless_radio_toggle) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_paperless_radio_toggle_calls,
        IF(SUM(portals_paperless_toggle) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_paperless_toggle_calls,
        IF(SUM(portals_rescheduled_service_appointment_start) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_rescheduled_service_appointment_start_calls,
        IF(SUM(portals_rescheduled_service_appointments) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_rescheduled_service_appointments_calls,
        IF(SUM(portals_router_advanced_settings_click_about_port_forward) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_about_port_forward_calls,
        IF(SUM(portals_router_advanced_settings_click_add_port_assignment) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_add_port_assignment_calls,
        IF(SUM(portals_router_advanced_settings_click_cancel_dns_change) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_cancel_dns_change_calls,
        IF(SUM(portals_router_advanced_settings_click_cancel_port_assignment) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_cancel_port_assignment_calls,
        IF(SUM(portals_router_advanced_settings_click_create_ip_reservation) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_create_ip_reservation_calls,
        IF(SUM(portals_router_advanced_settings_click_delete_or_cancel_delete_port) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_delete_or_cancel_delete_port_calls,
        IF(SUM(portals_router_advanced_settings_click_delete_port) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_delete_port_calls,
        IF(SUM(portals_router_advanced_settings_click_dns) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_dns_calls,
        IF(SUM(portals_router_advanced_settings_click_manage_dns) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_manage_dns_calls,
        IF(SUM(portals_router_advanced_settings_click_manage_ip_reservations) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_manage_ip_reservations_calls,
        IF(SUM(portals_router_advanced_settings_click_port_forward) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_port_forward_calls,
        IF(SUM(portals_router_advanced_settings_click_reset_dns_default) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_reset_dns_default_calls,
        IF(SUM(portals_router_advanced_settings_click_save_confirm_dns) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_save_confirm_dns_calls,
        IF(SUM(portals_router_advanced_settings_click_spectrum_dns_default) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_spectrum_dns_default_calls,
        IF(SUM(portals_router_advanced_settings_click_upnp) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_upnp_calls,
        IF(SUM(portals_router_advanced_settings_click_use_existing_port) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_click_use_existing_port_calls,
        IF(SUM(portals_router_advanced_settings_delete_port_assignment_via_swipe) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_delete_port_assignment_via_swipe_calls,
        IF(SUM(portals_router_advanced_settings_port_unavailable_modal) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_port_unavailable_modal_calls,
        IF(SUM(portals_router_advanced_settings_reserve_ip_toggle_off) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_reserve_ip_toggle_off_calls,
        IF(SUM(portals_router_advanced_settings_reserve_ip_toggle_on) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_reserve_ip_toggle_on_calls,
        IF(SUM(portals_router_advanced_settings_upnp_toggle_off) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_upnp_toggle_off_calls,
        IF(SUM(portals_router_advanced_settings_upnp_toggle_on) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_router_advanced_settings_upnp_toggle_on_calls,
        IF(SUM(portals_save_edit_device_nickname) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_save_edit_device_nickname_calls,
        IF(SUM(portals_scp_click_cancel_pause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_cancel_pause_device_calls,
        IF(SUM(portals_scp_click_cancel_unpause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_cancel_unpause_device_calls,
        IF(SUM(portals_scp_click_not_connected_devices_tab) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_not_connected_devices_tab_calls,
        IF(SUM(portals_scp_click_pause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_pause_device_calls,
        IF(SUM(portals_scp_click_paused_tab) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_paused_tab_calls,
        IF(SUM(portals_scp_click_unpause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_click_unpause_device_calls,
        IF(SUM(portals_scp_final_confirm_create_pod_name_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_create_pod_name_failure_calls,
        IF(SUM(portals_scp_final_confirm_create_pod_name_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_create_pod_name_success_calls,
        IF(SUM(portals_scp_final_confirm_device_nickname_change_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_nickname_change_failure_calls,
        IF(SUM(portals_scp_final_confirm_device_nickname_change_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_nickname_change_success_calls,
        IF(SUM(portals_scp_final_confirm_device_type_and_nickname_change_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_type_and_nickname_change_failure_calls,
        IF(SUM(portals_scp_final_confirm_device_type_and_nickname_change_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_type_and_nickname_change_success_calls,
        IF(SUM(portals_scp_final_confirm_device_type_icon_update_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_type_icon_update_failure_calls,
        IF(SUM(portals_scp_final_confirm_device_type_icon_update_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_device_type_icon_update_success_calls,
        IF(SUM(portals_scp_final_confirm_edit_pod_name_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_edit_pod_name_failure_calls,
        IF(SUM(portals_scp_final_confirm_edit_pod_name_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_edit_pod_name_success_calls,
        IF(SUM(portals_scp_final_confirm_pause_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_pause_failure_calls,
        IF(SUM(portals_scp_final_confirm_pause_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_pause_success_calls,
        IF(SUM(portals_scp_final_confirm_refresh_pod_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_refresh_pod_failure_calls,
        IF(SUM(portals_scp_final_confirm_refresh_pod_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_refresh_pod_success_calls,
        IF(SUM(portals_scp_final_confirm_remove_device_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_remove_device_failure_calls,
        IF(SUM(portals_scp_final_confirm_remove_device_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_remove_device_success_calls,
        IF(SUM(portals_scp_final_confirm_unpause_failure) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_unpause_failure_calls,
        IF(SUM(portals_scp_final_confirm_unpause_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_final_confirm_unpause_success_calls,
        IF(SUM(portals_scp_list_of_pods_pv) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_list_of_pods_pv_calls,
        IF(SUM(portals_scp_pod_details_pv) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_pod_details_pv_calls,
        IF(SUM(portals_scp_remove_device_cancel) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_remove_device_cancel_calls,
        IF(SUM(portals_scp_select_pod_from_list) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_scp_select_pod_from_list_calls,
        IF(SUM(portals_security_qa_campaign_interaction) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_security_qa_campaign_interaction_calls,
        IF(SUM(portals_security_qa_update_security_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_security_qa_update_security_page_view_calls,
        IF(SUM(portals_select_actions) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_select_actions_calls,
        IF(SUM(portals_set_up_auto_payment_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_failures_calls,
        IF(SUM(portals_set_up_auto_payment_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_starts_calls,
        IF(SUM(portals_set_up_auto_payment_submits) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_submits_calls,
        IF(SUM(portals_set_up_auto_payment_submits_plus_otp) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_submits_plus_otp_calls,
        IF(SUM(portals_set_up_auto_payment_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_successes_calls,
        IF(SUM(portals_set_up_auto_payment_successes_with_payment) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_successes_with_payment_calls,
        IF(SUM(portals_set_up_auto_payment_successes_without_payment) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_set_up_auto_payment_successes_without_payment_calls,
        IF(SUM(portals_settings_sign_in_security_manage_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_sign_in_security_manage_select_action_calls,
        IF(SUM(portals_settings_sign_in_security_subnav_people_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_sign_in_security_subnav_people_select_action_calls,
        IF(SUM(portals_settings_verify_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_verify_select_action_calls,
        IF(SUM(portals_settings_your_info_changes_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_your_info_changes_success_calls,
        IF(SUM(portals_settings_your_info_manage_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_your_info_manage_select_action_calls,
        IF(SUM(portals_settings_your_info_save_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_your_info_save_select_action_calls,
        IF(SUM(portals_settings_your_info_verify_identity_modal_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_your_info_verify_identity_modal_view_calls,
        IF(SUM(portals_settings_your_info_verify_success) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_settings_your_info_verify_success_calls,
        IF(SUM(portals_site_unique) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_site_unique_calls,
        IF(SUM(portals_site_unique_auth) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_site_unique_auth_calls,
        IF(SUM(portals_site_unique_mobile) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_site_unique_mobile_calls,
        IF(SUM(portals_site_unique_pc) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_site_unique_pc_calls,
        IF(SUM(portals_start_pause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_start_pause_device_calls,
        IF(SUM(portals_start_unpause_device) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_start_unpause_device_calls,
        IF(SUM(portals_support_article_select) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_support_article_select_calls,
        IF(SUM(portals_support_button) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_support_button_calls,
        IF(SUM(portals_support_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_support_page_views_calls,
        IF(SUM(portals_tech_tracker_auth_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tech_tracker_auth_views_calls,
        IF(SUM(portals_tech_tracker_unauth_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tech_tracker_unauth_views_calls,
        IF(SUM(portals_tutorial_account_page_five_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_account_page_five_page_view_calls,
        IF(SUM(portals_tutorial_account_page_four_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_account_page_four_page_view_calls,
        IF(SUM(portals_tutorial_equip_page_three_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_equip_page_three_page_view_calls,
        IF(SUM(portals_tutorial_otp_page_two_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_otp_page_two_page_view_calls,
        IF(SUM(portals_tutorial_start_page_one_page_view) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_start_page_one_page_view_calls,
        IF(SUM(portals_tutorial_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tutorial_views_calls,
        IF(SUM(portals_tv_equipment_reset_flow_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_equipment_reset_flow_failures_calls,
        IF(SUM(portals_tv_equipment_reset_flow_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_equipment_reset_flow_starts_calls,
        IF(SUM(portals_tv_equipment_reset_flow_submit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_equipment_reset_flow_submit_calls,
        IF(SUM(portals_tv_equipment_reset_flow_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_equipment_reset_flow_successes_calls,
        IF(SUM(portals_tv_modem_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_modem_reset_failures_calls,
        IF(SUM(portals_tv_router_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_tv_router_reset_failures_calls,
        IF(SUM(portals_unauth_homepage_page_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_unauth_homepage_page_views_calls,
        IF(SUM(portals_update_missing_contact_campaign_interaction) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_campaign_interaction_calls,
        IF(SUM(portals_update_missing_contact_cancel_close_window) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_cancel_close_window_calls,
        IF(SUM(portals_update_missing_contact_save) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_save_calls,
        IF(SUM(portals_update_missing_contact_save_all) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_save_all_calls,
        IF(SUM(portals_update_missing_contact_save_and_continue) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_save_and_continue_calls,
        IF(SUM(portals_update_missing_contact_skip_this) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_skip_this_calls,
        IF(SUM(portals_update_missing_contact_update_all) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_update_missing_contact_update_all_calls,
        IF(SUM(portals_upgrade_links_overview) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_upgrade_links_overview_calls,
        IF(SUM(portals_upgrade_service_internet) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_upgrade_service_internet_calls,
        IF(SUM(portals_video_support_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_video_support_views_calls,
        IF(SUM(portals_view_connected_devices) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_view_connected_devices_calls,
        IF(SUM(portals_view_online_statments) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_view_online_statments_calls,
        IF(SUM(portals_voice_delete_messages) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_delete_messages_calls,
        IF(SUM(portals_voice_equipment_reset_flow_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_equipment_reset_flow_failures_calls,
        IF(SUM(portals_voice_equipment_reset_flow_starts) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_equipment_reset_flow_starts_calls,
        IF(SUM(portals_voice_equipment_reset_flow_submit) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_equipment_reset_flow_submit_calls,
        IF(SUM(portals_voice_equipment_reset_flow_successes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_equipment_reset_flow_successes_calls,
        IF(SUM(portals_voice_modem_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_modem_reset_failures_calls,
        IF(SUM(portals_voice_pageviews) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_pageviews_calls,
        IF(SUM(portals_voice_play_messages) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_play_messages_calls,
        IF(SUM(portals_voice_router_reset_failures) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_router_reset_failures_calls,
        IF(SUM(portals_voice_support_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_support_views_calls,
        IF(SUM(portals_voice_update_call_forward_settings) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_update_call_forward_settings_calls,
        IF(SUM(portals_voice_view_messages) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_view_messages_calls,
        IF(SUM(portals_voice_voicemail_view_select_action) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_voice_voicemail_view_select_action_calls,
        IF(SUM(portals_wifi_password_views) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_wifi_password_views_calls,
        IF(SUM(portals_wifi_pw_changes) > 0  AND SUM(calls_within_24_hrs) > 0, 1, 0) AS portals_wifi_pw_changes_calls

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

    FROM
      ( --start of innermost query
      SELECT
        mso,
        application_type,
        device_type,
        connection_type,
        network_status,
        playback_type,
        cust_type,
        application_group_type,
        app_version,
        logged_in AS logged_in_status,
        application_name,
        'All OS Names' AS os_name,
        operating_system AS os_version,
        browser_name,
        browser_version,
        form_factor,
        'accounts' AS unit_type,
        portals_unique_acct_key AS unit_identifier,

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
        SUM(portals_access_voice_platform_via_tile) AS portals_access_voice_platform_via_tile,
        SUM(portals_account_billing_support_views) AS portals_account_billing_support_views,
        SUM(portals_account_settings_click_install_wifi_profile) AS portals_account_settings_click_install_wifi_profile,
        SUM(portals_account_settings_click_manage_people) AS portals_account_settings_click_manage_people,
        SUM(portals_account_settings_click_save_contact_info) AS portals_account_settings_click_save_contact_info,
        SUM(portals_account_settings_home_page_views) AS portals_account_settings_home_page_views,
        SUM(portals_account_settings_manage_contact_info_page_views) AS portals_account_settings_manage_contact_info_page_views,
        SUM(portals_account_settings_manage_people_page_views) AS portals_account_settings_manage_people_page_views,
        SUM(portals_account_settings_your_info_tab_views) AS portals_account_settings_your_info_tab_views,
        SUM(portals_all_equipment_reset_flow_failures) AS portals_all_equipment_reset_flow_failures,
        SUM(portals_all_equipment_reset_flow_starts) AS portals_all_equipment_reset_flow_starts,
        SUM(portals_all_equipment_reset_flow_successes) AS portals_all_equipment_reset_flow_successes,
        SUM(portals_asd_paperless_enroll) AS portals_asd_paperless_enroll,
        SUM(portals_auth_homepage_page_views) AS portals_auth_homepage_page_views,
        SUM(portals_bill_delivery_pref_exit) AS portals_bill_delivery_pref_exit,
        SUM(portals_bill_delivery_pref_keep_paperless) AS portals_bill_delivery_pref_keep_paperless,
        SUM(portals_bill_delivery_pref_manage_paperless) AS portals_bill_delivery_pref_manage_paperless,
        SUM(portals_bill_delivery_pref_paper) AS portals_bill_delivery_pref_paper,
        SUM(portals_bill_delivery_pref_paper_failure) AS portals_bill_delivery_pref_paper_failure,
        SUM(portals_bill_delivery_pref_paper_success) AS portals_bill_delivery_pref_paper_success,
        SUM(portals_bill_delivery_pref_paperless_enroll_from_homepage) AS portals_bill_delivery_pref_paperless_enroll_from_homepage,
        SUM(portals_bill_delivery_pref_paperless_failure) AS portals_bill_delivery_pref_paperless_failure,
        SUM(portals_bill_delivery_pref_paperless_submit) AS portals_bill_delivery_pref_paperless_submit,
        SUM(portals_bill_delivery_pref_paperless_submit_from_billinghome) AS portals_bill_delivery_pref_paperless_submit_from_billinghome,
        SUM(portals_bill_delivery_pref_paperless_submit_from_homepage) AS portals_bill_delivery_pref_paperless_submit_from_homepage,
        SUM(portals_bill_delivery_pref_paperless_success) AS portals_bill_delivery_pref_paperless_success,
        SUM(portals_billing_feature_interaction) AS portals_billing_feature_interaction,
        SUM(portals_billing_feature_page_view) AS portals_billing_feature_page_view,
        SUM(portals_biometrics_fingerprint_enroll) AS portals_biometrics_fingerprint_enroll,
        SUM(portals_call_support) AS portals_call_support,
        SUM(portals_cancel_pause_device) AS portals_cancel_pause_device,
        SUM(portals_cancel_tutorial_equip_page_three) AS portals_cancel_tutorial_equip_page_three,
        SUM(portals_cancel_tutorial_otp_page_two) AS portals_cancel_tutorial_otp_page_two,
        SUM(portals_cancel_tutorial_start_page_one) AS portals_cancel_tutorial_start_page_one,
        SUM(portals_cancel_unpause_device) AS portals_cancel_unpause_device,
        SUM(portals_cancelled_service_appointment_start) AS portals_cancelled_service_appointment_start,
        SUM(portals_cancelled_service_appointments) AS portals_cancelled_service_appointments,
        SUM(portals_confirm_remove_device) AS portals_confirm_remove_device,
        SUM(portals_contact_us_page_views) AS portals_contact_us_page_views,
        SUM(portals_csat_campaign_dismiss) AS portals_csat_campaign_dismiss,
        SUM(portals_csat_campaign_interaction) AS portals_csat_campaign_interaction,
        SUM(portals_csat_submit_feedback_cancel_written_feedback) AS portals_csat_submit_feedback_cancel_written_feedback,
        SUM(portals_csat_submit_rating_1_very_dissatisfied) AS portals_csat_submit_rating_1_very_dissatisfied,
        SUM(portals_csat_submit_rating_2_dissatisfied) AS portals_csat_submit_rating_2_dissatisfied,
        SUM(portals_csat_submit_rating_3_neutral) AS portals_csat_submit_rating_3_neutral,
        SUM(portals_csat_submit_rating_4_satisfied) AS portals_csat_submit_rating_4_satisfied,
        SUM(portals_csat_submit_rating_5_very_satisfied) AS portals_csat_submit_rating_5_very_satisfied,
        SUM(portals_csat_submit_rating_all) AS portals_csat_submit_rating_all,
        SUM(portals_csat_submit_written_feedback) AS portals_csat_submit_written_feedback,
        SUM(portals_download_wifi_profile_button_click) AS portals_download_wifi_profile_button_click,
        SUM(portals_download_wifi_profile_button_click_android) AS portals_download_wifi_profile_button_click_android,
        SUM(portals_download_wifi_profile_button_click_ios) AS portals_download_wifi_profile_button_click_ios,
        SUM(portals_download_wifi_profile_success) AS portals_download_wifi_profile_success,
        SUM(portals_download_wifi_profile_success_android) AS portals_download_wifi_profile_success_android,
        SUM(portals_ed_my_internet_services) AS portals_ed_my_internet_services,
        SUM(portals_ed_my_voice_services) AS portals_ed_my_voice_services,
        SUM(portals_equipment_cancel_edit_ssid_select_action) AS portals_equipment_cancel_edit_ssid_select_action,
        SUM(portals_equipment_confirm_edit_ssid_select_action) AS portals_equipment_confirm_edit_ssid_select_action,
        SUM(portals_equipment_detail_views) AS portals_equipment_detail_views,
        SUM(portals_equipment_edit_ssid_select_action) AS portals_equipment_edit_ssid_select_action,
        SUM(portals_equipment_feature_interaction) AS portals_equipment_feature_interaction,
        SUM(portals_equipment_list_view) AS portals_equipment_list_view,
        SUM(portals_equipment_reset_flow_submit_all) AS portals_equipment_reset_flow_submit_all,
        SUM(portals_footer_getsupport_acct_support) AS portals_footer_getsupport_acct_support,
        SUM(portals_footer_getsupport_support_home) AS portals_footer_getsupport_support_home,
        SUM(portals_forgot_password_flow_start) AS portals_forgot_password_flow_start,
        SUM(portals_forgot_password_success) AS portals_forgot_password_success,
        SUM(portals_forgot_username_flow_start) AS portals_forgot_username_flow_start,
        SUM(portals_forgot_username_success) AS portals_forgot_username_success,
        SUM(portals_guided_tour_click_next) AS portals_guided_tour_click_next,
        SUM(portals_guided_tour_exit) AS portals_guided_tour_exit,
        SUM(portals_guided_tour_initiated_modal_view) AS portals_guided_tour_initiated_modal_view,
        SUM(portals_guided_tour_one_of_three) AS portals_guided_tour_one_of_three,
        SUM(portals_guided_tour_show_me_later) AS portals_guided_tour_show_me_later,
        SUM(portals_guided_tour_three_of_three) AS portals_guided_tour_three_of_three,
        SUM(portals_guided_tour_two_of_three) AS portals_guided_tour_two_of_three,
        SUM(portals_install_wifi_profile_start) AS portals_install_wifi_profile_start,
        SUM(portals_install_wifi_profile_success) AS portals_install_wifi_profile_success,
        SUM(portals_internet_equipment_reset_flow_failures) AS portals_internet_equipment_reset_flow_failures,
        SUM(portals_internet_equipment_reset_flow_starts) AS portals_internet_equipment_reset_flow_starts,
        SUM(portals_internet_equipment_reset_flow_submit) AS portals_internet_equipment_reset_flow_submit,
        SUM(portals_internet_equipment_reset_flow_successes) AS portals_internet_equipment_reset_flow_successes,
        SUM(portals_internet_modem_reset_failures) AS portals_internet_modem_reset_failures,
        SUM(portals_internet_modem_router_reset_starts) AS portals_internet_modem_router_reset_starts,
        SUM(portals_internet_router_reset_failures) AS portals_internet_router_reset_failures,
        SUM(portals_internet_router_reset_successes) AS portals_internet_router_reset_successes,
        SUM(portals_internet_support_views) AS portals_internet_support_views,
        SUM(portals_iva_opens) AS portals_iva_opens,
        SUM(portals_localnav_billing) AS portals_localnav_billing,
        SUM(portals_login_attempts) AS portals_login_attempts,
        SUM(portals_login_failures) AS portals_login_failures,
        SUM(portals_logout) AS portals_logout,
        SUM(portals_manage_auto_payment_cancel) AS portals_manage_auto_payment_cancel,
        SUM(portals_manage_auto_payment_starts) AS portals_manage_auto_payment_starts,
        SUM(portals_manage_auto_payment_successes) AS portals_manage_auto_payment_successes,
        SUM(portals_manual_reset_failures) AS portals_manual_reset_failures,
        SUM(portals_manual_reset_starts) AS portals_manual_reset_starts,
        SUM(portals_manual_reset_success) AS portals_manual_reset_success,
        SUM(portals_msa_experience_feedback_click_submit_feedback) AS portals_msa_experience_feedback_click_submit_feedback,
        SUM(portals_msa_experience_feedback_goal_accomplished) AS portals_msa_experience_feedback_goal_accomplished,
        SUM(portals_msa_experience_feedback_goal_not_accomplished) AS portals_msa_experience_feedback_goal_not_accomplished,
        SUM(portals_one_time_alert_clicked) AS portals_one_time_alert_clicked,
        SUM(portals_one_time_page_alert_displayed) AS portals_one_time_page_alert_displayed,
        SUM(portals_one_time_payment_amount) AS portals_one_time_payment_amount,
        SUM(portals_one_time_payment_checking) AS portals_one_time_payment_checking,
        SUM(portals_one_time_payment_checking_account) AS portals_one_time_payment_checking_account,
        SUM(portals_one_time_payment_credit) AS portals_one_time_payment_credit,
        SUM(portals_one_time_payment_credit_debit_card) AS portals_one_time_payment_credit_debit_card,
        SUM(portals_one_time_payment_date) AS portals_one_time_payment_date,
        SUM(portals_one_time_payment_date_other) AS portals_one_time_payment_date_other,
        SUM(portals_one_time_payment_date_past_due) AS portals_one_time_payment_date_past_due,
        SUM(portals_one_time_payment_date_today) AS portals_one_time_payment_date_today,
        SUM(portals_one_time_payment_failures) AS portals_one_time_payment_failures,
        SUM(portals_one_time_payment_savings) AS portals_one_time_payment_savings,
        SUM(portals_one_time_payment_savings_account) AS portals_one_time_payment_savings_account,
        SUM(portals_one_time_payment_select_amount) AS portals_one_time_payment_select_amount,
        SUM(portals_one_time_payment_select_date) AS portals_one_time_payment_select_date,
        SUM(portals_one_time_payment_select_payment_method) AS portals_one_time_payment_select_payment_method,
        SUM(portals_one_time_payment_starts) AS portals_one_time_payment_starts,
        SUM(portals_one_time_payment_submission_new_payment_method) AS portals_one_time_payment_submission_new_payment_method,
        SUM(portals_one_time_payment_submission_new_payment_method_not_stored) AS portals_one_time_payment_submission_new_payment_method_not_stored,
        SUM(portals_one_time_payment_submission_new_payment_method_stored) AS portals_one_time_payment_submission_new_payment_method_stored,
        SUM(portals_one_time_payment_submission_previously_stored_payment_method) AS portals_one_time_payment_submission_previously_stored_payment_method,
        SUM(portals_one_time_payment_submits) AS portals_one_time_payment_submits,
        SUM(portals_one_time_payment_submits_with_ap) AS portals_one_time_payment_submits_with_ap,
        SUM(portals_one_time_payment_submits_without_ap) AS portals_one_time_payment_submits_without_ap,
        SUM(portals_one_time_payment_successes) AS portals_one_time_payment_successes,
        SUM(portals_one_time_payment_successes_with_ap_enroll) AS portals_one_time_payment_successes_with_ap_enroll,
        SUM(portals_one_time_payment_successes_without_ap_enroll) AS portals_one_time_payment_successes_without_ap_enroll,
        SUM(portals_page_views) AS portals_page_views,
        SUM(portals_paperless_radio_toggle) AS portals_paperless_radio_toggle,
        SUM(portals_paperless_toggle) AS portals_paperless_toggle,
        SUM(portals_rescheduled_service_appointment_start) AS portals_rescheduled_service_appointment_start,
        SUM(portals_rescheduled_service_appointments) AS portals_rescheduled_service_appointments,
        SUM(portals_router_advanced_settings_click_about_port_forward) AS portals_router_advanced_settings_click_about_port_forward,
        SUM(portals_router_advanced_settings_click_add_port_assignment) AS portals_router_advanced_settings_click_add_port_assignment,
        SUM(portals_router_advanced_settings_click_cancel_dns_change) AS portals_router_advanced_settings_click_cancel_dns_change,
        SUM(portals_router_advanced_settings_click_cancel_port_assignment) AS portals_router_advanced_settings_click_cancel_port_assignment,
        SUM(portals_router_advanced_settings_click_create_ip_reservation) AS portals_router_advanced_settings_click_create_ip_reservation,
        SUM(portals_router_advanced_settings_click_delete_or_cancel_delete_port) AS portals_router_advanced_settings_click_delete_or_cancel_delete_port,
        SUM(portals_router_advanced_settings_click_delete_port) AS portals_router_advanced_settings_click_delete_port,
        SUM(portals_router_advanced_settings_click_dns) AS portals_router_advanced_settings_click_dns,
        SUM(portals_router_advanced_settings_click_manage_dns) AS portals_router_advanced_settings_click_manage_dns,
        SUM(portals_router_advanced_settings_click_manage_ip_reservations) AS portals_router_advanced_settings_click_manage_ip_reservations,
        SUM(portals_router_advanced_settings_click_port_forward) AS portals_router_advanced_settings_click_port_forward,
        SUM(portals_router_advanced_settings_click_reset_dns_default) AS portals_router_advanced_settings_click_reset_dns_default,
        SUM(portals_router_advanced_settings_click_save_confirm_dns) AS portals_router_advanced_settings_click_save_confirm_dns,
        SUM(portals_router_advanced_settings_click_spectrum_dns_default) AS portals_router_advanced_settings_click_spectrum_dns_default,
        SUM(portals_router_advanced_settings_click_upnp) AS portals_router_advanced_settings_click_upnp,
        SUM(portals_router_advanced_settings_click_use_existing_port) AS portals_router_advanced_settings_click_use_existing_port,
        SUM(portals_router_advanced_settings_delete_port_assignment_via_swipe) AS portals_router_advanced_settings_delete_port_assignment_via_swipe,
        SUM(portals_router_advanced_settings_port_unavailable_modal) AS portals_router_advanced_settings_port_unavailable_modal,
        SUM(portals_router_advanced_settings_reserve_ip_toggle_off) AS portals_router_advanced_settings_reserve_ip_toggle_off,
        SUM(portals_router_advanced_settings_reserve_ip_toggle_on) AS portals_router_advanced_settings_reserve_ip_toggle_on,
        SUM(portals_router_advanced_settings_upnp_toggle_off) AS portals_router_advanced_settings_upnp_toggle_off,
        SUM(portals_router_advanced_settings_upnp_toggle_on) AS portals_router_advanced_settings_upnp_toggle_on,
        SUM(portals_save_edit_device_nickname) AS portals_save_edit_device_nickname,
        SUM(portals_scp_click_cancel_pause_device) AS portals_scp_click_cancel_pause_device,
        SUM(portals_scp_click_cancel_unpause_device) AS portals_scp_click_cancel_unpause_device,
        SUM(portals_scp_click_not_connected_devices_tab) AS portals_scp_click_not_connected_devices_tab,
        SUM(portals_scp_click_pause_device) AS portals_scp_click_pause_device,
        SUM(portals_scp_click_paused_tab) AS portals_scp_click_paused_tab,
        SUM(portals_scp_click_unpause_device) AS portals_scp_click_unpause_device,
        SUM(portals_scp_final_confirm_create_pod_name_failure) AS portals_scp_final_confirm_create_pod_name_failure,
        SUM(portals_scp_final_confirm_create_pod_name_success) AS portals_scp_final_confirm_create_pod_name_success,
        SUM(portals_scp_final_confirm_device_nickname_change_failure) AS portals_scp_final_confirm_device_nickname_change_failure,
        SUM(portals_scp_final_confirm_device_nickname_change_success) AS portals_scp_final_confirm_device_nickname_change_success,
        SUM(portals_scp_final_confirm_device_type_and_nickname_change_failure) AS portals_scp_final_confirm_device_type_and_nickname_change_failure,
        SUM(portals_scp_final_confirm_device_type_and_nickname_change_success) AS portals_scp_final_confirm_device_type_and_nickname_change_success,
        SUM(portals_scp_final_confirm_device_type_icon_update_failure) AS portals_scp_final_confirm_device_type_icon_update_failure,
        SUM(portals_scp_final_confirm_device_type_icon_update_success) AS portals_scp_final_confirm_device_type_icon_update_success,
        SUM(portals_scp_final_confirm_edit_pod_name_failure) AS portals_scp_final_confirm_edit_pod_name_failure,
        SUM(portals_scp_final_confirm_edit_pod_name_success) AS portals_scp_final_confirm_edit_pod_name_success,
        SUM(portals_scp_final_confirm_pause_failure) AS portals_scp_final_confirm_pause_failure,
        SUM(portals_scp_final_confirm_pause_success) AS portals_scp_final_confirm_pause_success,
        SUM(portals_scp_final_confirm_refresh_pod_failure) AS portals_scp_final_confirm_refresh_pod_failure,
        SUM(portals_scp_final_confirm_refresh_pod_success) AS portals_scp_final_confirm_refresh_pod_success,
        SUM(portals_scp_final_confirm_remove_device_failure) AS portals_scp_final_confirm_remove_device_failure,
        SUM(portals_scp_final_confirm_remove_device_success) AS portals_scp_final_confirm_remove_device_success,
        SUM(portals_scp_final_confirm_unpause_failure) AS portals_scp_final_confirm_unpause_failure,
        SUM(portals_scp_final_confirm_unpause_success) AS portals_scp_final_confirm_unpause_success,
        SUM(portals_scp_list_of_pods_pv) AS portals_scp_list_of_pods_pv,
        SUM(portals_scp_pod_details_pv) AS portals_scp_pod_details_pv,
        SUM(portals_scp_remove_device_cancel) AS portals_scp_remove_device_cancel,
        SUM(portals_scp_select_pod_from_list) AS portals_scp_select_pod_from_list,
        SUM(portals_security_qa_campaign_interaction) AS portals_security_qa_campaign_interaction,
        SUM(portals_security_qa_update_security_page_view) AS portals_security_qa_update_security_page_view,
        SUM(portals_select_actions) AS portals_select_actions,
        SUM(portals_set_up_auto_payment_failures) AS portals_set_up_auto_payment_failures,
        SUM(portals_set_up_auto_payment_starts) AS portals_set_up_auto_payment_starts,
        SUM(portals_set_up_auto_payment_submits) AS portals_set_up_auto_payment_submits,
        SUM(portals_set_up_auto_payment_submits_plus_otp) AS portals_set_up_auto_payment_submits_plus_otp,
        SUM(portals_set_up_auto_payment_successes) AS portals_set_up_auto_payment_successes,
        SUM(portals_set_up_auto_payment_successes_with_payment) AS portals_set_up_auto_payment_successes_with_payment,
        SUM(portals_set_up_auto_payment_successes_without_payment) AS portals_set_up_auto_payment_successes_without_payment,
        SUM(portals_settings_sign_in_security_manage_select_action) AS portals_settings_sign_in_security_manage_select_action,
        SUM(portals_settings_sign_in_security_subnav_people_select_action) AS portals_settings_sign_in_security_subnav_people_select_action,
        SUM(portals_settings_verify_select_action) AS portals_settings_verify_select_action,
        SUM(portals_settings_your_info_changes_success) AS portals_settings_your_info_changes_success,
        SUM(portals_settings_your_info_manage_select_action) AS portals_settings_your_info_manage_select_action,
        SUM(portals_settings_your_info_save_select_action) AS portals_settings_your_info_save_select_action,
        SUM(portals_settings_your_info_verify_identity_modal_view) AS portals_settings_your_info_verify_identity_modal_view,
        SUM(portals_settings_your_info_verify_success) AS portals_settings_your_info_verify_success,
        SUM(portals_site_unique) AS portals_site_unique,
        SUM(portals_site_unique_auth) AS portals_site_unique_auth,
        SUM(portals_site_unique_mobile) AS portals_site_unique_mobile,
        SUM(portals_site_unique_pc) AS portals_site_unique_pc,
        SUM(portals_start_pause_device) AS portals_start_pause_device,
        SUM(portals_start_unpause_device) AS portals_start_unpause_device,
        SUM(portals_support_article_select) AS portals_support_article_select,
        SUM(portals_support_button) AS portals_support_button,
        SUM(portals_support_page_views) AS portals_support_page_views,
        SUM(portals_tech_tracker_auth_views) AS portals_tech_tracker_auth_views,
        SUM(portals_tech_tracker_unauth_views) AS portals_tech_tracker_unauth_views,
        SUM(portals_tutorial_account_page_five_page_view) AS portals_tutorial_account_page_five_page_view,
        SUM(portals_tutorial_account_page_four_page_view) AS portals_tutorial_account_page_four_page_view,
        SUM(portals_tutorial_equip_page_three_page_view) AS portals_tutorial_equip_page_three_page_view,
        SUM(portals_tutorial_otp_page_two_page_view) AS portals_tutorial_otp_page_two_page_view,
        SUM(portals_tutorial_start_page_one_page_view) AS portals_tutorial_start_page_one_page_view,
        SUM(portals_tutorial_views) AS portals_tutorial_views,
        SUM(portals_tv_equipment_reset_flow_failures) AS portals_tv_equipment_reset_flow_failures,
        SUM(portals_tv_equipment_reset_flow_starts) AS portals_tv_equipment_reset_flow_starts,
        SUM(portals_tv_equipment_reset_flow_submit) AS portals_tv_equipment_reset_flow_submit,
        SUM(portals_tv_equipment_reset_flow_successes) AS portals_tv_equipment_reset_flow_successes,
        SUM(portals_tv_modem_reset_failures) AS portals_tv_modem_reset_failures,
        SUM(portals_tv_router_reset_failures) AS portals_tv_router_reset_failures,
        SUM(portals_unauth_homepage_page_views) AS portals_unauth_homepage_page_views,
        SUM(portals_update_missing_contact_campaign_interaction) AS portals_update_missing_contact_campaign_interaction,
        SUM(portals_update_missing_contact_cancel_close_window) AS portals_update_missing_contact_cancel_close_window,
        SUM(portals_update_missing_contact_save) AS portals_update_missing_contact_save,
        SUM(portals_update_missing_contact_save_all) AS portals_update_missing_contact_save_all,
        SUM(portals_update_missing_contact_save_and_continue) AS portals_update_missing_contact_save_and_continue,
        SUM(portals_update_missing_contact_skip_this) AS portals_update_missing_contact_skip_this,
        SUM(portals_update_missing_contact_update_all) AS portals_update_missing_contact_update_all,
        SUM(portals_upgrade_links_overview) AS portals_upgrade_links_overview,
        SUM(portals_upgrade_service_internet) AS portals_upgrade_service_internet,
        SUM(portals_video_support_views) AS portals_video_support_views,
        SUM(portals_view_connected_devices) AS portals_view_connected_devices,
        SUM(portals_view_online_statments) AS portals_view_online_statments,
        SUM(portals_voice_delete_messages) AS portals_voice_delete_messages,
        SUM(portals_voice_equipment_reset_flow_failures) AS portals_voice_equipment_reset_flow_failures,
        SUM(portals_voice_equipment_reset_flow_starts) AS portals_voice_equipment_reset_flow_starts,
        SUM(portals_voice_equipment_reset_flow_submit) AS portals_voice_equipment_reset_flow_submit,
        SUM(portals_voice_equipment_reset_flow_successes) AS portals_voice_equipment_reset_flow_successes,
        SUM(portals_voice_modem_reset_failures) AS portals_voice_modem_reset_failures,
        SUM(portals_voice_pageviews) AS portals_voice_pageviews,
        SUM(portals_voice_play_messages) AS portals_voice_play_messages,
        SUM(portals_voice_router_reset_failures) AS portals_voice_router_reset_failures,
        SUM(portals_voice_support_views) AS portals_voice_support_views,
        SUM(portals_voice_update_call_forward_settings) AS portals_voice_update_call_forward_settings,
        SUM(portals_voice_view_messages) AS portals_voice_view_messages,
        SUM(portals_voice_voicemail_view_select_action) AS portals_voice_voicemail_view_select_action,
        SUM(portals_wifi_password_views) AS portals_wifi_password_views,
        SUM(portals_wifi_pw_changes) AS portals_wifi_pw_changes,
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
          SUM(calls_within_24_hrs) as calls_within_24_hrs
      FROM ${hiveconf:inputmetricaggtable} 
      WHERE (denver_date >= ("${hiveconf:START_DATE}") AND denver_date < ("${hiveconf:END_DATE}"))
      GROUP BY
        mso,
        application_type,
        device_type,
        connection_type,
        network_status,
        playback_type,
        cust_type,
        application_group_type,
        app_version,
        logged_in,
        application_name,
        'All OS Names',
        operating_system,
        browser_name,
        browser_version,
        form_factor,
        portals_unique_acct_key,
        'accounts'
      ) sumfirst -- end of innermost query
    GROUP BY
      unit_identifier,
      mso,
      application_type,
      device_type,
      connection_type,
      network_status,
      playback_type,
      cust_type,
      application_group_type,
      app_version,
      logged_in_status,
      application_name,
      os_name,
      os_version,
      browser_name,
      browser_version,
      form_factor,
      unit_type
    GROUPING SETS (
      (unit_identifier),
      (unit_identifier, network_status),
      (unit_identifier, network_status, browser_name),
      (unit_identifier, network_status, browser_name, form_factor),
      (unit_identifier, network_status, form_factor),
      (unit_identifier, os_version),
      (unit_identifier, browser_name),
      (unit_identifier, browser_name, form_factor),
      (unit_identifier, browser_name, browser_version),
      (unit_identifier, form_factor),
      (unit_identifier, mso, application_name),
      (unit_identifier, mso, application_name, network_status),
      (unit_identifier, mso, application_name, network_status, app_version),
      (unit_identifier, mso, application_name, network_status, app_version, browser_name),
      (unit_identifier, mso, application_name, network_status, app_version, form_factor),
      (unit_identifier, mso, application_name, network_status, browser_name),
      (unit_identifier, mso, application_name, network_status, browser_name, form_factor),
      (unit_identifier, mso, application_name, network_status, form_factor),
      (unit_identifier, mso, application_name, app_version),
      (unit_identifier, mso, application_name, app_version, browser_name),
      (unit_identifier, mso, application_name, app_version, browser_name, form_factor),
      (unit_identifier, mso, application_name, app_version, form_factor),
      (unit_identifier, mso, application_name, browser_name),
      (unit_identifier, mso, application_name, browser_name, form_factor),
      (unit_identifier, mso, application_name, form_factor),
      (unit_identifier, application_name),
      (unit_identifier, application_name, network_status),
      (unit_identifier, application_name, network_status, app_version),
      (unit_identifier, application_name, network_status, app_version, browser_name),
      (unit_identifier, application_name, network_status, app_version, form_factor),
      (unit_identifier, application_name, network_status, browser_name),
      (unit_identifier, application_name, network_status, browser_name, form_factor),
      (unit_identifier, application_name, network_status, form_factor),
      (unit_identifier, application_name, app_version),
      (unit_identifier, application_name, app_version, browser_name),
      (unit_identifier, application_name, app_version, browser_name, form_factor),
      (unit_identifier, application_name, app_version, browser_name, browser_version),
      (unit_identifier, application_name, app_version, form_factor),
      (unit_identifier, application_name, os_version),
      (unit_identifier, application_name, browser_name),
      (unit_identifier, application_name, browser_name, form_factor),
      (unit_identifier, application_name, browser_name, browser_version),
      (unit_identifier, application_name, form_factor),
      (unit_identifier, application_name, device_type, mso, app_version),
      (unit_identifier, application_name, device_type, mso),
      (unit_identifier, application_name, device_type, app_version),
      (unit_identifier, application_name, device_type))
    ) sets --end of penultimate inner query
  GROUP BY
    '${hiveconf:label_date_denver}',
    mso,
    application_type,
    device_type,
    connection_type,
    network_status,
    playback_type,
    cust_type,
    application_group_type,
    app_version,
    logged_in_status,
    application_name,
    os_name,
    os_version,
    browser_name,
    browser_version,
    form_factor,
    grouping_id,
    unit_type,
    cast(NULL as string)
  ) mapit --end of antepenultimate inner query
LATERAL VIEW EXPLODE(metric_map) explode_table AS metric_name, metric_value
LATERAL VIEW EXPLODE(call_map) explode_table AS metric_name_calls, metric_calls
WHERE metric_name=metric_name_calls
; --end of outermost query
--------------------------------------------------------------------------------
--------------------------------***** END *****---------------------------------
--------------------------------------------------------------------------------
